{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{1381:function(e,t,a){\"use strict\";a(33);var n=a(0),s=a.n(n),o=a(194),c=a(41),l=a(52),r=a(67),i=a(20),d=a(100),b=a(359),u=a(39),h=a(70),p=a(122),m=a(1);const f=Object(b.a)(()=>Promise.all([a.e(0),a.e(13),a.e(55)]).then(a.bind(null,2292))),O=Object(l.c)(d.b)`\n  .modal-content {\n    height: 900px;\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n  }\n\n  .modal-header {\n    flex: 0 1 auto;\n  }\n  .modal-body {\n    flex: 1 1 auto;\n    overflow: auto;\n  }\n\n  .modal-footer {\n    flex: 0 1 auto;\n  }\n`;function j(e){var t,a;return null!=e&&e.certified_by||null!=e&&e.certification_details?JSON.stringify({certification:{certified_by:null!=(t=null==e?void 0:e.certified_by)?t:null,details:null!=(a=null==e?void 0:e.certification_details)?a:null}}):null}t.a=Object(p.a)(({addSuccessToast:e,datasource:t,onDatasourceSave:a,onHide:l,show:b})=>{const[p,g]=Object(n.useState)(t),[y,v]=Object(n.useState)([]),[w,S]=Object(n.useState)(!1),x=Object(n.useRef)(null),[C,_]=d.b.useModal(),N=()=>{var t,n,s;const o=(null==(t=p.tableSelector)?void 0:t.schema)||(null==(n=p.databaseSelector)?void 0:n.schema)||p.schema;S(!0),r.a.post({endpoint:\"/datasource/save/\",postPayload:{data:{...p,schema:o,metrics:null==p||null==(s=p.metrics)?void 0:s.map(e=>({...e,extra:j(e)})),type:p.type||p.datasource_type}}}).then(({json:t})=>{e(Object(i.e)(\"The dataset has been saved\")),a(t),l()}).catch(e=>{S(!1),Object(h.a)(e).then(({error:e})=>{C.error({title:\"Error\",content:e||Object(i.e)(\"An error has occurred\"),okButtonProps:{danger:!0,className:\"btn-danger\"}})})})};return Object(m.f)(O,{show:b,onHide:l,title:Object(m.f)(\"span\",null,Object(i.e)(\"Edit Dataset \"),Object(m.f)(\"strong\",null,p.table_name)),footer:Object(m.f)(s.a.Fragment,null,Object(u.c)(u.a.ENABLE_REACT_CRUD_VIEWS)&&Object(m.f)(c.a,{buttonSize:\"small\",buttonStyle:\"default\",className:\"m-r-5\",onClick:()=>{window.location.href=p.edit_url||p.url}},Object(i.e)(\"Use legacy datasource editor\")),Object(m.f)(c.a,{buttonSize:\"small\",className:\"m-r-5\",onClick:l},Object(i.e)(\"Cancel\")),Object(m.f)(c.a,{buttonSize:\"small\",buttonStyle:\"primary\",onClick:()=>{x.current=C.confirm({title:Object(i.e)(\"Confirm save\"),content:Object(m.f)(\"div\",null,Object(m.f)(o.a,{css:e=>({marginTop:4*e.gridUnit,marginBottom:4*e.gridUnit}),type:\"warning\",showIcon:!0,message:Object(i.e)(\"The dataset configuration exposed here\\n                affects all the charts using this dataset.\\n                Be mindful that changing settings\\n                here may affect other charts\\n                in undesirable ways.\")}),Object(i.e)(\"Are you sure you want to save and apply changes?\")),onOk:N,icon:null})},disabled:w||y.length>0},Object(i.e)(\"Save\"))),responsive:!0},Object(m.f)(f,{showLoadingForImport:!0,height:500,datasource:p,onChange:(e,t)=>{g({...e,metrics:null==e?void 0:e.metrics.map(e=>({...e,is_certified:(null==e?void 0:e.certified_by)||(null==e?void 0:e.certification_details)}))}),v(t)}}),_)})},1488:function(e,t,a){\"use strict\";var n=a(0),s=a.n(n),o=a(51),c=a(45),l=a(1);t.a=({onClick:e,tooltipContent:t})=>{const a=s.a.forwardRef((e,t)=>Object(l.f)(c.a,e));return Object(l.f)(o.a,{title:t},Object(l.f)(a,{role:\"button\",onClick:e,name:\"refresh\",css:e=>({cursor:\"pointer\",color:e.colors.grayscale.base,\"&:hover\":{color:e.colors.primary.base}})}))}},2068:function(e,t,a){\"use strict\";var n=a(0),s=a.n(n),o=a(20),c=a(52),l=a(45),r=a(51),i=a(1);t.a=function({certifiedBy:e,details:t,size:a=24}){return Object(i.f)(r.a,{id:\"certified-details-tooltip\",title:Object(i.f)(s.a.Fragment,null,e&&Object(i.f)(\"div\",null,Object(o.e)(\"Certified by %s\",e)),Object(i.f)(\"div\",null,t))},Object(i.f)(l.a,{color:c.d.colors.primary.base,height:a,width:a,name:\"certified\"}))}},2069:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return O}));a(33);var n=a(0),s=a(52),o=a(67),c=a(20),l=a(95),r=a.n(l),i=a(72),d=a(128),b=a(1488),u=a(873),h=a(1);const p=s.c.p`\n  color: ${({theme:e})=>e.colors.secondary.light2};\n  font-size: ${({theme:e})=>e.typography.sizes.s}px;\n  margin: 20px 0 10px 0;\n  text-transform: uppercase;\n`,m=s.c.div`\n  .fa-refresh {\n    padding-left: 9px;\n  }\n\n  .refresh-col {\n    display: flex;\n    align-items: center;\n    width: 30px;\n    margin-left: ${({theme:e})=>e.gridUnit}px;\n  }\n\n  .section {\n    padding-bottom: 5px;\n    display: flex;\n    flex-direction: row;\n  }\n\n  .select {\n    flex-grow: 1;\n  }\n`,f=s.c.span`\n  display: inline-flex;\n  align-items: center;\n`;function O({dbId:e,formMode:t=!1,getDbList:a,getTableList:s,handleError:l,isDatabaseSelectEnabled:O=!0,onChange:j,onDbChange:g,onSchemaChange:y,onSchemasLoad:v,readOnly:w=!1,schema:S,sqlLabMode:x=!1}){const[C,_]=Object(n.useState)(e),[N,D]=Object(n.useState)(S),[E,k]=Object(n.useState)(!1),[T,$]=Object(n.useState)([]);function I(t,a=!1){const n=t||e;if(n){k(!0);const e=`/api/v1/database/${n}/schemas/?q=${r.a.encode({force:Boolean(a)})}`;return o.a.get({endpoint:e}).then(({json:e})=>{const t=e.result.map(e=>({value:e,label:e,title:e}));$(t),k(!1),v&&v(t)}).catch(()=>{$([]),k(!1),l(Object(c.e)(\"Error while fetching schema list\"))})}return Promise.resolve()}function R({dbId:e,schema:t}){_(e),D(t),j&&j({dbId:e,schema:t,tableName:void 0})}function A(e){return a&&a(e.result),0===e.result.length&&l(Object(c.e)(\"It seems you don't have access to any database\")),e.result.map(e=>({...e,label:`${e.backend} ${e.database_name}`}))}function z(e,t=!1){const a=e?e.id:null;$([]),y&&y(null),g&&g(e),I(a,t),R({dbId:a,schema:void 0})}function L(e){return Object(h.f)(f,{title:e.database_name},Object(h.f)(d.a,{type:\"default\"},e.backend),\" \",e.database_name)}function U(e,t){return Object(h.f)(\"div\",{className:\"section\"},Object(h.f)(\"span\",{className:\"select\"},e),Object(h.f)(\"span\",{className:\"refresh-col\"},t))}return Object(n.useEffect)(()=>{C&&I(C)},[C]),Object(h.f)(m,null,t&&Object(h.f)(p,null,Object(c.e)(\"datasource\")),function(){const e=r.a.encode({order_columns:\"database_name\",order_direction:\"asc\",page:0,page_size:-1,...t||!x?{}:{filters:[{col:\"expose_in_sqllab\",opr:\"eq\",value:!0}]}});return U(Object(h.f)(u.a,{dataEndpoint:\"/api/v1/database/?q=\"+e,onChange:e=>z(e),onAsyncError:()=>l(Object(c.e)(\"Error while fetching database list\")),clearable:!1,value:C,valueKey:\"id\",valueRenderer:e=>Object(h.f)(\"div\",null,Object(h.f)(\"span\",{className:\"text-muted m-r-5\"},Object(c.e)(\"Database:\")),L(e)),optionRenderer:L,mutator:A,placeholder:Object(c.e)(\"Select a database\"),autoSelect:!0,isDisabled:!O||w}),null)}(),t&&Object(h.f)(p,null,Object(c.e)(\"schema\")),function(){const a=T.filter(({value:e})=>N===e),n=!t&&!w&&Object(h.f)(b.a,{onClick:()=>z({id:e},!0),tooltipContent:Object(c.e)(\"Force refresh schema list\")});return U(Object(h.f)(i.f,{name:\"select-schema\",placeholder:Object(c.e)(\"Select a schema (%s)\",T.length),options:T,value:a,valueRenderer:e=>Object(h.f)(\"div\",null,Object(h.f)(\"span\",{className:\"text-muted\"},Object(c.e)(\"Schema:\")),\" \",e.label),isLoading:E,autosize:!1,onChange:e=>function(e,t=!1){const a=e?e.value:null;y&&y(a),D(a),R({dbId:C,schema:a}),s&&s(C,a,t)}(e),isDisabled:w}),n)}())}},2070:function(e,t,a){\"use strict\";a(33);var n=a(0),s=a(52),o=a(67),c=a(20),l=a(72),r=a(92),i=a(2069),d=a(1488),b=a(2068),u=a(1);const h=s.c.p`\n  color: ${({theme:e})=>e.colors.secondary.light2};\n  font-size: ${({theme:e})=>e.typography.sizes.s}px;\n  margin: 20px 0 10px 0;\n  text-transform: uppercase;\n`,p=s.c.div`\n  .fa-refresh {\n    padding-left: 9px;\n  }\n\n  .refresh-col {\n    display: flex;\n    align-items: center;\n    width: 30px;\n    margin-left: ${({theme:e})=>e.gridUnit}px;\n  }\n\n  .section {\n    padding-bottom: 5px;\n    display: flex;\n    flex-direction: row;\n  }\n\n  .select {\n    flex-grow: 1;\n  }\n\n  .divider {\n    border-bottom: 1px solid ${({theme:e})=>e.colors.secondary.light5};\n    margin: 15px 0;\n  }\n`,m=s.c.span`\n  align-items: center;\n  display: flex;\n  white-space: nowrap;\n\n  > svg,\n  > small {\n    margin-right: ${({theme:e})=>e.gridUnit}px;\n  }\n`;t.a=({database:e,dbId:t,formMode:a=!1,getDbList:s,handleError:f,isDatabaseSelectEnabled:O=!0,onChange:j,onDbChange:g,onSchemaChange:y,onSchemasLoad:v,onTableChange:w,onTablesLoad:S,readOnly:x=!1,schema:C,sqlLabMode:_=!0,tableName:N,tableNameSticky:D=!0})=>{const[E,k]=Object(n.useState)(C),[T,$]=Object(n.useState)(N),[I,R]=Object(n.useState)(!1),[A,z]=Object(n.useState)([]);function L(e,a,n=!1,s=\"undefined\"){const l=a||E,r=e||t;if(r&&l){const e=encodeURIComponent(l),t=encodeURIComponent(s);R(!0),z([]);const a=encodeURI(`/superset/tables/${r}/${e}/${t}/${!!n}/`);return o.a.get({endpoint:a}).then(({json:e})=>{const t=e.options.map(e=>({value:e.value,schema:e.schema,label:e.label,title:e.title,type:e.type,extra:null==e?void 0:e.extra}));R(!1),z(t),S&&S(e.options)}).catch(()=>{R(!1),z([]),f(Object(c.e)(\"Error while fetching table list\"))})}return R(!1),z([]),Promise.resolve()}function U({dbId:e,schema:t,tableName:a}){$(a),k(t),j&&j({dbId:e,schema:t,tableName:a})}function H(e=\"undefined\"){if(!t||!e){const e=[];return Promise.resolve({options:e})}const a=encodeURIComponent(C||\"\"),n=encodeURIComponent(e);return o.a.get({endpoint:encodeURI(`/superset/tables/${t}/${a}/${n}`)}).then(({json:e})=>({options:e.options.map(e=>({value:e.value,schema:e.schema,label:e.label,title:e.title,type:e.type}))}))}function B(e){if(!e)return void $(\"\");const a=e.schema,n=e.value;D&&U({dbId:t,schema:a,tableName:n}),w&&w(n,a)}function P(e){var t;return Object(u.f)(m,{title:e.label},Object(u.f)(\"small\",{className:\"text-muted\"},Object(u.f)(\"i\",{className:\"fa fa-\"+(\"view\"===e.type?\"eye\":\"table\")})),(null==(t=e.extra)?void 0:t.certification)&&Object(u.f)(b.a,{certifiedBy:e.extra.certification.certified_by,details:e.extra.certification.details,size:20}),e.label)}return Object(n.useEffect)(()=>{t&&C&&L()},[t,C]),Object(u.f)(p,null,Object(u.f)(i.a,{dbId:t,formMode:a,getDbList:s,getTableList:L,handleError:f,onChange:U,onDbChange:x?void 0:g,onSchemaChange:x?void 0:y,onSchemasLoad:v,schema:E,sqlLabMode:_,isDatabaseSelectEnabled:O&&!x,readOnly:x}),!a&&Object(u.f)(\"div\",{className:\"divider\"}),_&&Object(u.f)(\"div\",{className:\"section\"},Object(u.f)(r.a,null,Object(c.e)(\"See table schema\"),\" \",C&&Object(u.f)(\"small\",null,A.length,\" in\",Object(u.f)(\"i\",null,C)))),a&&Object(u.f)(h,null,Object(c.e)(\"Table\")),function(){const n=A;let s=null;if(E&&!a)s=Object(u.f)(l.f,{name:\"select-table\",isLoading:I,ignoreAccents:!1,placeholder:Object(c.e)(\"Select table or type table name\"),autosize:!1,onChange:B,options:n,value:T,optionRenderer:P,valueRenderer:P,isDisabled:x});else if(a)s=Object(u.f)(l.c,{name:\"select-table\",isLoading:I,ignoreAccents:!1,placeholder:Object(c.e)(\"Select table or type table name\"),autosize:!1,onChange:B,options:n,value:T,optionRenderer:P});else{let t,a=!1;e&&e.allow_multi_schema_metadata_fetch?t=Object(c.e)(\"Type to search ...\"):(t=Object(c.e)(\"Select table \"),a=!0),s=Object(u.f)(l.b,{name:\"async-select-table\",placeholder:t,isDisabled:a,autosize:!1,onChange:B,value:T,loadOptions:H,optionRenderer:P})}return function(e,t){return Object(u.f)(\"div\",{className:\"section\"},Object(u.f)(\"span\",{className:\"select\"},e),Object(u.f)(\"span\",{className:\"refresh-col\"},t))}(s,!a&&!x&&Object(u.f)(d.a,{onClick:()=>function(e,a=!1){const n=e?e.value:null;y&&y(n),U({dbId:t,schema:n,tableName:void 0}),L(t,E,a)}({value:C},!0),tooltipContent:Object(c.e)(\"Force refresh table list\")}))}())}},4497:function(e,t,a){\"use strict\";a(33);var n=a(0),s=a.n(n),o=a(52),c=a(20),l=a(45),r=a(100),i=a(524),d=a(1);Object(o.c)(l.a)`\n  margin: auto ${({theme:e})=>2*e.gridUnit}px auto 0;\n`;const b=o.c.div`\n  display: block;\n  color: ${({theme:e})=>e.colors.grayscale.base};\n  font-size: ${({theme:e})=>e.typography.sizes.s-1}px;\n`,u=o.c.div`\n  padding-bottom: ${({theme:e})=>2*e.gridUnit}px;\n  padding-top: ${({theme:e})=>2*e.gridUnit}px;\n\n  & > div {\n    margin: ${({theme:e})=>e.gridUnit}px 0;\n  }\n\n  &.extra-container {\n    padding-top: 8px;\n  }\n\n  .confirm-overwrite {\n    margin-bottom: ${({theme:e})=>2*e.gridUnit}px;\n  }\n\n  .input-container {\n    display: flex;\n    align-items: center;\n\n    label {\n      display: flex;\n      margin-right: ${({theme:e})=>2*e.gridUnit}px;\n    }\n\n    i {\n      margin: 0 ${({theme:e})=>e.gridUnit}px;\n    }\n  }\n\n  input,\n  textarea {\n    flex: 1 1 auto;\n  }\n\n  textarea {\n    height: 160px;\n    resize: none;\n  }\n\n  input::placeholder,\n  textarea::placeholder {\n    color: ${({theme:e})=>e.colors.grayscale.light1};\n  }\n\n  textarea,\n  input[type='text'],\n  input[type='number'] {\n    padding: ${({theme:e})=>1.5*e.gridUnit}px\n      ${({theme:e})=>2*e.gridUnit}px;\n    border-style: none;\n    border: 1px solid ${({theme:e})=>e.colors.grayscale.light2};\n    border-radius: ${({theme:e})=>e.gridUnit}px;\n\n    &[name='name'] {\n      flex: 0 1 auto;\n      width: 40%;\n    }\n\n    &[name='sqlalchemy_uri'] {\n      margin-right: ${({theme:e})=>3*e.gridUnit}px;\n    }\n  }\n`;t.a=({resourceName:e,resourceLabel:t,passwordsNeededMessage:a,confirmOverwriteMessage:o,addDangerToast:l,addSuccessToast:h,onModelImport:p,show:m,onHide:f,passwordFields:O=[],setPasswordFields:j=(()=>{})})=>{const[g,y]=Object(n.useState)(!0),[v,w]=Object(n.useState)(null),[S,x]=Object(n.useState)({}),[C,_]=Object(n.useState)(!1),[N,D]=Object(n.useState)(!1),E=Object(n.useRef)(null),k=()=>{w(null),j([]),x({}),_(!1),D(!1),E&&E.current&&(E.current.value=\"\")},{state:{alreadyExists:T,passwordsNeeded:$},importResource:I}=Object(i.d)(e,t,e=>{k(),l(e)});Object(n.useEffect)(()=>{j($)},[$,j]),Object(n.useEffect)(()=>{_(T.length>0)},[T,_]);const R=e=>{var t,a;const n=null!=(t=null==(a=e.currentTarget)?void 0:a.value)?t:\"\";D(n.toUpperCase()===Object(c.e)(\"OVERWRITE\"))};return g&&m&&y(!1),Object(d.f)(r.b,{name:\"model\",className:\"import-model-modal\",disablePrimaryButton:null===v||C&&!N,onHandledPrimaryAction:()=>{null!==v&&I(v,S,N).then(e=>{e&&(h(Object(c.e)(\"The import was successful\")),k(),p())})},onHide:()=>{y(!0),f(),k()},primaryButtonName:C?Object(c.e)(\"Overwrite\"):Object(c.e)(\"Import\"),primaryButtonType:C?\"danger\":\"primary\",width:\"750px\",show:m,title:Object(d.f)(\"h4\",null,Object(c.e)(\"Import %s\",t))},Object(d.f)(u,null,Object(d.f)(\"div\",{className:\"control-label\"},Object(d.f)(\"label\",{htmlFor:\"modelFile\"},Object(c.e)(\"File\"),Object(d.f)(\"span\",{className:\"required\"},\"*\"))),Object(d.f)(\"input\",{ref:E,name:\"modelFile\",id:\"modelFile\",type:\"file\",accept:\".yaml,.json,.yml,.zip\",onChange:e=>{const{files:t}=e.target;w(t&&t[0]||null)}})),0===O.length?null:Object(d.f)(s.a.Fragment,null,Object(d.f)(\"h5\",null,\"Database passwords\"),Object(d.f)(b,null,a),O.map(e=>Object(d.f)(u,{key:\"password-for-\"+e},Object(d.f)(\"div\",{className:\"control-label\"},e,Object(d.f)(\"span\",{className:\"required\"},\"*\")),Object(d.f)(\"input\",{name:\"password-\"+e,autoComplete:\"password-\"+e,type:\"password\",value:S[e],onChange:t=>x({...S,[e]:t.target.value})})))),C?Object(d.f)(s.a.Fragment,null,Object(d.f)(u,null,Object(d.f)(\"div\",{className:\"confirm-overwrite\"},o),Object(d.f)(\"div\",{className:\"control-label\"},Object(c.e)('Type \"%s\" to confirm',Object(c.e)(\"OVERWRITE\"))),Object(d.f)(\"input\",{id:\"overwrite\",type:\"text\",onChange:R}))):null)}},4514:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return s}));var n=a(20);const s={name:Object(n.e)(\"Data\"),tabs:[{name:\"Databases\",label:Object(n.e)(\"Databases\"),url:\"/databaseview/list/\",usesRouter:!0},{name:\"Datasets\",label:Object(n.e)(\"Datasets\"),url:\"/tablemodelview/list/\",usesRouter:!0},{name:\"Saved queries\",label:Object(n.e)(\"Saved queries\"),url:\"/savedqueryview/list/\",usesRouter:!0},{name:\"Query history\",label:Object(n.e)(\"Query history\"),url:\"/superset/sqllab/history/\",usesRouter:!0}]}},4930:function(e,t,a){\"use strict\";a.r(t);a(33);var n=a(20),s=a(52),o=a(67),c=a(0),l=a.n(c),r=a(95),i=a.n(r),d=a(138),b=a(524),u=a(1486),h=a(1381),p=a(1487),m=a(4477),f=a(977),O=a(4514),j=a(122),g=a(51),y=a(932),v=a(1490),w=a(2068),S=a(4497),x=a(39),C=a(794),_=a.n(C),N=a(313),D=a.n(N),E=a(45),k=a(100),T=a(2070),$=a(1);const I=Object(s.c)(E.a)`\n  margin: auto ${({theme:e})=>2*e.gridUnit}px auto 0;\n`,R=s.c.div`\n  padding-bottom: 340px;\n  width: 65%;\n`;var A=Object(j.a)(({addDangerToast:e,addSuccessToast:t,onDatasetAdd:a,onHide:s,show:r})=>{const[i,b]=Object(c.useState)(\"\"),[u,h]=Object(c.useState)(\"\"),[p,m]=Object(c.useState)(0),[f,O]=Object(c.useState)(!0);return Object($.f)(k.b,{disablePrimaryButton:f,onHandledPrimaryAction:()=>{o.a.post({endpoint:\"/api/v1/dataset/\",body:JSON.stringify({database:p,...i?{schema:i}:{},table_name:u}),headers:{\"Content-Type\":\"application/json\"}}).then(({json:e={}})=>{a&&a({id:e.id,...e.result}),t(Object(n.e)(\"The dataset has been saved\")),s()}).catch(Object(d.c)(t=>e(Object(n.e)(\"Error while saving dataset: %s\",t.table_name))))},onHide:s,primaryButtonName:Object(n.e)(\"Add\"),show:r,title:Object($.f)(l.a.Fragment,null,Object($.f)(I,{name:\"warning-solid\"}),Object(n.e)(\"Add dataset\"))},Object($.f)(R,null,Object($.f)(T.a,{clearable:!1,dbId:p,formMode:!0,handleError:e,onChange:({dbId:e,schema:t,tableName:a})=>{m(e),O(_()(e)||D()(a)),b(t),h(a)},schema:i,tableName:u})))});const z=Object(n.e)('The passwords for the databases below are needed in order to import them together with the datasets. Please note that the \"Secure Extra\" and \"Certificate\" sections of the database configuration are not present in export files, and should be added manually after the import if they are needed.'),L=Object(n.e)(\"You are importing one or more datasets that already exist. Overwriting might cause you to lose some of your work. Are you sure you want to overwrite?\"),U=s.c.div`\n  align-items: center;\n  display: flex;\n\n  > svg {\n    margin-right: ${({theme:e})=>e.gridUnit}px;\n  }\n`,H=s.c.div`\n  color: ${({theme:e})=>e.colors.grayscale.base};\n`;t.default=Object(j.a)(({addDangerToast:e,addSuccessToast:t,user:a})=>{const{state:{loading:s,resourceCount:r,resourceCollection:j,bulkSelectEnabled:C},hasPerm:_,fetchData:N,toggleBulkSelect:D,refreshData:E}=Object(b.e)(\"dataset\",Object(n.e)(\"dataset\"),e),[k,T]=Object(c.useState)(!1),[I,R]=Object(c.useState)(null),[B,P]=Object(c.useState)(null),[q,F]=Object(c.useState)(!1),[M,V]=Object(c.useState)([]),J=()=>{F(!0)},W=_(\"can_write\"),Q=_(\"can_write\"),K=_(\"can_write\"),X=_(\"can_read\"),Y=[{id:\"changed_on_delta_humanized\",desc:!0}],G=Object(c.useCallback)(({id:t})=>{o.a.get({endpoint:\"/api/v1/dataset/\"+t}).then(({json:e={}})=>{const t=e.result.owners.map(e=>e.id);P({...e.result,owners:t})}).catch(()=>{e(Object(n.e)(\"An error occurred while fetching dataset related data\"))})},[e]),Z=Object(c.useMemo)(()=>[{Cell:({row:{original:{kind:e}}})=>\"physical\"===e?Object($.f)(g.a,{id:\"physical-dataset-tooltip\",title:Object(n.e)(\"Physical dataset\")},Object($.f)(y.a.DatasetPhysical,null)):Object($.f)(g.a,{id:\"virtual-dataset-tooltip\",title:Object(n.e)(\"Virtual dataset\")},Object($.f)(y.a.DatasetVirtual,null)),accessor:\"kind_icon\",disableSortBy:!0,size:\"xs\"},{Cell:({row:{original:{extra:e,table_name:t,explore_url:a}}})=>{const n=Object($.f)(\"a\",{href:a},t);try{const t=JSON.parse(e);return null!=t&&t.certification?Object($.f)(U,null,Object($.f)(w.a,{certifiedBy:t.certification.certified_by,details:t.certification.details}),n):n}catch{return n}},Header:Object(n.e)(\"Name\"),accessor:\"table_name\"},{Cell:({row:{original:{kind:e}}})=>{var t;return(null==(t=e[0])?void 0:t.toUpperCase())+e.slice(1)},Header:Object(n.e)(\"Type\"),accessor:\"kind\",disableSortBy:!0,size:\"md\"},{Header:Object(n.e)(\"Source\"),accessor:\"database.database_name\",size:\"lg\"},{Header:Object(n.e)(\"Schema\"),accessor:\"schema\",size:\"lg\"},{Cell:({row:{original:{changed_on_delta_humanized:e}}})=>Object($.f)(\"span\",{className:\"no-wrap\"},e),Header:Object(n.e)(\"Modified\"),accessor:\"changed_on_delta_humanized\",size:\"xl\"},{Cell:({row:{original:{changed_by_name:e}}})=>e,Header:Object(n.e)(\"Modified by\"),accessor:\"changed_by.first_name\",size:\"xl\"},{accessor:\"database\",disableSortBy:!0,hidden:!0},{Cell:({row:{original:{owners:e=[],table_name:t}}})=>Object($.f)(v.a,{users:e}),Header:Object(n.e)(\"Owners\"),id:\"owners\",disableSortBy:!0,size:\"lg\"},{accessor:\"sql\",hidden:!0,disableSortBy:!0},{Cell:({row:{original:e}})=>W||Q||X?Object($.f)(H,{className:\"actions\"},Q&&Object($.f)(g.a,{id:\"delete-action-tooltip\",title:Object(n.e)(\"Delete\"),placement:\"bottom\"},Object($.f)(\"span\",{role:\"button\",tabIndex:0,className:\"action-button\",onClick:()=>{return t=e,o.a.get({endpoint:`/api/v1/dataset/${t.id}/related_objects`}).then(({json:e={}})=>{R({...t,chart_count:e.charts.count,dashboard_count:e.dashboards.count})}).catch(Object(d.c)(e=>Object(n.e)(\"An error occurred while fetching dataset related data: %s\",e)));var t}},Object($.f)(y.a.Trash,null))),X&&Object($.f)(g.a,{id:\"export-action-tooltip\",title:Object(n.e)(\"Export\"),placement:\"bottom\"},Object($.f)(\"span\",{role:\"button\",tabIndex:0,className:\"action-button\",onClick:()=>ne([e])},Object($.f)(y.a.Share,null))),W&&Object($.f)(g.a,{id:\"edit-action-tooltip\",title:Object(n.e)(\"Edit\"),placement:\"bottom\"},Object($.f)(\"span\",{role:\"button\",tabIndex:0,className:\"action-button\",onClick:()=>G(e)},Object($.f)(y.a.EditAlt,null)))):null,Header:Object(n.e)(\"Actions\"),id:\"actions\",hidden:!W&&!Q,disableSortBy:!0}],[W,Q,X,G]),ee=Object(c.useMemo)(()=>[{Header:Object(n.e)(\"Owner\"),id:\"owners\",input:\"select\",operator:\"rel_m_m\",unfilteredLabel:\"All\",fetchSelects:Object(d.e)(\"dataset\",\"owners\",Object(d.c)(e=>Object(n.e)(\"An error occurred while fetching dataset owner values: %s\",e)),a.userId),paginate:!0},{Header:Object(n.e)(\"Database\"),id:\"database\",input:\"select\",operator:\"rel_o_m\",unfilteredLabel:\"All\",fetchSelects:Object(d.e)(\"dataset\",\"database\",Object(d.c)(e=>Object(n.e)(\"An error occurred while fetching datasets: %s\",e))),paginate:!0},{Header:Object(n.e)(\"Schema\"),id:\"schema\",input:\"select\",operator:\"eq\",unfilteredLabel:\"All\",fetchSelects:Object(d.d)(\"dataset\",\"schema\",Object(d.c)(e=>Object(n.e)(\"An error occurred while fetching schema values: %s\",e))),paginate:!0},{Header:Object(n.e)(\"Type\"),id:\"sql\",input:\"select\",operator:\"dataset_is_null_or_empty\",unfilteredLabel:\"All\",selects:[{label:\"Virtual\",value:!1},{label:\"Physical\",value:!0}]},{Header:Object(n.e)(\"Search\"),id:\"table_name\",input:\"search\",operator:\"ct\"}],[]),te={activeChild:\"Datasets\",...O.a},ae=[];(Q||X)&&ae.push({name:Object(n.e)(\"Bulk select\"),onClick:D,buttonStyle:\"secondary\"}),K&&ae.push({name:Object($.f)(l.a.Fragment,null,Object($.f)(\"i\",{className:\"fa fa-plus\"}),\" \",Object(n.e)(\"Dataset\"),\" \"),onClick:()=>T(!0),buttonStyle:\"primary\"}),Object(x.c)(x.a.VERSIONED_EXPORT)&&ae.push({name:Object($.f)(y.a.Import,null),buttonStyle:\"link\",onClick:J}),te.buttons=ae;const ne=e=>window.location.assign(\"/api/v1/dataset/export/?q=\"+i.a.encode(e.map(({id:e})=>e)));return Object($.f)(l.a.Fragment,null,Object($.f)(f.a,te),Object($.f)(A,{show:k,onHide:()=>T(!1),onDatasetAdd:E}),I&&Object($.f)(p.a,{description:Object(n.e)(\"The dataset %s is linked to %s charts that appear on %s dashboards. Are you sure you want to continue? Deleting the dataset will break those objects.\",I.table_name,I.chart_count,I.dashboard_count),onConfirm:()=>{I&&(({id:a,table_name:s})=>{o.a.delete({endpoint:\"/api/v1/dataset/\"+a}).then(()=>{E(),R(null),t(Object(n.e)(\"Deleted: %s\",s))},Object(d.c)(t=>e(Object(n.e)(\"There was an issue deleting %s: %s\",s,t))))})(I)},onHide:()=>{R(null)},open:!0,title:Object(n.e)(\"Delete Dataset?\")}),B&&Object($.f)(h.a,{datasource:B,onDatasourceSave:E,onHide:()=>{P(null)},show:!0}),Object($.f)(u.a,{title:Object(n.e)(\"Please confirm\"),description:Object(n.e)(\"Are you sure you want to delete the selected datasets?\"),onConfirm:a=>{o.a.delete({endpoint:\"/api/v1/dataset/?q=\"+i.a.encode(a.map(({id:e})=>e))}).then(({json:e={}})=>{E(),t(e.message)},Object(d.c)(t=>e(Object(n.e)(\"There was an issue deleting the selected datasets: %s\",t))))}},e=>{const t=[];return Q&&t.push({key:\"delete\",name:Object(n.e)(\"Delete\"),onSelect:e,type:\"danger\"}),X&&t.push({key:\"export\",name:Object(n.e)(\"Export\"),type:\"primary\",onSelect:ne}),Object($.f)(m.b,{className:\"dataset-list-view\",columns:Z,data:j,count:r,pageSize:25,fetchData:N,filters:ee,loading:s,initialSort:Y,bulkActions:t,bulkSelectEnabled:C,disableBulkSelect:D,renderBulkSelectCopy:e=>{const{virtualCount:t,physicalCount:a}=e.reduce((e,t)=>(\"physical\"===t.original.kind?e.physicalCount+=1:\"virtual\"===t.original.kind&&(e.virtualCount+=1),e),{virtualCount:0,physicalCount:0});return e.length?t&&!a?Object(n.e)(\"%s Selected (Virtual)\",e.length,t):a&&!t?Object(n.e)(\"%s Selected (Physical)\",e.length,a):Object(n.e)(\"%s Selected (%s Physical, %s Virtual)\",e.length,a,t):Object(n.e)(\"0 Selected\")}})}),Object($.f)(S.a,{resourceName:\"dataset\",resourceLabel:Object(n.e)(\"dataset\"),passwordsNeededMessage:z,confirmOverwriteMessage:L,addDangerToast:e,addSuccessToast:t,onModelImport:()=>{F(!1),E()},show:q,onHide:()=>{F(!1)},passwordFields:M,setPasswordFields:V}))})},873:function(e,t,a){\"use strict\";var n=a(30),s=a.n(n),o=a(0),c=a.n(o),l=a(2),r=a.n(l),i=a(72),d=a(20),b=a(67),u=a(70),h=a(1);const p={dataEndpoint:r.a.string.isRequired,onChange:r.a.func.isRequired,mutator:r.a.func.isRequired,onAsyncError:r.a.func,value:r.a.oneOfType([r.a.number,r.a.arrayOf(r.a.number)]),valueRenderer:r.a.func,placeholder:r.a.string,autoSelect:r.a.bool},m={placeholder:Object(d.e)(\"Select ...\"),onAsyncError:()=>{}};class f extends c.a.PureComponent{constructor(e){super(e),this.state={isLoading:!1,options:[]},this.onChange=this.onChange.bind(this)}componentDidMount(){this.fetchOptions()}onChange(e){this.props.onChange(e)}fetchOptions(){this.setState({isLoading:!0});const{mutator:e,dataEndpoint:t}=this.props;return b.a.get({endpoint:t}).then(({json:t})=>{const a=e?e(t):t;this.setState({options:a,isLoading:!1}),!this.props.value&&this.props.autoSelect&&a.length>0&&this.onChange(a[0])}).catch(e=>Object(u.a)(e).then(e=>{this.props.onAsyncError(e.error||e.statusText||e),this.setState({isLoading:!1})}))}render(){return Object(h.f)(i.f,s()({placeholder:this.props.placeholder,options:this.state.options,value:this.props.value,isLoading:this.state.isLoading,onChange:this.onChange,valueRenderer:this.props.valueRenderer},this.props))}}f.propTypes=p,f.defaultProps=m,t.a=f}}]);","extractedComments":[]}
{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{4630:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return r}));a(0);var c=a(53),n=a(52),o=a(932),l=a(1);const s=c.c.span`\n  white-space: nowrap;\n  min-width: 100px;\n  svg,\n  i {\n    margin-right: 8px;\n\n    &:hover {\n      path {\n        fill: ${({theme:e})=>e.colors.primary.base};\n      }\n    }\n  }\n`,i=c.c.span`\n  color: ${({theme:e})=>e.colors.grayscale.base};\n`;function r({actions:e}){return Object(l.f)(s,{className:\"actions\"},e.map((e,t)=>{const a=o.a[e.icon];return e.tooltip?Object(l.f)(n.a,{id:e.label+\"-tooltip\",title:e.tooltip,placement:e.placement,key:t},Object(l.f)(i,{role:\"button\",tabIndex:0,className:\"action-button\",onClick:e.onClick},Object(l.f)(a,null))):Object(l.f)(i,{role:\"button\",tabIndex:0,className:\"action-button\",onClick:e.onClick,key:t},Object(l.f)(a,null))}))}},5077:function(e,t,a){\"use strict\";a.r(t);a(34);var c=a(53),n=a(20),o=a(67),l=a(0),s=a.n(l),i=a(94),r=a.n(i),d=a(33),b=a.n(d),u=a(136),p=a(27),h=a(119),j=a(530),O=a(1505),m=a(984),g=a(4623),y=a(1506),f=a(4630),w=a(4660),v=a(256),k=a(100),q=a(42),S=a(4833),C=a(4834),_=a(1);const x=c.c.div`\n  color: ${({theme:e})=>e.colors.secondary.light2};\n  font-size: ${({theme:e})=>e.typography.sizes.s-1}px;\n  margin-bottom: 0;\n  text-transform: uppercase;\n`,D=c.c.div`\n  color: ${({theme:e})=>e.colors.grayscale.dark2};\n  font-size: ${({theme:e})=>e.typography.sizes.m-1}px;\n  padding: 4px 0 16px 0;\n`,z=Object(c.c)(k.b)`\n  .ant-modal-content {\n  }\n\n  .ant-modal-body {\n    padding: 24px;\n  }\n\n  pre {\n    font-size: ${({theme:e})=>e.typography.sizes.xs}px;\n    font-weight: ${({theme:e})=>e.typography.weights.normal};\n    line-height: ${({theme:e})=>e.typography.sizes.l}px;\n    height: 375px;\n    border: none;\n  }\n`;var H=Object(h.a)(({fetchData:e,onHide:t,openInSqlLab:a,queries:c,savedQuery:o,show:l,addDangerToast:s,addSuccessToast:i})=>{const{handleKeyPress:r,handleDataChange:d,disablePrevious:b,disableNext:u}=Object(C.a)({queries:c,currentQueryId:o.id,fetchData:e});return Object(_.f)(\"div\",{role:\"none\",onKeyUp:r},Object(_.f)(z,{onHide:t,show:l,title:Object(n.e)(\"Query preview\"),footer:[Object(_.f)(q.a,{key:\"previous-saved-query\",disabled:b,onClick:()=>d(!0)},Object(n.e)(\"Previous\")),Object(_.f)(q.a,{key:\"next-saved-query\",disabled:u,onClick:()=>d(!1)},Object(n.e)(\"Next\")),Object(_.f)(q.a,{key:\"open-in-sql-lab\",buttonStyle:\"primary\",onClick:()=>a(o.id)},Object(n.e)(\"Open in SQL Lab\"))]},Object(_.f)(x,null,Object(n.e)(\"Query name\")),Object(_.f)(D,null,o.label),Object(_.f)(S.a,{language:\"sql\",addDangerToast:s,addSuccessToast:i},o.sql||\"\")))});const $=c.c.div`\n  .count {\n    margin-left: 5px;\n    color: ${({theme:e})=>e.colors.primary.base};\n    text-decoration: underline;\n    cursor: pointer;\n  }\n`,T=c.c.div`\n  color: ${({theme:e})=>e.colors.grayscale.dark2};\n`;t.default=Object(h.a)((function({addDangerToast:e,addSuccessToast:t,user:a}){const{state:{loading:c,resourceCount:i,resourceCollection:d,bulkSelectEnabled:h},hasPerm:k,fetchData:q,toggleBulkSelect:S,refreshData:C}=Object(j.e)(\"saved_query\",Object(n.e)(\"Saved queries\"),e),[x,D]=Object(l.useState)(null),[z,Q]=Object(l.useState)(null),N=k(\"can_write\"),L=k(\"can_write\"),A=Object(l.useCallback)(t=>{o.a.get({endpoint:\"/api/v1/saved_query/\"+t}).then(({json:e={}})=>{Q({...e.result})},Object(u.c)(t=>e(Object(n.e)(\"There was an issue previewing the selected query %s\",t))))},[e]),B={activeChild:\"Saved queries\",...w.a},I=[];L&&I.push({name:Object(n.e)(\"Bulk select\"),onClick:S,buttonStyle:\"secondary\"}),I.push({name:Object(_.f)(s.a.Fragment,null,Object(_.f)(\"i\",{className:\"fa fa-plus\"}),\" \",Object(n.e)(\"Query\")),onClick:()=>{window.open(window.location.origin+\"/superset/sqllab?new=true\")},buttonStyle:\"primary\"}),B.buttons=I;const M=e=>{window.open(`${window.location.origin}/superset/sqllab?savedQueryId=${e}`)},E=Object(l.useCallback)(a=>{Object(v.a)(`${window.location.origin}/superset/sqllab?savedQueryId=${a}`).then(()=>{t(Object(n.e)(\"Link Copied!\"))}).catch(()=>{e(Object(n.e)(\"Sorry, your browser does not support copying.\"))})},[e,t]),P=[{id:\"changed_on_delta_humanized\",desc:!0}],F=Object(l.useMemo)(()=>[{accessor:\"label\",Header:Object(n.e)(\"Name\")},{accessor:\"database.database_name\",Header:Object(n.e)(\"Database\"),size:\"xl\"},{accessor:\"database\",hidden:!0,disableSortBy:!0},{accessor:\"schema\",Header:Object(n.e)(\"Schema\"),size:\"xl\"},{Cell:({row:{original:{sql_tables:e=[]}}})=>{const t=e.map(e=>e.table),a=t.length>0?t.shift():\"\";return t.length?Object(_.f)($,null,Object(_.f)(\"span\",null,a),Object(_.f)(p.r,{placement:\"right\",title:Object(n.e)(\"TABLES\"),trigger:\"click\",content:Object(_.f)(s.a.Fragment,null,t.map(e=>Object(_.f)(T,{key:e},e)))},Object(_.f)(\"span\",{className:\"count\"},\"(+\",t.length,\")\"))):a},accessor:\"sql_tables\",Header:Object(n.e)(\"Tables\"),size:\"xl\",disableSortBy:!0},{Cell:({row:{original:{created_on:e}}})=>{const t=new Date(e),a=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return b()(a).fromNow()},Header:Object(n.e)(\"Created on\"),accessor:\"created_on\",size:\"xl\"},{Cell:({row:{original:{changed_on_delta_humanized:e}}})=>e,Header:Object(n.e)(\"Modified\"),accessor:\"changed_on_delta_humanized\",size:\"xl\"},{Cell:({row:{original:e}})=>{const t=[{label:\"preview-action\",tooltip:Object(n.e)(\"Query preview\"),placement:\"bottom\",icon:\"Binoculars\",onClick:()=>{A(e.id)}},N?{label:\"edit-action\",tooltip:Object(n.e)(\"Edit query\"),placement:\"bottom\",icon:\"Edit\",onClick:()=>{M(e.id)}}:null,{label:\"copy-action\",tooltip:Object(n.e)(\"Copy query URL\"),placement:\"bottom\",icon:\"Copy\",onClick:()=>{E(e.id)}},L?{label:\"delete-action\",tooltip:Object(n.e)(\"Delete query\"),placement:\"bottom\",icon:\"Trash\",onClick:()=>D(e)}:null].filter(e=>!!e);return Object(_.f)(f.a,{actions:t})},Header:Object(n.e)(\"Actions\"),id:\"actions\",disableSortBy:!0}],[L,N,E,A]),U=Object(l.useMemo)(()=>[{Header:Object(n.e)(\"Database\"),id:\"database\",input:\"select\",operator:\"rel_o_m\",unfilteredLabel:\"All\",fetchSelects:Object(u.e)(\"saved_query\",\"database\",Object(u.c)(t=>e(Object(n.e)(\"An error occurred while fetching dataset datasource values: %s\",t)))),paginate:!0},{Header:Object(n.e)(\"Schema\"),id:\"schema\",input:\"select\",operator:\"eq\",unfilteredLabel:\"All\",fetchSelects:Object(u.d)(\"saved_query\",\"schema\",Object(u.c)(t=>e(Object(n.e)(\"An error occurred while fetching schema values: %s\",t)))),paginate:!0},{Header:Object(n.e)(\"Search\"),id:\"label\",input:\"search\",operator:\"all_text\"}],[e]);return Object(_.f)(s.a.Fragment,null,Object(_.f)(m.a,B),x&&Object(_.f)(y.a,{description:Object(n.e)(\"This action will permanently delete the saved query.\"),onConfirm:()=>{x&&(({id:a,label:c})=>{o.a.delete({endpoint:\"/api/v1/saved_query/\"+a}).then(()=>{C(),D(null),t(Object(n.e)(\"Deleted: %s\",c))},Object(u.c)(t=>e(Object(n.e)(\"There was an issue deleting %s: %s\",c,t))))})(x)},onHide:()=>D(null),open:!0,title:Object(n.e)(\"Delete Query?\")}),z&&Object(_.f)(H,{fetchData:A,onHide:()=>Q(null),savedQuery:z,queries:d,openInSqlLab:M,show:!0}),Object(_.f)(O.a,{title:Object(n.e)(\"Please confirm\"),description:Object(n.e)(\"Are you sure you want to delete the selected queries?\"),onConfirm:a=>{o.a.delete({endpoint:\"/api/v1/saved_query/?q=\"+r.a.encode(a.map(({id:e})=>e))}).then(({json:e={}})=>{C(),t(e.message)},Object(u.c)(t=>e(Object(n.e)(\"There was an issue deleting the selected queries: %s\",t))))}},e=>{const t=L?[{key:\"delete\",name:Object(n.e)(\"Delete\"),onSelect:e,type:\"danger\"}]:[];return Object(_.f)(g.b,{className:\"saved_query-list-view\",columns:F,count:i,data:d,fetchData:q,filters:U,initialSort:P,loading:c,pageSize:25,bulkActions:t,bulkSelectEnabled:h,disableBulkSelect:S,highlightRowId:null==z?void 0:z.id})}))}))}}]);","extractedComments":[]}
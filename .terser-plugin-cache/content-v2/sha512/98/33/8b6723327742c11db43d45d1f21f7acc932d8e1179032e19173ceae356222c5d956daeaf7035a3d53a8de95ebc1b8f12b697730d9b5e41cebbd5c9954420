{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{1047:function(e,t,a){\"use strict\";a(0);var n=a(41),o=a(2349),i=a(1);const s=Object(n.c)(({textColor:e,...t})=>Object(i.e)(o.a,t))`\n  & > sup {\n    padding: 0 0.35px 0 0;\n    background: ${({theme:e,color:t})=>t||e.colors.primary.base};\n    color: ${({theme:e,textColor:t})=>t||e.colors.grayscale.light5};\n  }\n`;t.a=s},1101:function(e,t,a){\"use strict\";var n=a(366),o=a(367),i=a(368),s=a(369),l=a(370),c=a(371),r=a(372),d=a(373),b=a(374),h=a(375),u=a(376),p=a(377),m=a(378),O=a(379),j=a(380),g=a(381),f=a(382),y=a(383),C=a(384),v=a(385),x=a(386),S=a(387),E=a(388),_=a(389),w=a(390),D=a(391),T=a(392),k=a(393),I=a(394),N=a(395),L=a(396),M=a(397),P=a(398),R=a(399),F=a(400),A=a(401),K=a(402),q=a(403),$=a(404),U=a(405),B=a(406),z=a(407),G=a(408),H=a(409),W=a(410),Q=a(411),J=a(412),V=a(413),X=a(414),Y=a(415),Z=a(416),ee=a(417),te=a(418),ae=a(419),ne=a(420),oe=a(421),ie=a(422),se=a(423),le=a(424),ce=a(425),re=a(426),de=a(427),be=a(428),he=a(429),ue=a(430),pe=a(431),me=a(432),Oe=a(433),je=a(434),ge=a(435),fe=a(436),ye=a(437),Ce=a(438),ve=a(439),xe=a(440),Se=a(441),Ee=a(442),_e=a(443),we=a(444),De=a(445),Te=a(446),ke=a(447),Ie=a(448),Ne=a(449),Le=a(450),Me=a(451),Pe=a(452),Re=a(453),Fe=a(454),Ae=a(455),Ke=a(456),qe=a(457),$e=a(458),Ue=a(459),Be=a(460),ze=a(461),Ge=a(462),He=a(463),We=a(464),Qe=a(465),Je=a(466),Ve=a(467),Xe=a(468),Ye=a(469),Ze=a(470),et=a(471),tt=a(472),at=a(473),nt=a(474),ot=a(475),it=a(476),st=a(477),lt=a(478),ct=a(479),rt=a(480),dt=a(481),bt=a(482),ht=a(483),ut=a(484),pt=a(485),mt=a(486),Ot=a(487),jt=a(488),gt=a(489),ft=a(490),yt=a(491),Ct=a(27),vt=a.n(Ct),xt=(a(0),a(2332)),St=a(1315),Et=a(41),_t=a(1);const wt=Object(Et.c)(({iconColor:e,iconSize:t,...a})=>Object(_t.e)(St.a,vt()({viewBox:a.viewBox||\"0 0 24 24\"},a)))`\n  ${({iconColor:e})=>e&&`color: ${e};`};\n  font-size: ${({iconSize:e,theme:t})=>e?t.typography.sizes[e]+\"px\":\"24px\"};\n`,Dt=(e,t)=>Object(_t.e)(wt,vt()({component:e},t));var Tt=wt;var kt=Object.keys(xt).map(e=>({[e]:t=>Object(_t.e)(Tt,vt()({component:xt[e]},t))})).reduce((e,t)=>({...e,...t}));t.a={...kt,Alert:e=>Dt(n.a,e),AlertSolid:e=>Dt(o.a,e),AlertSolidSmall:e=>Dt(i.a,e),Binoculars:e=>Dt(s.a,e),Bolt:e=>Dt(l.a,e),BoltSmall:e=>Dt(c.a,e),BoltSmallRun:e=>Dt(r.a,e),Calendar:e=>Dt(d.a,e),Cancel:e=>Dt(b.a,e),CancelSolid:e=>Dt(h.a,e),CancelX:e=>Dt(u.a,e),CardView:e=>Dt(p.a,e),Cards:e=>Dt(m.a,e),CardsLocked:e=>Dt(O.a,e),CaretDown:e=>Dt(j.a,e),CaretLeft:e=>Dt(g.a,e),CaretRight:e=>Dt(f.a,e),CaretUp:e=>Dt(y.a,e),Certified:e=>Dt(C.a,e),Check:e=>Dt(v.a,e),CheckboxHalf:e=>Dt(x.a,e),CheckboxOff:e=>Dt(S.a,e),CheckboxOn:e=>Dt(E.a,e),CircleCheck:e=>Dt(_.a,e),CircleCheckSolid:e=>Dt(w.a,e),Circle:e=>Dt(D.a,e),Clock:e=>Dt(T.a,e),Close:e=>Dt(k.a,e),Code:e=>Dt(I.a,e),Cog:e=>Dt(N.a,e),Collapse:e=>Dt(L.a,e),ColorPalette:e=>Dt(M.a,e),Components:e=>Dt(P.a,e),Copy:e=>Dt(R.a,e),CursorTarget:e=>Dt(F.a,e),Database:e=>Dt(A.a,e),DatasetPhysical:e=>Dt(K.a,e),DatasetVirtualGreyscale:e=>Dt(q.a,e),DatasetVirtual:e=>Dt($.a,e),Download:e=>Dt(U.a,e),EditAlt:e=>Dt(B.a,e),Edit:e=>Dt(z.a,e),Email:e=>Dt(G.a,e),Error:e=>Dt(H.a,e),ErrorSolid:e=>Dt(W.a,e),ErrorSolidSmall:e=>Dt(Q.a,e),Exclamation:e=>Dt(J.a,e),Expand:e=>Dt(V.a,e),Eye:e=>Dt(X.a,e),EyeSlash:e=>Dt(Y.a,e),FavoriteSelected:e=>Dt(Z.a,e),FavoriteSmallSelected:e=>Dt(ee.a,e),FavoriteUnselected:e=>Dt(te.a,e),FieldABCIcon:e=>Dt(ae.a,e),FieldBoolean:e=>Dt(ne.a,e),FieldDate:e=>Dt(oe.a,e),FieldDerived:e=>Dt(ie.a,e),FieldNum:e=>Dt(se.a,e),FieldStruct:e=>Dt(le.a,e),File:e=>Dt(ce.a,e),Filter:e=>Dt(re.a,e),FilterSmall:e=>Dt(de.a,e),Folder:e=>Dt(be.a,e),Full:e=>Dt(he.a,e),Function:e=>Dt(ue.a,e),Gear:e=>Dt(pe.a,e),Grid:e=>Dt(me.a,e),Image:e=>Dt(Oe.a,e),Import:e=>Dt(je.a,e),Info:e=>Dt(ge.a,e),InfoSolid:e=>Dt(fe.a,e),InfoSolidSmall:e=>Dt(ye.a,e),Join:e=>Dt(Ce.a,e),Keyboard:e=>Dt(ve.a,e),Layers:e=>Dt(xe.a,e),Lightbulb:e=>Dt(Se.a,e),Link:e=>Dt(Ee.a,e),List:e=>Dt(_e.a,e),ListView:e=>Dt(we.a,e),Location:e=>Dt(De.a,e),LockLocked:e=>Dt(Te.a,e),LockUnlocked:e=>Dt(ke.a,e),Map:e=>Dt(Ie.a,e),Message:e=>Dt(Ne.a,e),Minus:e=>Dt(Le.a,e),MinusSolid:e=>Dt(Me.a,e),MoreHoriz:e=>Dt(Pe.a,e),Move:e=>Dt(Re.a,e),NavCharts:e=>Dt(Fe.a,e),NavDashboard:e=>Dt(Ae.a,e),NavData:e=>Dt(Ke.a,e),NavExplore:e=>Dt(qe.a,e),NavHome:e=>Dt($e.a,e),NavLab:e=>Dt(Ue.a,e),Note:e=>Dt(Be.a,e),Offline:e=>Dt(ze.a,e),Paperclip:e=>Dt(Ge.a,e),Placeholder:e=>Dt(He.a,e),Plus:e=>Dt(We.a,e),PlusLarge:e=>Dt(Qe.a,e),PlusSmall:e=>Dt(Je.a,e),PlusSolid:e=>Dt(Ve.a,e),Queued:e=>Dt(Xe.a,e),Refresh:e=>Dt(Ye.a,e),Running:e=>Dt(Ze.a,e),Save:e=>Dt(et.a,e),SQL:e=>Dt(tt.a,e),Search:e=>Dt(at.a,e),Server:e=>Dt(nt.a,e),Share:e=>Dt(ot.a,e),Slack:e=>Dt(it.a,e),SortAsc:e=>Dt(st.a,e),SortDesc:e=>Dt(lt.a,e),Sort:e=>Dt(ct.a,e),Table:e=>Dt(rt.a,e),Tag:e=>Dt(dt.a,e),Trash:e=>Dt(bt.a,e),TriangleChange:e=>Dt(ht.a,e),TriangleDown:e=>Dt(ut.a,e),TriangleUp:e=>Dt(pt.a,e),UpLevel:e=>Dt(mt.a,e),User:e=>Dt(Ot.a,e),Warning:e=>Dt(jt.a,e),WarningSolid:e=>Dt(gt.a,e),XLarge:e=>Dt(ft.a,e),XSmall:e=>Dt(yt.a,e)}},1104:function(e,t,a){\"use strict\";var n=a(0),o=a.n(n),i=a(45),s=a(42),l=a(1);t.a=({onClick:e,tooltipContent:t})=>{const a=o.a.forwardRef((e,t)=>Object(l.e)(s.a,e));return Object(l.e)(i.a,{title:t},Object(l.e)(a,{role:\"button\",onClick:e,name:\"refresh\",css:e=>({cursor:\"pointer\",color:e.colors.grayscale.base,\"&:hover\":{color:e.colors.primary.base}})}))}},1481:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return o}));var n=/-(.)/g;function o(e){return e.replace(n,(function(e,t){return t.toUpperCase()}))}},1528:function(e,t,a){\"use strict\";var n=a(0),o=a.n(n),i=a(13),s=a(41),l=a(42),c=a(45),r=a(1);t.a=function({certifiedBy:e,details:t,size:a=24}){return Object(r.e)(c.a,{id:\"certified-details-tooltip\",title:Object(r.e)(o.a.Fragment,null,e&&Object(r.e)(\"div\",null,Object(i.e)(\"Certified by %s\",e)),Object(r.e)(\"div\",null,t))},Object(r.e)(l.a,{color:s.d.colors.primary.base,height:a,width:a,name:\"certified\"}))}},1530:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return j}));a(31);var n=a(0),o=a(41),i=a(62),s=a(13),l=a(92),c=a.n(l),r=a(63),d=a(99),b=a(1104),h=a(528),u=a(1);const p=o.c.p`\n  color: ${({theme:e})=>e.colors.secondary.light2};\n  font-size: ${({theme:e})=>e.typography.sizes.s}px;\n  margin: 20px 0 10px 0;\n  text-transform: uppercase;\n`,m=o.c.div`\n  .fa-refresh {\n    padding-left: 9px;\n  }\n\n  .refresh-col {\n    display: flex;\n    align-items: center;\n    width: 30px;\n    margin-left: ${({theme:e})=>e.gridUnit}px;\n  }\n\n  .section {\n    padding-bottom: 5px;\n    display: flex;\n    flex-direction: row;\n  }\n\n  .select {\n    flex-grow: 1;\n  }\n`,O=o.c.span`\n  display: inline-flex;\n  align-items: center;\n`;function j({dbId:e,formMode:t=!1,getDbList:a,getTableList:o,handleError:l,isDatabaseSelectEnabled:j=!0,onChange:g,onDbChange:f,onSchemaChange:y,onSchemasLoad:C,readOnly:v=!1,schema:x,sqlLabMode:S=!1}){const[E,_]=Object(n.useState)(e),[w,D]=Object(n.useState)(x),[T,k]=Object(n.useState)(!1),[I,N]=Object(n.useState)([]);function L(t,a=!1){const n=t||e;if(n){k(!0);const e=`/api/v1/database/${n}/schemas/?q=${c.a.encode({force:Boolean(a)})}`;return i.a.get({endpoint:e}).then(({json:e})=>{const t=e.result.map(e=>({value:e,label:e,title:e}));N(t),k(!1),C&&C(t)}).catch(()=>{N([]),k(!1),l(Object(s.e)(\"Error while fetching schema list\"))})}return Promise.resolve()}function M({dbId:e,schema:t}){_(e),D(t),g&&g({dbId:e,schema:t,tableName:void 0})}function P(e){return a&&a(e.result),0===e.result.length&&l(Object(s.e)(\"It seems you don't have access to any database\")),e.result.map(e=>({...e,label:`${e.backend} ${e.database_name}`}))}function R(e,t=!1){const a=e?e.id:null;N([]),y&&y(null),f&&f(e),L(a,t),M({dbId:a,schema:void 0})}function F(e){return Object(u.e)(O,{title:e.database_name},Object(u.e)(d.a,{type:\"default\"},e.backend),\" \",e.database_name)}function A(e,t){return Object(u.e)(\"div\",{className:\"section\"},Object(u.e)(\"span\",{className:\"select\"},e),Object(u.e)(\"span\",{className:\"refresh-col\"},t))}return Object(n.useEffect)(()=>{E&&L(E)},[E]),Object(u.e)(m,null,t&&Object(u.e)(p,null,Object(s.e)(\"datasource\")),function(){const e=c.a.encode({order_columns:\"database_name\",order_direction:\"asc\",page:0,page_size:-1,...t||!S?{}:{filters:[{col:\"expose_in_sqllab\",opr:\"eq\",value:!0}]}});return A(Object(u.e)(h.a,{dataEndpoint:\"/api/v1/database/?q=\"+e,onChange:e=>R(e),onAsyncError:()=>l(Object(s.e)(\"Error while fetching database list\")),clearable:!1,value:E,valueKey:\"id\",valueRenderer:e=>Object(u.e)(\"div\",null,Object(u.e)(\"span\",{className:\"text-muted m-r-5\"},Object(s.e)(\"Database:\")),F(e)),optionRenderer:F,mutator:P,placeholder:Object(s.e)(\"Select a database\"),autoSelect:!0,isDisabled:!j||v}),null)}(),t&&Object(u.e)(p,null,Object(s.e)(\"schema\")),function(){const a=I.filter(({value:e})=>w===e),n=!t&&!v&&Object(u.e)(b.a,{onClick:()=>R({id:e},!0),tooltipContent:Object(s.e)(\"Force refresh schema list\")});return A(Object(u.e)(r.f,{name:\"select-schema\",placeholder:Object(s.e)(\"Select a schema (%s)\",I.length),options:I,value:a,valueRenderer:e=>Object(u.e)(\"div\",null,Object(u.e)(\"span\",{className:\"text-muted\"},Object(s.e)(\"Schema:\")),\" \",e.label),isLoading:T,autosize:!1,onChange:e=>function(e,t=!1){const a=e?e.value:null;y&&y(a),D(a),M({dbId:E,schema:a}),o&&o(E,a,t)}(e),isDisabled:v}),n)}())}},1542:function(e,t,a){\"use strict\";a(31);var n=a(0),o=a(41),i=a(62),s=a(13),l=a(63),c=a(85),r=a(1530),d=a(1104),b=a(1528),h=a(1);const u=o.c.p`\n  color: ${({theme:e})=>e.colors.secondary.light2};\n  font-size: ${({theme:e})=>e.typography.sizes.s}px;\n  margin: 20px 0 10px 0;\n  text-transform: uppercase;\n`,p=o.c.div`\n  .fa-refresh {\n    padding-left: 9px;\n  }\n\n  .refresh-col {\n    display: flex;\n    align-items: center;\n    width: 30px;\n    margin-left: ${({theme:e})=>e.gridUnit}px;\n  }\n\n  .section {\n    padding-bottom: 5px;\n    display: flex;\n    flex-direction: row;\n  }\n\n  .select {\n    flex-grow: 1;\n  }\n\n  .divider {\n    border-bottom: 1px solid ${({theme:e})=>e.colors.secondary.light5};\n    margin: 15px 0;\n  }\n`,m=o.c.span`\n  align-items: center;\n  display: flex;\n  white-space: nowrap;\n\n  > svg,\n  > small {\n    margin-right: ${({theme:e})=>e.gridUnit}px;\n  }\n`;t.a=({database:e,dbId:t,formMode:a=!1,getDbList:o,handleError:O,isDatabaseSelectEnabled:j=!0,onChange:g,onDbChange:f,onSchemaChange:y,onSchemasLoad:C,onTableChange:v,onTablesLoad:x,readOnly:S=!1,schema:E,sqlLabMode:_=!0,tableName:w,tableNameSticky:D=!0})=>{const[T,k]=Object(n.useState)(E),[I,N]=Object(n.useState)(w),[L,M]=Object(n.useState)(!1),[P,R]=Object(n.useState)([]);function F(e,a,n=!1,o=\"undefined\"){const l=a||T,c=e||t;if(c&&l){const e=encodeURIComponent(l),t=encodeURIComponent(o);M(!0),R([]);const a=encodeURI(`/superset/tables/${c}/${e}/${t}/${!!n}/`);return i.a.get({endpoint:a}).then(({json:e})=>{const t=e.options.map(e=>({value:e.value,schema:e.schema,label:e.label,title:e.title,type:e.type,extra:null==e?void 0:e.extra}));M(!1),R(t),x&&x(e.options)}).catch(()=>{M(!1),R([]),O(Object(s.e)(\"Error while fetching table list\"))})}return M(!1),R([]),Promise.resolve()}function A({dbId:e,schema:t,tableName:a}){N(a),k(t),g&&g({dbId:e,schema:t,tableName:a})}function K(e=\"undefined\"){if(!t||!e){const e=[];return Promise.resolve({options:e})}const a=encodeURIComponent(E||\"\"),n=encodeURIComponent(e);return i.a.get({endpoint:encodeURI(`/superset/tables/${t}/${a}/${n}`)}).then(({json:e})=>({options:e.options.map(e=>({value:e.value,schema:e.schema,label:e.label,title:e.title,type:e.type}))}))}function q(e){if(!e)return void N(\"\");const a=e.schema,n=e.value;D&&A({dbId:t,schema:a,tableName:n}),v&&v(n,a)}function $(e){var t;return Object(h.e)(m,{title:e.label},Object(h.e)(\"small\",{className:\"text-muted\"},Object(h.e)(\"i\",{className:\"fa fa-\"+(\"view\"===e.type?\"eye\":\"table\")})),(null==(t=e.extra)?void 0:t.certification)&&Object(h.e)(b.a,{certifiedBy:e.extra.certification.certified_by,details:e.extra.certification.details,size:20}),e.label)}return Object(n.useEffect)(()=>{t&&E&&F()},[t,E]),Object(h.e)(p,null,Object(h.e)(r.a,{dbId:t,formMode:a,getDbList:o,getTableList:F,handleError:O,onChange:A,onDbChange:S?void 0:f,onSchemaChange:S?void 0:y,onSchemasLoad:C,schema:T,sqlLabMode:_,isDatabaseSelectEnabled:j&&!S,readOnly:S}),!a&&Object(h.e)(\"div\",{className:\"divider\"}),_&&Object(h.e)(\"div\",{className:\"section\"},Object(h.e)(c.a,null,Object(s.e)(\"See table schema\"),\" \",E&&Object(h.e)(\"small\",null,P.length,\" in\",Object(h.e)(\"i\",null,E)))),a&&Object(h.e)(u,null,Object(s.e)(\"Table\")),function(){const n=P;let o=null;if(T&&!a)o=Object(h.e)(l.f,{name:\"select-table\",isLoading:L,ignoreAccents:!1,placeholder:Object(s.e)(\"Select table or type table name\"),autosize:!1,onChange:q,options:n,value:I,optionRenderer:$,valueRenderer:$,isDisabled:S});else if(a)o=Object(h.e)(l.c,{name:\"select-table\",isLoading:L,ignoreAccents:!1,placeholder:Object(s.e)(\"Select table or type table name\"),autosize:!1,onChange:q,options:n,value:I,optionRenderer:$});else{let t,a=!1;e&&e.allow_multi_schema_metadata_fetch?t=Object(s.e)(\"Type to search ...\"):(t=Object(s.e)(\"Select table \"),a=!0),o=Object(h.e)(l.b,{name:\"async-select-table\",placeholder:t,isDisabled:a,autosize:!1,onChange:q,value:I,loadOptions:K,optionRenderer:$})}return function(e,t){return Object(h.e)(\"div\",{className:\"section\"},Object(h.e)(\"span\",{className:\"select\"},e),Object(h.e)(\"span\",{className:\"refresh-col\"},t))}(o,!a&&!S&&Object(h.e)(d.a,{onClick:()=>function(e,a=!1){const n=e?e.value:null;y&&y(n),A({dbId:t,schema:n,tableName:void 0}),F(t,T,a)}({value:E},!0),tooltipContent:Object(s.e)(\"Force refresh table list\")}))}())}},2350:function(e,t,a){\"use strict\";a.r(t);a(31);var n=a(0),o=a.n(n),i=a(2),s=a.n(i),l=a(4641),c=a(226),r=a(146),d=a(163),b=a(1047),h=a(82),u=a.n(h),p=a(41),m=a(13),O=a(62),j=a(38),g=a(108),f=a(1528),y=a(1530),C=a(42),v=a(99),x=a(125),S=a(1542),E=a(896),_=a(66),w=a(316),D=a(314),T=a(517),k=a(1350),I=a(1357),N=a(1358),L=a(1101),M=a(4637);function P(e,t,a){return o.a.Children.map(e,e=>{let n=e;return e&&e.type.name===t.name&&(n=o.a.cloneElement(e,a(e))),n&&n.props.children&&(n=o.a.cloneElement(n,{children:P(n.props.children,t,a)})),n})}var R=a(764),F=a(363),A=a(45),K=a(85),q=(a(4878),a(1));const $={value:s.a.any,label:s.a.string.isRequired,description:s.a.node,fieldKey:s.a.string.isRequired,control:s.a.node.isRequired,onChange:s.a.func,compact:s.a.bool};class U extends o.a.PureComponent{constructor(e){super(e),this.onChange=this.onChange.bind(this)}onChange(e){this.props.onChange(this.props.fieldKey,e)}render(){const{compact:e,value:t,label:a,control:n,description:i,fieldKey:s}=this.props,l=o.a.cloneElement(n,{value:t,onChange:this.onChange});return Object(q.e)(R.a,{controlId:s},Object(q.e)(K.a,{className:\"m-r-5\"},a||s,e&&i&&Object(q.e)(A.a,{id:\"field-descr\",placement:\"right\",title:i},Object(q.e)(\"i\",{className:\"fa fa-info-circle m-l-5\"}))),\" \",l,Object(q.e)(F.a.Feedback,null))}}U.propTypes=$,U.defaultProps={onChange:()=>{},compact:!1,description:null};const B={children:s.a.node.isRequired,onChange:s.a.func,item:s.a.object,title:s.a.node,compact:s.a.bool};class z extends o.a.PureComponent{constructor(e){super(e),this.onChange=this.onChange.bind(this)}onChange(e,t){return this.props.onChange({...this.props.item,[e]:t})}render(){const{title:e}=this.props;return Object(q.e)(M.a,{componentClass:\"fieldset\",className:\"CRUD\"},e&&Object(q.e)(\"legend\",null,e),P(this.props.children,U,e=>({onChange:this.onChange,value:this.props.item[e.props.fieldKey],compact:this.props.compact})))}}function G(e){const t=e.map(e=>({...e,id:e.id||u.a.generate()})),a={};return t.forEach(e=>{a[e.id]=e}),a}z.propTypes=B,z.defaultProps={compact:!1,title:null};const H=p.c.div`\n  ${({stickyHeader:e})=>e&&\"\\n      height: 350px;\\n      overflow: auto;\\n\\n      thead th {\\n        background: #fff;\\n        position: sticky;\\n        top: 0;\\n        z-index: 9;\\n      }\\n    \"}\n`,W=p.c.div`\n  text-align: right;\n  ${({theme:e})=>`margin-bottom: ${2*e.gridUnit}px`}\n`;class Q extends o.a.PureComponent{constructor(e){super(e),this.state={expandedColumns:{},collection:G(e.collection)},this.renderItem=this.renderItem.bind(this),this.onAddItem=this.onAddItem.bind(this),this.renderExpandableSection=this.renderExpandableSection.bind(this),this.getLabel=this.getLabel.bind(this),this.onFieldsetChange=this.onFieldsetChange.bind(this),this.renderTableBody=this.renderTableBody.bind(this),this.changeCollection=this.changeCollection.bind(this)}UNSAFE_componentWillReceiveProps(e){e.collection!==this.props.collection&&this.setState({collection:G(e.collection)})}onCellChange(e,t,a){this.changeCollection({...this.state.collection,[e]:{...this.state.collection[e],[t]:a}})}onAddItem(){if(this.props.itemGenerator){let e=this.props.itemGenerator();e.id||(e={...e,id:u.a.generate()}),this.changeCollection({...this.state.collection,[e.id]:e})}}onFieldsetChange(e){this.changeCollection({...this.state.collection,[e.id]:e})}getLabel(e){const{columnLabels:t}=this.props;let a=t&&t[e]?t[e]:e;return a.startsWith(\"__\")&&(a=\"\"),a}changeCollection(e){this.setState({collection:e}),this.props.onChange&&this.props.onChange(Object.keys(e).map(t=>e[t]))}deleteItem(e){const t={...this.state.collection};delete t[e],this.changeCollection(t)}effectiveTableColumns(){const{tableColumns:e,allowDeletes:t,expandFieldset:a}=this.props,n=t?e.concat([\"__actions\"]):e;return a?[\"__expand\"].concat(n):n}toggleExpand(e){this.onCellChange(e,\"__expanded\",!1),this.setState(t=>({expandedColumns:{...t.expandedColumns,[e]:!t.expandedColumns[e]}}))}renderHeaderRow(){const e=this.effectiveTableColumns(),{allowDeletes:t,expandFieldset:a,extraButtons:n}=this.props;return Object(q.e)(\"thead\",null,Object(q.e)(\"tr\",null,a&&Object(q.e)(\"th\",{\"aria-label\":\"Expand\",className:\"tiny-cell\"}),e.map(e=>Object(q.e)(\"th\",{key:e},this.getLabel(e))),n,t&&Object(q.e)(\"th\",{key:\"delete-item\",\"aria-label\":\"Delete\",className:\"tiny-cell\"})))}renderExpandableSection(e){return P(this.props.expandFieldset,z,()=>({item:e,onChange:this.onFieldsetChange}))}renderCell(e,t){const a=this.props.itemRenderers&&this.props.itemRenderers[t],n=e[t],o=this.onCellChange.bind(this,e.id,t);return a?a(n,o,this.getLabel(t),e):n}renderItem(e){const{allowAddItem:t,allowDeletes:a,expandFieldset:n,tableColumns:o}=this.props,i=!!this.state.expandedColumns[e.id]||e.__expanded;let s=[];n&&s.push(Object(q.e)(\"td\",{key:\"__expand\",className:\"expand\"},Object(q.e)(\"i\",{role:\"button\",\"aria-label\":\"Toggle expand\",tabIndex:0,className:`fa fa-caret-${i?\"down\":\"right\"} text-primary pointer`,onClick:this.toggleExpand.bind(this,e.id)}))),s=s.concat(o.map(t=>Object(q.e)(\"td\",{key:t},this.renderCell(e,t)))),t&&s.push(Object(q.e)(\"td\",{key:\"add\"})),a&&s.push(Object(q.e)(\"td\",{key:\"__actions\",className:\"text-primary\"},Object(q.e)(L.a.Trash,{\"aria-label\":\"Delete item\",className:\"pointer\",iconSize:\"m\",role:\"button\",tabIndex:0,onClick:this.deleteItem.bind(this,e.id)})));const l=[Object(q.e)(\"tr\",{\"data-test\":\"table-row\",className:\"row\",key:e.id},s)];return i&&l.push(Object(q.e)(\"tr\",{className:\"exp\",key:\"exp__\"+e.id},Object(q.e)(\"td\",{colSpan:this.effectiveTableColumns().length,className:\"expanded\"},Object(q.e)(\"div\",null,this.renderExpandableSection(e))))),l}renderEmptyCell(){return Object(q.e)(\"tr\",null,Object(q.e)(\"td\",{className:\"empty-collection\"},this.props.emptyMessage))}renderTableBody(){const e=Object.keys(this.state.collection).map(e=>this.state.collection[e]),t=e.length?e.map(e=>this.renderItem(e)):this.renderEmptyCell();return Object(q.e)(\"tbody\",null,t)}render(){return Object(q.e)(o.a.Fragment,null,Object(q.e)(W,null,this.props.allowAddItem&&Object(q.e)(\"span\",{className:\"m-t-10 m-r-10\"},Object(q.e)(j.a,{buttonSize:\"small\",buttonStyle:\"primary\",onClick:this.onAddItem},Object(q.e)(\"i\",{className:\"fa fa-plus\"}),\" \",Object(m.e)(\"Add item\")))),Object(q.e)(H,{className:\"CRUD\",stickyHeader:this.props.stickyHeader},Object(q.e)(\"table\",{className:\"table\"},this.renderHeaderRow(),this.renderTableBody())))}}var J=a(114),V=a(36);const X=p.c.div`\n  .change-warning {\n    margin: 16px 10px 0;\n    color: ${({theme:e})=>e.colors.warning.base};\n  }\n\n  .change-warning .bold {\n    font-weight: ${({theme:e})=>e.typography.weights.bold};\n  }\n\n  .form-group.has-feedback > .help-block {\n    margin-top: 8px;\n  }\n\n  .form-group.form-group-md {\n    margin-bottom: 8px;\n  }\n`,Y=p.c.div`\n  align-items: center;\n  display: flex;\n\n  > svg {\n    margin-right: ${({theme:e})=>e.gridUnit}px;\n  }\n`,Z=p.c.div`\n  font-size: ${p.d.typography.sizes.s}px;\n  display: flex;\n  align-items: center;\n  a {\n    padding: 0 10px;\n  }\n`,ee=p.c.div`\n  text-align: right;\n  ${({theme:e})=>`margin-bottom: ${2*e.gridUnit}px`}\n`,te=(e,t)=>Object(q.e)(w.a,{value:e,onChange:t}),ae=[\"STRING\",\"NUMERIC\",\"DATETIME\"],ne=[{key:\"physical\",label:Object(m.e)(\"Physical (table or view)\")},{key:\"virtual\",label:Object(m.e)(\"Virtual (SQL)\")}],oe={};function ie({title:e,collection:t}){return Object(q.e)(\"div\",null,e,\" \",Object(q.e)(b.a,{count:t?t.length:0,showZero:!0}))}function se({columns:e,onChange:t,editableColumnName:a,showExpression:n,allowAddItem:o,allowEditDataType:i,itemGenerator:s}){return Object(q.e)(Q,{collection:e,tableColumns:[\"column_name\",\"type\",\"is_dttm\",\"filterable\",\"groupby\"],allowDeletes:!0,allowAddItem:o,itemGenerator:s,stickyHeader:!0,expandFieldset:Object(q.e)(ce,null,Object(q.e)(z,{compact:!0},n&&Object(q.e)(U,{fieldKey:\"expression\",label:Object(m.e)(\"SQL expression\"),control:Object(q.e)(k.a,{language:\"markdown\",offerEditInModal:!1})}),Object(q.e)(U,{fieldKey:\"verbose_name\",label:Object(m.e)(\"Label\"),control:Object(q.e)(D.a,{controlId:\"verbose_name\",placeholder:Object(m.e)(\"Label\")})}),Object(q.e)(U,{fieldKey:\"description\",label:Object(m.e)(\"Description\"),control:Object(q.e)(D.a,{controlId:\"description\",placeholder:Object(m.e)(\"Description\")})}),i&&Object(q.e)(U,{fieldKey:\"type\",label:Object(m.e)(\"Data type\"),control:Object(q.e)(T.a,{choices:ae,name:\"type\",freeForm:!0})}),Object(q.e)(U,{fieldKey:\"python_date_format\",label:Object(m.e)(\"Datetime format\"),description:Object(q.e)(\"div\",null,Object(m.e)(\"The pattern of timestamp format. For strings use \"),Object(q.e)(\"a\",{href:\"https://docs.python.org/2/library/datetime.html#strftime-strptime-behavior\"},Object(m.e)(\"Python datetime string pattern\")),Object(m.e)(\" expression which needs to adhere to the \"),Object(q.e)(\"a\",{href:\"https://en.wikipedia.org/wiki/ISO_8601\"},Object(m.e)(\"ISO 8601\")),Object(m.e)(\" standard to ensure that the lexicographical ordering\\n                      coincides with the chronological ordering. If the\\n                      timestamp format does not adhere to the ISO 8601 standard\\n                      you will need to define an expression and type for\\n                      transforming the string into a date or timestamp. Note\\n                      currently time zones are not supported. If time is stored\\n                      in epoch format, put `epoch_s` or `epoch_ms`. If no pattern\\n                      is specified we fall back to using the optional defaults on a per\\n                      database/column name level via the extra parameter.\")),control:Object(q.e)(D.a,{controlId:\"python_date_format\",placeholder:\"%Y/%m/%d\"})}))),columnLabels:{column_name:Object(m.e)(\"Column\"),type:Object(m.e)(\"Data type\"),groupby:Object(m.e)(\"Is dimension\"),is_dttm:Object(m.e)(\"Is temporal\"),filterable:Object(m.e)(\"Is filterable\")},onChange:t,itemRenderers:{column_name:(e,t)=>a?Object(q.e)(E.a,{canEdit:!0,title:e,onSaveTitle:t}):e,type:e=>Object(q.e)(v.a,null,e),is_dttm:te,filterable:te,groupby:te}})}function le({label:e,formElement:t}){return Object(q.e)(\"div\",null,Object(q.e)(\"div\",null,Object(q.e)(\"strong\",null,e)),Object(q.e)(\"div\",null,t))}function ce({children:e}){return Object(q.e)(l.a,{style:{marginTop:20}},e)}ne.forEach(e=>{oe[e.key]=e}),ie.propTypes={title:s.a.string,collection:s.a.array},se.propTypes={columns:s.a.array.isRequired,onChange:s.a.func.isRequired,editableColumnName:s.a.bool,showExpression:s.a.bool,allowAddItem:s.a.bool,allowEditDataType:s.a.bool,itemGenerator:s.a.func},se.defaultProps={editableColumnName:!1,showExpression:!1,allowAddItem:!1,allowEditDataType:!1,itemGenerator:()=>({column_name:\"<new column>\",filterable:!0,groupby:!0})},le.propTypes={label:s.a.string,formElement:s.a.node},ce.propTypes={children:s.a.node};const re={datasource:s.a.object.isRequired,onChange:s.a.func,addSuccessToast:s.a.func.isRequired,addDangerToast:s.a.func.isRequired};class de extends o.a.PureComponent{constructor(e){super(e),this.state={datasource:e.datasource,errors:[],isDruid:\"druid\"===e.datasource.type||\"druid\"===e.datasource.datasource_type,isSqla:\"table\"===e.datasource.datasource_type||\"table\"===e.datasource.type,isEditMode:!1,databaseColumns:e.datasource.columns.filter(e=>!e.expression),calculatedColumns:e.datasource.columns.filter(e=>!!e.expression),metadataLoading:!1,activeTabKey:0,datasourceType:e.datasource.sql?oe.virtual.key:oe.physical.key},this.onChange=this.onChange.bind(this),this.onChangeEditMode=this.onChangeEditMode.bind(this),this.onDatasourcePropChange=this.onDatasourcePropChange.bind(this),this.onDatasourceChange=this.onDatasourceChange.bind(this),this.syncMetadata=this.syncMetadata.bind(this),this.setColumns=this.setColumns.bind(this),this.validateAndChange=this.validateAndChange.bind(this),this.handleTabSelect=this.handleTabSelect.bind(this),this.allowEditSource=!Object(V.c)(V.a.DISABLE_DATASET_SOURCE_EDIT)}onChange(){const{datasourceType:e,datasource:t}=this.state,a=e===oe.physical.key?\"\":t.sql,n={...this.state.datasource,sql:a,columns:[...this.state.databaseColumns,...this.state.calculatedColumns]};this.props.onChange(n,this.state.errors)}onChangeEditMode(){this.setState(e=>({isEditMode:!e.isEditMode}))}onDatasourceChange(e){this.setState({datasource:e},this.validateAndChange)}onDatasourcePropChange(e,t){const a={...this.state.datasource,[e]:t};this.setState(a=>({datasource:{...a.datasource,[e]:t}}),this.onDatasourceChange(a))}onDatasourceTypeChange(e){this.setState({datasourceType:e})}setColumns(e){this.setState(e,this.validateAndChange)}validateAndChange(){this.validate(this.onChange)}updateColumns(e){const{databaseColumns:t}=this.state,a=e.map(e=>e.name),n=t.reduce((e,t)=>({...e,[t.column_name]:t}),{}),o=[],i={added:[],modified:[],removed:t.map(e=>e.column_name).filter(e=>!a.includes(e))};return e.forEach(e=>{const t=n[e.name];t?t.type!==e.type?(o.push({...t,type:e.type}),i.modified.push(e.name)):o.push(t):(o.push({id:u.a.generate(),column_name:e.name,type:e.type,groupby:!0,filterable:!0}),i.added.push(e.name))}),(i.added.length||i.modified.length||i.removed.length)&&this.setColumns({databaseColumns:o}),i}syncMetadata(){const{datasource:e}=this.state,t=`/datasource/external_metadata/${e.type||e.datasource_type}/${e.id}/`;this.setState({metadataLoading:!0}),O.a.get({endpoint:t}).then(({json:e})=>{const t=this.updateColumns(e);t.modified.length&&this.props.addSuccessToast(Object(m.e)(\"Modified columns: %s\",t.modified.join(\", \"))),t.removed.length&&this.props.addSuccessToast(Object(m.e)(\"Removed columns: %s\",t.removed.join(\", \"))),t.added.length&&this.props.addSuccessToast(Object(m.e)(\"New columns added: %s\",t.added.join(\", \"))),this.props.addSuccessToast(Object(m.e)(\"Metadata has been synced\")),this.setState({metadataLoading:!1})}).catch(e=>Object(_.a)(e).then(({error:e,statusText:t})=>{this.props.addDangerToast(e||t||Object(m.e)(\"An error has occurred\")),this.setState({metadataLoading:!1})}))}findDuplicates(e,t){const a={},n=[];return e.forEach(e=>{const o=t(e);o in a?n.push(o):a[o]=null}),n}validate(e){let t,a=[];const{datasource:n}=this.state;t=this.findDuplicates(n.columns,e=>e.column_name),a=a.concat(t.map(e=>Object(m.e)(\"Column name [%s] is duplicated\",e))),t=this.findDuplicates(n.metrics,e=>e.metric_name),a=a.concat(t.map(e=>Object(m.e)(\"Metric name [%s] is duplicated\",e)));const o=this.state.calculatedColumns.filter(e=>!e.expression&&!e.json);a=a.concat(o.map(e=>Object(m.e)(\"Calculated column [%s] requires an expression\",e.column_name))),this.setState({errors:a},e)}handleTabSelect(e){this.setState({activeTabKey:e})}renderSettingsFieldset(){const{datasource:e}=this.state;return Object(q.e)(z,{title:Object(m.e)(\"Basic\"),item:e,onChange:this.onDatasourceChange},Object(q.e)(U,{fieldKey:\"description\",label:Object(m.e)(\"Description\"),control:Object(q.e)(k.a,{language:\"markdown\",offerEditInModal:!1})}),Object(q.e)(U,{fieldKey:\"default_endpoint\",label:Object(m.e)(\"Default URL\"),description:Object(m.e)(\"Default URL to redirect to when accessing from the dataset list page\"),control:Object(q.e)(D.a,{controlId:\"default_endpoint\"})}),Object(q.e)(U,{fieldKey:\"filter_select_enabled\",label:Object(m.e)(\"Autocomplete filters\"),description:Object(m.e)(\"Whether to populate autocomplete filters options\"),control:Object(q.e)(w.a,null)}),this.state.isSqla&&Object(q.e)(U,{fieldKey:\"fetch_values_predicate\",label:Object(m.e)(\"Autocomplete query predicate\"),description:Object(m.e)('When using \"Autocomplete filters\", this can be used to improve performance of the query fetching the values. Use this option to apply a predicate (WHERE clause) to the query selecting the distinct values from the table. Typically the intent would be to limit the scan by applying a relative time filter on a partitioned or indexed time-related field.'),control:Object(q.e)(D.a,{controlId:\"fetch_values_predicate\"})}),this.state.isSqla&&Object(q.e)(U,{fieldKey:\"extra\",label:Object(m.e)(\"Extra\"),description:Object(m.e)('Extra data to specify table metadata. Currently supports certification data of the format: `{ \"certification\": { \"certified_by\": \"Data Platform Team\", \"details\": \"This table is the source of truth.\" } }`.'),control:Object(q.e)(k.a,{controlId:\"extra\",language:\"json\",offerEditInModal:!1})}),Object(q.e)(U,{fieldKey:\"owners\",label:Object(m.e)(\"Owners\"),description:Object(m.e)(\"Owners of the dataset\"),control:Object(q.e)(I.a,{dataEndpoint:\"api/v1/dataset/related/owners\",multi:!0,mutator:e=>e.result.map(e=>({value:e.value,label:\"\"+e.text}))}),controlProps:{}}))}renderAdvancedFieldset(){const{datasource:e}=this.state;return Object(q.e)(z,{title:Object(m.e)(\"Advanced\"),item:e,onChange:this.onDatasourceChange},Object(q.e)(U,{fieldKey:\"cache_timeout\",label:Object(m.e)(\"Cache timeout\"),description:Object(m.e)(\"The duration of time in seconds before the cache is invalidated\"),control:Object(q.e)(D.a,{controlId:\"cache_timeout\"})}),Object(q.e)(U,{fieldKey:\"offset\",label:Object(m.e)(\"Hours offset\"),control:Object(q.e)(D.a,{controlId:\"offset\"}),description:Object(m.e)(\"The number of hours, negative or positive, to shift the time column. This can be used to move UTC time to local time.\")}),this.state.isSqla&&Object(q.e)(U,{fieldKey:\"template_params\",label:Object(m.e)(\"Template parameters\"),description:Object(m.e)(\"A set of parameters that become available in the query using Jinja templating syntax\"),control:Object(q.e)(D.a,{controlId:\"template_params\"})}))}renderSpatialTab(){const{datasource:e}=this.state,{spatials:t,all_cols:a}=e;return Object(q.e)(g.c.TabPane,{tab:Object(q.e)(ie,{collection:t,title:Object(m.e)(\"Spatial\")}),key:4},Object(q.e)(Q,{tableColumns:[\"name\",\"config\"],onChange:this.onDatasourcePropChange.bind(this,\"spatials\"),itemGenerator:()=>({name:\"<new spatial>\",type:\"<no type>\",config:null}),collection:t,allowDeletes:!0,itemRenderers:{name:(e,t)=>Object(q.e)(E.a,{canEdit:!0,title:e,onSaveTitle:t}),config:(e,t)=>Object(q.e)(N.a,{value:e,onChange:t,choices:a})}}))}renderSourceFieldset(){const{datasource:e}=this.state;return Object(q.e)(\"div\",null,Object(q.e)(\"div\",{className:\"m-l-10 m-t-20 m-b-10\"},ne.map(e=>Object(q.e)(r.a,{key:e.key,value:e.key,inline:!0,onChange:this.onDatasourceTypeChange.bind(this,e.key),checked:this.state.datasourceType===e.key,disabled:!this.state.isEditMode},e.label))),Object(q.e)(\"hr\",null),Object(q.e)(z,{item:e,onChange:this.onDatasourceChange,compact:!0},this.state.datasourceType===oe.virtual.key&&Object(q.e)(\"div\",null,this.state.isSqla&&Object(q.e)(o.a.Fragment,null,Object(q.e)(U,{fieldKey:\"databaseSelector\",label:Object(m.e)(\"virtual\"),control:Object(q.e)(y.a,{dbId:e.database.id,schema:e.schema,onSchemaChange:e=>this.state.isEditMode&&this.onDatasourcePropChange(\"schema\",e),onDbChange:e=>this.state.isEditMode&&this.onDatasourcePropChange(\"database\",e),formMode:!1,handleError:this.props.addDangerToast,readOnly:!this.state.isEditMode})}),Object(q.e)(U,{fieldKey:\"table_name\",label:Object(m.e)(\"Dataset name\"),control:Object(q.e)(D.a,{controlId:\"table_name\",onChange:e=>{this.onDatasourcePropChange(\"table_name\",e)},placeholder:Object(m.e)(\"Dataset name\"),disabled:!this.state.isEditMode})}),Object(q.e)(U,{fieldKey:\"sql\",label:Object(m.e)(\"SQL\"),description:Object(m.e)(\"When specifying SQL, the datasource acts as a view. Superset will use this statement as a subquery while grouping and filtering on the generated parent queries.\"),control:Object(q.e)(k.a,{language:\"sql\",offerEditInModal:!1,minLines:20,maxLines:20,readOnly:!this.state.isEditMode})})),this.state.isDruid&&Object(q.e)(U,{fieldKey:\"json\",label:Object(m.e)(\"JSON\"),description:Object(q.e)(\"div\",null,Object(m.e)(\"The JSON metric or post aggregation definition.\")),control:Object(q.e)(k.a,{language:\"json\",offerEditInModal:!1})})),this.state.datasourceType===oe.physical.key&&Object(q.e)(c.a,{md:6},this.state.isSqla&&Object(q.e)(U,{fieldKey:\"tableSelector\",label:Object(m.e)(\"Physical\"),control:Object(q.e)(S.a,{clearable:!1,dbId:e.database.id,handleError:this.props.addDangerToast,schema:e.schema,sqlLabMode:!1,tableName:e.table_name,onSchemaChange:this.state.isEditMode?e=>this.onDatasourcePropChange(\"schema\",e):void 0,onDbChange:this.state.isEditMode?e=>this.onDatasourcePropChange(\"database\",e):void 0,onTableChange:this.state.isEditMode?e=>this.onDatasourcePropChange(\"table_name\",e):void 0,readOnly:!this.state.isEditMode}),description:Object(m.e)(\"The pointer to a physical table (or view). Keep in mind that the chart is associated to this Superset logical table, and this logical table points the physical table referenced here.\")}))),this.allowEditSource&&Object(q.e)(Z,null,Object(q.e)(\"span\",{role:\"button\",tabIndex:0,onClick:this.onChangeEditMode},Object(q.e)(C.a,{color:p.d.colors.grayscale.base,name:this.state.isEditMode?\"lock-unlocked\":\"lock-locked\"})),!this.state.isEditMode&&Object(q.e)(\"div\",null,Object(m.e)(\"Click the lock to make changes.\")),this.state.isEditMode&&Object(q.e)(\"div\",null,Object(m.e)(\"Click the lock to prevent further changes.\"))))}renderErrors(){return this.state.errors.length>0?Object(q.e)(d.a,{css:e=>({marginBottom:4*e.gridUnit}),type:\"error\",message:Object(q.e)(o.a.Fragment,null,this.state.errors.map(e=>Object(q.e)(\"div\",{key:e},e)))}):null}renderMetricCollection(){return Object(q.e)(Q,{tableColumns:[\"metric_name\",\"verbose_name\",\"expression\"],columnLabels:{metric_name:Object(m.e)(\"Metric\"),verbose_name:Object(m.e)(\"Label\"),expression:Object(m.e)(\"SQL expression\")},expandFieldset:Object(q.e)(ce,null,Object(q.e)(z,{compact:!0},Object(q.e)(U,{fieldKey:\"verbose_name\",label:Object(m.e)(\"Label\"),control:Object(q.e)(D.a,{controlId:\"verbose_name\"})}),Object(q.e)(U,{fieldKey:\"description\",label:Object(m.e)(\"Description\"),control:Object(q.e)(D.a,{controlId:\"description\",placeholder:Object(m.e)(\"Description\")})}),Object(q.e)(U,{fieldKey:\"d3format\",label:Object(m.e)(\"D3 format\"),control:Object(q.e)(D.a,{controlId:\"d3format\",placeholder:\"%y/%m/%d\"})}),Object(q.e)(U,{label:Object(m.e)(\"Warning message\"),fieldKey:\"warning_text\",description:Object(m.e)(\"Warning message to display in the metric selector\"),control:Object(q.e)(D.a,{controlId:\"warning_text\",placeholder:Object(m.e)(\"Warning message\")})}),Object(q.e)(U,{label:Object(m.e)(\"Certified by\"),fieldKey:\"certified_by\",description:Object(m.e)(\"Person or group that has certified this metric\"),control:Object(q.e)(D.a,{controlId:\"certified_by\",placeholder:Object(m.e)(\"Certified by\")})}),Object(q.e)(U,{label:Object(m.e)(\"Certification details\"),fieldKey:\"certification_details\",description:Object(m.e)(\"Details of the certification\"),control:Object(q.e)(D.a,{controlId:\"certification_details\",placeholder:Object(m.e)(\"Certification details\")})}))),collection:this.state.datasource.metrics,allowAddItem:!0,onChange:this.onDatasourcePropChange.bind(this,\"metrics\"),itemGenerator:()=>({metric_name:\"<new metric>\",verbose_name:\"\",expression:\"\"}),itemRenderers:{metric_name:(e,t,a,n)=>Object(q.e)(Y,null,n.is_certified&&Object(q.e)(f.a,{certifiedBy:n.certified_by,details:n.certification_details}),Object(q.e)(E.a,{canEdit:!0,title:e,onSaveTitle:t})),verbose_name:(e,t)=>Object(q.e)(E.a,{canEdit:!0,title:e,onSaveTitle:t}),expression:(e,t)=>Object(q.e)(E.a,{canEdit:!0,title:e,onSaveTitle:t,extraClasses:[\"datasource-sql-expression\"],multiLine:!0}),description:(e,t,a)=>Object(q.e)(le,{label:a,formElement:Object(q.e)(D.a,{value:e,onChange:t})}),d3format:(e,t,a)=>Object(q.e)(le,{label:a,formElement:Object(q.e)(D.a,{value:e,onChange:t})})},allowDeletes:!0,stickyHeader:!0})}render(){const{datasource:e,activeTabKey:t}=this.state;return Object(q.e)(X,null,this.renderErrors(),Object(q.e)(d.a,{css:e=>({marginBottom:4*e.gridUnit}),type:\"warning\",message:Object(q.e)(o.a.Fragment,null,\" \",Object(q.e)(\"strong\",null,Object(m.e)(\"Be careful.\"),\" \"),Object(m.e)(\"Changing these settings will affect all charts using this dataset, including charts owned by other people.\"))}),Object(q.e)(g.c,{fullWidth:!1,id:\"table-tabs\",onChange:this.handleTabSelect,defaultActiveKey:t},Object(q.e)(g.c.TabPane,{key:0,tab:Object(m.e)(\"Source\")},this.renderSourceFieldset()),Object(q.e)(g.c.TabPane,{tab:Object(q.e)(ie,{collection:e.metrics,title:Object(m.e)(\"Metrics\")}),key:1},this.renderMetricCollection()),Object(q.e)(g.c.TabPane,{tab:Object(q.e)(ie,{collection:this.state.databaseColumns,title:Object(m.e)(\"Columns\")}),key:2},Object(q.e)(\"div\",null,Object(q.e)(ee,null,Object(q.e)(\"span\",{className:\"m-t-10 m-r-10\"},Object(q.e)(j.a,{buttonSize:\"small\",buttonStyle:\"primary\",onClick:this.syncMetadata,className:\"sync-from-source\"},Object(q.e)(\"i\",{className:\"fa fa-database\"}),\" \",Object(m.e)(\"Sync columns from source\")))),Object(q.e)(se,{className:\"columns-table\",columns:this.state.databaseColumns,onChange:e=>this.setColumns({databaseColumns:e})}),this.state.metadataLoading&&Object(q.e)(x.a,null))),Object(q.e)(g.c.TabPane,{tab:Object(q.e)(ie,{collection:this.state.calculatedColumns,title:Object(m.e)(\"Calculated columns\")}),key:3},Object(q.e)(se,{columns:this.state.calculatedColumns,onChange:e=>this.setColumns({calculatedColumns:e}),editableColumnName:!0,showExpression:!0,allowAddItem:!0,allowEditDataType:!0,itemGenerator:()=>({column_name:\"<new column>\",filterable:!0,groupby:!0,expression:\"<enter SQL expression here>\",__expanded:!0})})),Object(q.e)(g.c.TabPane,{key:4,tab:Object(m.e)(\"Settings\")},Object(q.e)(\"div\",null,Object(q.e)(c.a,{md:6},Object(q.e)(ce,null,this.renderSettingsFieldset())),Object(q.e)(c.a,{md:6},Object(q.e)(ce,null,this.renderAdvancedFieldset()))))))}}de.defaultProps={onChange:()=>{}},de.propTypes=re;t.default=Object(J.a)(de)},4878:function(e,t,a){},896:function(e,t,a){\"use strict\";a.d(t,\"a\",(function(){return r}));a(31);var n=a(0),o=a(6),i=a.n(o),s=a(13),l=a(45),c=a(1);function r({canEdit:e=!1,editing:t=!1,extraClasses:a,multiLine:o=!1,noPermitTooltip:r,onSaveTitle:d,showTooltip:b=!0,style:h,title:u=\"\",defaultTitle:p=\"\",placeholder:m=\"\"}){const[O,j]=Object(n.useState)(t),[g,f]=Object(n.useState)(u),[y,C]=Object(n.useState)(u),[v,x]=Object(n.useState)(null),S=Object(n.useRef)();function E(){if(!e||O)return;const t=S.current?S.current.getBoundingClientRect():null;j(!0),x(t)}function _(){const t=g.trim();e&&(j(!1),t.length?(y!==t&&C(t),u!==t&&d(t)):f(y))}function w(e){\" \"===e.key&&e.stopPropagation(),\"Enter\"===e.key&&(e.preventDefault(),_())}function D(t){e&&f(t.target.value)}function T(e){\"Enter\"===e.key&&(e.preventDefault(),_())}let k;Object(n.useEffect)(()=>{u!==g&&(C(g),f(u))},[u]),Object(n.useEffect)(()=>{O&&S.current.focus()},[O]),k=g,O||g||(k=p||u);const I=O&&v?{height:v.height+\"px\"}:void 0;let N=o&&O?Object(c.e)(\"textarea\",{ref:S,value:k,className:u?void 0:\"text-muted\",onKeyDown:w,onChange:D,onBlur:_,onClick:E,onKeyPress:T,placeholder:m,style:I}):Object(c.e)(\"input\",{ref:S,type:O?\"text\":\"button\",value:k,className:u?void 0:\"text-muted\",onKeyDown:w,onChange:D,onBlur:_,onClick:E,onKeyPress:T,placeholder:m});return b&&!O&&(N=Object(c.e)(l.a,{id:\"title-tooltip\",title:e?Object(s.e)(\"Click to edit\"):r||Object(s.e)(\"You don't have the rights to alter this title.\")},N)),e||(N=Object(c.e)(\"span\",{title:k},k)),Object(c.e)(\"span\",{className:i()(\"editable-title\",a,e&&\"editable-title--editable\",O&&\"editable-title--editing\"),style:h},N)}}}]);","extractedComments":[]}
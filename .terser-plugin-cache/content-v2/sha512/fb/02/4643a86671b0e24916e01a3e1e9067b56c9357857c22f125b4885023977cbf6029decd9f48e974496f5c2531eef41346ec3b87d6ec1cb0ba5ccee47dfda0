{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{2171:function(t,e,n){var i;!function(o,a,r){if(o){for(var s,c={8:\"backspace\",9:\"tab\",13:\"enter\",16:\"shift\",17:\"ctrl\",18:\"alt\",20:\"capslock\",27:\"esc\",32:\"space\",33:\"pageup\",34:\"pagedown\",35:\"end\",36:\"home\",37:\"left\",38:\"up\",39:\"right\",40:\"down\",45:\"ins\",46:\"del\",91:\"meta\",93:\"meta\",224:\"meta\"},l={106:\"*\",107:\"+\",109:\"-\",110:\".\",111:\"/\",186:\";\",187:\"=\",188:\",\",189:\"-\",190:\".\",191:\"/\",192:\"`\",219:\"[\",220:\"\\\\\",221:\"]\",222:\"'\"},p={\"~\":\"`\",\"!\":\"1\",\"@\":\"2\",\"#\":\"3\",$:\"4\",\"%\":\"5\",\"^\":\"6\",\"&\":\"7\",\"*\":\"8\",\"(\":\"9\",\")\":\"0\",_:\"-\",\"+\":\"=\",\":\":\";\",'\"':\"'\",\"<\":\",\",\">\":\".\",\"?\":\"/\",\"|\":\"\\\\\"},u={option:\"alt\",command:\"meta\",return:\"enter\",escape:\"esc\",plus:\"+\",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?\"meta\":\"ctrl\"},h=1;h<20;++h)c[111+h]=\"f\"+h;for(h=0;h<=9;++h)c[h+96]=h.toString();y.prototype.bind=function(t,e,n){return t=t instanceof Array?t:[t],this._bindMultiple.call(this,t,e,n),this},y.prototype.unbind=function(t,e){return this.bind.call(this,t,(function(){}),e)},y.prototype.trigger=function(t,e){return this._directMap[t+\":\"+e]&&this._directMap[t+\":\"+e]({},t),this},y.prototype.reset=function(){return this._callbacks={},this._directMap={},this},y.prototype.stopCallback=function(t,e){if((\" \"+e.className+\" \").indexOf(\" mousetrap \")>-1)return!1;if(function t(e,n){return null!==e&&e!==a&&(e===n||t(e.parentNode,n))}(e,this.target))return!1;if(\"composedPath\"in t&&\"function\"==typeof t.composedPath){var n=t.composedPath()[0];n!==t.target&&(e=n)}return\"INPUT\"==e.tagName||\"SELECT\"==e.tagName||\"TEXTAREA\"==e.tagName||e.isContentEditable},y.prototype.handleKey=function(){var t=this;return t._handleKey.apply(t,arguments)},y.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(c[e]=t[e]);s=null},y.init=function(){var t=y(a);for(var e in t)\"_\"!==e.charAt(0)&&(y[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},y.init(),o.Mousetrap=y,t.exports&&(t.exports=y),void 0===(i=function(){return y}.call(e,n,e,t))||(t.exports=i)}function d(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent(\"on\"+e,n)}function f(t){if(\"keypress\"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return c[t.which]?c[t.which]:l[t.which]?l[t.which]:String.fromCharCode(t.which).toLowerCase()}function v(t){return\"shift\"==t||\"ctrl\"==t||\"alt\"==t||\"meta\"==t}function g(t,e,n){return n||(n=function(){if(!s)for(var t in s={},c)t>95&&t<112||c.hasOwnProperty(t)&&(s[c[t]]=t);return s}()[t]?\"keydown\":\"keypress\"),\"keypress\"==n&&e.length&&(n=\"keydown\"),n}function m(t,e){var n,i,o,a=[];for(n=function(t){return\"+\"===t?[\"+\"]:(t=t.replace(/\\+{2}/g,\"+plus\")).split(\"+\")}(t),o=0;o<n.length;++o)i=n[o],u[i]&&(i=u[i]),e&&\"keypress\"!=e&&p[i]&&(i=p[i],a.push(\"shift\")),v(i)&&a.push(i);return{key:i,modifiers:a,action:e=g(i,a,e)}}function y(t){var e=this;if(t=t||a,!(e instanceof y))return new y(t);e.target=t,e._callbacks={},e._directMap={};var n,i={},o=!1,r=!1,s=!1;function c(t){t=t||{};var e,n=!1;for(e in i)t[e]?n=!0:i[e]=0;n||(s=!1)}function l(t,n,o,a,r,s){var c,l,p,u,h=[],d=o.type;if(!e._callbacks[t])return[];for(\"keyup\"==d&&v(t)&&(n=[t]),c=0;c<e._callbacks[t].length;++c)if(l=e._callbacks[t][c],(a||!l.seq||i[l.seq]==l.level)&&d==l.action&&(\"keypress\"==d&&!o.metaKey&&!o.ctrlKey||(p=n,u=l.modifiers,p.sort().join(\",\")===u.sort().join(\",\")))){var f=!a&&l.combo==r,g=a&&l.seq==a&&l.level==s;(f||g)&&e._callbacks[t].splice(c,1),h.push(l)}return h}function p(t,n,i,o){e.stopCallback(n,n.target||n.srcElement,i,o)||!1===t(n,i)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(n),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(n))}function u(t){\"number\"!=typeof t.which&&(t.which=t.keyCode);var n=f(t);n&&(\"keyup\"!=t.type||o!==n?e.handleKey(n,function(t){var e=[];return t.shiftKey&&e.push(\"shift\"),t.altKey&&e.push(\"alt\"),t.ctrlKey&&e.push(\"ctrl\"),t.metaKey&&e.push(\"meta\"),e}(t),t):o=!1)}function h(t,e,a,r){function l(e){return function(){s=e,++i[t],clearTimeout(n),n=setTimeout(c,1e3)}}function u(e){p(a,e,t),\"keyup\"!==r&&(o=f(e)),setTimeout(c,10)}i[t]=0;for(var h=0;h<e.length;++h){var d=h+1===e.length?u:l(r||m(e[h+1]).action);g(e[h],d,r,t,h)}}function g(t,n,i,o,a){e._directMap[t+\":\"+i]=n;var r,s=(t=t.replace(/\\s+/g,\" \")).split(\" \");s.length>1?h(t,s,n,i):(r=m(t,i),e._callbacks[r.key]=e._callbacks[r.key]||[],l(r.key,r.modifiers,{type:r.action},o,t,a),e._callbacks[r.key][o?\"unshift\":\"push\"]({callback:n,modifiers:r.modifiers,action:r.action,seq:o,level:a,combo:t}))}e._handleKey=function(t,e,n){var i,o=l(t,e,n),a={},u=0,h=!1;for(i=0;i<o.length;++i)o[i].seq&&(u=Math.max(u,o[i].level));for(i=0;i<o.length;++i)if(o[i].seq){if(o[i].level!=u)continue;h=!0,a[o[i].seq]=1,p(o[i].callback,n,o[i].combo,o[i].seq)}else h||p(o[i].callback,n,o[i].combo);var d=\"keypress\"==n.type&&r;n.type!=s||v(t)||d||c(a),r=h&&\"keydown\"==n.type},e._bindMultiple=function(t,e,n){for(var i=0;i<t.length;++i)g(t[i],e,n)},d(t,\"keypress\",u),d(t,\"keydown\",u),d(t,\"keyup\",u)}}(\"undefined\"!=typeof window?window:null,\"undefined\"!=typeof window?document:null)},4597:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return R}));var i=n(13),o=n(7),a=n(16),r=n(17),s=n(4616);function c(t,e){var n=s.c([],e,t);return s.b(n,n,1/n[3]),n}var l=n(4598),p=n(4593),u=n(4610);function h(t,e){if(!t)throw new Error(e||\"@math.gl/web-mercator: assertion failed.\")}var d=Math.PI,f=d/4,v=d/180,g=180/d;function m(t){return Math.pow(2,t)}function y(t){var e=Object(o.a)(t,2),n=e[0],i=e[1];h(Number.isFinite(n)),h(Number.isFinite(i)&&i>=-90&&i<=90,\"invalid latitude\");var a=i*v;return[512*(n*v+d)/(2*d),512*(d+Math.log(Math.tan(f+.5*a)))/(2*d)]}function P(t){var e=Object(o.a)(t,2),n=e[0],i=e[1],a=n/512*(2*d)-d,r=2*(Math.atan(Math.exp(i/512*(2*d)-d))-f);return[a*g,r*g]}function b(t){var e=t.latitude,n=t.longitude,i=t.highPrecision,o=void 0!==i&&i;h(Number.isFinite(e)&&Number.isFinite(n));var a={},r=Math.cos(e*v),s=512/360/r,c=512/4003e4/r;if(a.unitsPerMeter=[c,c,c],a.metersPerUnit=[1/c,1/c,1/c],a.unitsPerDegree=[512/360,s,c],a.degreesPerUnit=[.703125,1/s,1/c],o){var l=v*Math.tan(e*v)/r,p=512/360*l/2,u=512/4003e4*l,d=u/s*c;a.unitsPerDegree2=[0,p,u],a.unitsPerMeter2=[d,0,d]}return a}function x(t){var e=t.height,n=t.pitch,i=t.bearing,o=t.altitude,a=t.scale,r=t.center,s=void 0===r?null:r,c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return l.o(c,c,[0,0,-o]),l.k(c,c,-n*v),l.m(c,c,i*v),a/=e,l.n(c,c,[a,a,a]),s&&l.o(c,c,u.d([],s)),c}function w(t){var e=t.width,n=t.height,i=t.pitch,o=function(t){var e=t.width,n=t.height,i=t.altitude,o=void 0===i?1.5:i,a=t.pitch,r=void 0===a?0:a,s=t.nearZMultiplier,c=void 0===s?1:s,l=t.farZMultiplier,p=void 0===l?1:l,u=r*v,h=Math.atan(.5/o),d=Math.sin(h)*o/Math.sin(Math.min(Math.max(Math.PI/2-u-h,.01),Math.PI-.01));return{fov:2*h,aspect:e/n,focalDistance:o,near:c,far:(Math.sin(u)*d+o)*p}}({width:e,height:n,altitude:t.altitude,pitch:i,nearZMultiplier:t.nearZMultiplier,farZMultiplier:t.farZMultiplier}),a=o.fov,r=o.aspect,s=o.near,c=o.far;return l.i([],a,r,s,c)}function _(t,e){var n=Object(o.a)(t,3),i=n[0],a=n[1],r=n[2],s=void 0===r?0:r;return h(Number.isFinite(i)&&Number.isFinite(a)&&Number.isFinite(s)),c(e,[i,a,s,1])}function S(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Object(o.a)(t,3),a=i[0],r=i[1],s=i[2];if(h(Number.isFinite(a)&&Number.isFinite(r),\"invalid pixel coordinate\"),Number.isFinite(s)){var l=c(e,[a,r,s,1]);return l}var u=c(e,[a,r,0,1]),d=c(e,[a,r,1,1]),f=u[2],v=d[2],g=f===v?0:((n||0)-f)/(v-f);return p.d([],u,d,g)}function C(t){var e=t.width,n=t.height,i=t.bounds,a=t.minExtent,r=void 0===a?0:a,s=t.maxZoom,c=void 0===s?24:s,l=t.padding,p=void 0===l?0:l,u=t.offset,d=void 0===u?[0,0]:u,f=Object(o.a)(i,2),v=Object(o.a)(f[0],2),g=v[0],m=v[1],y=Object(o.a)(f[1],2),P=y[0],b=y[1];if(Number.isFinite(p)){p={top:p,bottom:p,left:p,right:p}}else h(Number.isFinite(p.top)&&Number.isFinite(p.bottom)&&Number.isFinite(p.left)&&Number.isFinite(p.right));var x=new E({width:e,height:n,longitude:0,latitude:0,zoom:0}),w=x.project([g,b]),_=x.project([P,m]),S=[Math.max(Math.abs(_[0]-w[0]),r),Math.max(Math.abs(_[1]-w[1]),r)],C=[e-p.left-p.right-2*Math.abs(d[0]),n-p.top-p.bottom-2*Math.abs(d[1])];h(C[0]>0&&C[1]>0);var j=C[0]/S[0],L=C[1]/S[1],A=(p.right-p.left)/2/j,M=(p.bottom-p.top)/2/L,O=[(_[0]+w[0])/2+A,(_[1]+w[1])/2+M],k=x.unproject(O),F=Math.min(c,x.zoom+Math.log2(Math.abs(Math.min(j,L))));return h(Number.isFinite(F)),{longitude:k[0],latitude:k[1],zoom:F}}var j=Math.PI/180;function L(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t.width,a=t.height,r=t.unproject,s={targetZ:i},c=r([0,a],s),l=r([o,a],s),p=Math.atan(.5/t.altitude),u=(90-t.pitch)*j;return p>u-.01?(e=A(t,0,i),n=A(t,o,i)):(e=r([0,0],s),n=r([o,0],s)),[c,l,n,e]}function A(t,e,n){var i=t.pixelUnprojectionMatrix,o=c(i,[e,0,1,1]),a=c(i,[e,t.height,1,1]),r=(n*t.distanceScales.unitsPerMeter[2]-o[2])/(a[2]-o[2]),s=P(p.d([],o,a,r));return s[2]=n,s}var E=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:1,height:1},n=e.width,i=e.height,o=e.latitude,r=void 0===o?0:o,s=e.longitude,c=void 0===s?0:s,l=e.zoom,p=void 0===l?0:l,u=e.pitch,h=void 0===u?0:u,d=e.bearing,f=void 0===d?0:d,v=e.altitude,g=void 0===v?1.5:v,P=e.nearZMultiplier,_=void 0===P?.02:P,S=e.farZMultiplier,C=void 0===S?1.01:S;Object(a.a)(this,t),n=n||1,i=i||1;var j=m(p);g=Math.max(.75,g);var L=y([c,r]);L[2]=0,this.projectionMatrix=w({width:n,height:i,pitch:h,altitude:g,nearZMultiplier:_,farZMultiplier:C}),this.viewMatrix=x({height:i,scale:j,center:L,pitch:h,bearing:f,altitude:g}),this.width=n,this.height=i,this.scale=j,this.latitude=r,this.longitude=c,this.zoom=p,this.pitch=h,this.bearing=f,this.altitude=g,this.center=L,this.distanceScales=b(this),this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}return Object(r.a)(t,[{key:\"_initMatrices\",value:function(){var t=this.width,e=this.height,n=this.projectionMatrix,i=this.viewMatrix,o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];l.g(o,o,n),l.g(o,o,i),this.viewProjectionMatrix=o;var a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];l.n(a,a,[t/2,-e/2,1]),l.o(a,a,[1,-1,0]),l.g(a,a,o);var r=l.e([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a);if(!r)throw new Error(\"Pixel project matrix not invertible\");this.pixelProjectionMatrix=a,this.pixelUnprojectionMatrix=r}},{key:\"equals\",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&l.b(e.projectionMatrix,this.projectionMatrix)&&l.b(e.viewMatrix,this.viewMatrix))}},{key:\"project\",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,i=void 0===n||n,a=this.projectPosition(t),r=_(a,this.pixelProjectionMatrix),s=Object(o.a)(r,2),c=s[0],l=s[1],p=i?l:this.height-l;return 2===t.length?[c,p]:[c,p,r[2]]}},{key:\"unproject\",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,i=void 0===n||n,a=e.targetZ,r=void 0===a?void 0:a,s=Object(o.a)(t,3),c=s[0],l=s[1],p=s[2],u=i?l:this.height-l,h=r&&r*this.distanceScales.unitsPerMeter[2],d=S([c,u,p],this.pixelUnprojectionMatrix,h),f=this.unprojectPosition(d),v=Object(o.a)(f,3),g=v[0],m=v[1],y=v[2];return Number.isFinite(p)?[g,m,y]:Number.isFinite(r)?[g,m,r]:[g,m]}},{key:\"projectPosition\",value:function(t){var e=y(t),n=Object(o.a)(e,2);return[n[0],n[1],(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}},{key:\"unprojectPosition\",value:function(t){var e=P(t),n=Object(o.a)(e,2);return[n[0],n[1],(t[2]||0)*this.distanceScales.metersPerUnit[2]]}},{key:\"projectFlat\",value:function(t){return y(t)}},{key:\"unprojectFlat\",value:function(t){return P(t)}},{key:\"getMapCenterByLngLatPosition\",value:function(t){var e=t.lngLat,n=S(t.pos,this.pixelUnprojectionMatrix),i=y(e),o=p.a([],i,p.e([],n));return P(p.a([],this.center,o))}},{key:\"getLocationAtPoint\",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:\"fitBounds\",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.width,o=this.height,a=C(Object.assign({width:i,height:o,bounds:e},n)),r=a.longitude,s=a.latitude,c=a.zoom;return new t({width:i,height:o,longitude:r,latitude:s,zoom:c})}},{key:\"getBounds\",value:function(t){var e=this.getBoundingRegion(t),n=Math.min.apply(Math,Object(i.a)(e.map((function(t){return t[0]})))),o=Math.max.apply(Math,Object(i.a)(e.map((function(t){return t[0]}))));return[[n,Math.min.apply(Math,Object(i.a)(e.map((function(t){return t[1]}))))],[o,Math.max.apply(Math,Object(i.a)(e.map((function(t){return t[1]}))))]]}},{key:\"getBoundingRegion\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return L(this,t.z||0)}}]),t}();var M=n(159);const O=[-90,90],k=[-180,180];function F(t,e,n){let[i,o]=t,[a,r]=e;return void 0===n&&(n=.25),i<o?[i,o]:[Math.max(a,i-n),Math.min(r,o+n)]}function N(){return(N=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function R(t,e){let{points:n,width:i,height:o,minExtent:a,maxZoom:r,offset:s,padding:c=20}=e;const{bearing:l,pitch:p}=t,u=function(t){const e=F(Object(M.extent)(t,t=>t[1]),O),n=F(Object(M.extent)(t,t=>t[0]),k);return[[n[0],e[0]],[n[1],e[1]]]}(n);try{return N({},C({bounds:u,width:i,height:o,minExtent:a,maxZoom:r,offset:s,padding:c}),{bearing:l,pitch:p})}catch(t){console.error(\"Could not fit viewport\",t)}return t}},4603:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return s}));var i=n(33),o=n.n(i);const a=[1,0,1,0,0,0,0];function r(t,e){const n=parseInt(o()(e).format(\"x\"),10);return parseInt(o()(e).add(t).format(\"x\"),10)-n}function s(t,e){const n=o()(Math.min(...t)),i=o()(Math.max(...t));let s,c,l;if(e.includes(\"/\")){const t=e.split(\"/\",2);t[0].endsWith(\"Z\")?(c=o()(t[0]),s=o.a.duration(t[1])):(c=o()(t[1]),s=o.a.duration(t[0]))}else s=o.a.duration(e),c=function(t,e){const n=o()(t).subtract(e),i=t.toArray(),r=n.toArray(),s=i.map((t,e)=>r[e]!==t).indexOf(!0),c=i.map((t,e)=>{if(e===s){const n=t-r[e];return t-(t-a[e])%n}return e<s||-1===s?t:a[e]});return o()(c)}(n,s);const p=n.valueOf();for(l=c.clone();l.valueOf()<p;)l.add(s);for(;l.valueOf()>p;)l.subtract(s);let u;const h=i.valueOf();for(u=c.clone();u.valueOf()>h;)u.subtract(s);for(;u.valueOf()<h;)u.add(s);const d=null!=e?[l,l.clone().add(s)]:[l,u],f=t.every(t=>null===t);return{start:parseInt(l.format(\"x\"),10),end:parseInt(u.format(\"x\"),10),getStep:r.bind(this,s),values:d.map(t=>parseInt(t.format(\"x\"),10)),disabled:f}}},4606:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return y}));var i=n(0),o=n.n(i),a=n(2),r=n.n(a),s=n(4605),c=n(2171),l=n.n(c),p=n(20),u=n(4557),h=n.n(u);n(4611),n(4612);function d(t){return o.a.createElement(\"span\",{className:\"BootstrapSliderWrapper\"},o.a.createElement(h.a,t))}n(4613);const f={start:r.a.number.isRequired,step:r.a.number.isRequired,end:r.a.number.isRequired,values:r.a.array.isRequired,onChange:r.a.func,loopDuration:r.a.number,maxFrames:r.a.number,orientation:r.a.oneOf([\"horizontal\",\"vertical\"]),reversed:r.a.bool,disabled:r.a.bool,range:r.a.bool};class v extends o.a.PureComponent{constructor(t){super(t),this.state={intervalId:null};const e=t.end-t.start,n=Math.min(t.maxFrames,e/t.step),i=e/n;this.intervalMilliseconds=t.loopDuration/n,this.increment=i<t.step?t.step:i-i%t.step,this.onChange=this.onChange.bind(this),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.stepBackward=this.stepBackward.bind(this),this.stepForward=this.stepForward.bind(this),this.getPlayClass=this.getPlayClass.bind(this),this.formatter=this.formatter.bind(this)}componentDidMount(){l.a.bind([\"space\"],this.play)}componentWillUnmount(){l.a.unbind([\"space\"])}onChange(t){this.props.onChange(t.target.value),null!=this.state.intervalId&&this.pause()}getPlayClass(){return null==this.state.intervalId?\"fa fa-play fa-lg slider-button\":\"fa fa-pause fa-lg slider-button\"}play(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{const t=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:t})}}pause(){clearInterval(this.state.intervalId),this.setState({intervalId:null})}stepForward(){const{start:t,end:e,step:n,values:i,disabled:o}=this.props;if(o)return;const a=(Array.isArray(i)?i:[i,i+n]).map(t=>t+this.increment),r=a[1]>e?a[0]-t:0;this.props.onChange(a.map(t=>t-r))}stepBackward(){const{start:t,end:e,step:n,values:i,disabled:o}=this.props;if(o)return;const a=(Array.isArray(i)?i:[i,i+n]).map(t=>t-this.increment),r=a[0]<t?e-a[1]:0;this.props.onChange(a.map(t=>t+r))}formatter(t){if(this.props.disabled)return Object(p.e)(\"Data has no time steps\");let e=t;return Array.isArray(t)?t[0]===t[1]&&(e=[t[0]]):e=[t],e.map(t=>new Date(t).toUTCString()).join(\" : \")}render(){const{start:t,end:e,step:n,orientation:i,reversed:a,disabled:r,range:s,values:c}=this.props;return o.a.createElement(\"div\",{className:\"play-slider\"},o.a.createElement(\"div\",{className:\"play-slider-controls padded\"},o.a.createElement(\"i\",{className:\"fa fa-step-backward fa-lg slider-button \",onClick:this.stepBackward}),o.a.createElement(\"i\",{className:this.getPlayClass(),onClick:this.play}),o.a.createElement(\"i\",{className:\"fa fa-step-forward fa-lg slider-button \",onClick:this.stepForward})),o.a.createElement(\"div\",{className:\"play-slider-scrobbler padded\"},o.a.createElement(d,{value:s?c:c[0],range:s,formatter:this.formatter,change:this.onChange,min:t,max:e,step:n,orientation:i,reversed:a,disabled:r?\"disabled\":\"enabled\"})))}}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}v.propTypes=f,v.defaultProps={onChange:()=>{},loopDuration:15e3,maxFrames:100,orientation:\"horizontal\",reversed:!1,disabled:!1,range:!0};const m={getLayers:r.a.func.isRequired,start:r.a.number.isRequired,end:r.a.number.isRequired,getStep:r.a.func,values:r.a.array.isRequired,aggregation:r.a.bool,disabled:r.a.bool,viewport:r.a.object.isRequired,children:r.a.node,mapStyle:r.a.string,mapboxApiAccessToken:r.a.string.isRequired,setControlValue:r.a.func,onValuesChange:r.a.func,width:r.a.number.isRequired,height:r.a.number.isRequired};class y extends o.a.PureComponent{constructor(){super(...arguments),g(this,\"containerRef\",o.a.createRef()),g(this,\"setTooltip\",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)})}render(){const{start:t,end:e,getStep:n,disabled:i,aggregation:a,children:r,getLayers:c,values:l,onValuesChange:p,viewport:u,setControlValue:h,mapStyle:d,mapboxApiAccessToken:f,height:g,width:m}=this.props,y=c(l);return o.a.createElement(\"div\",null,o.a.createElement(s.a,{ref:this.containerRef,viewport:u,layers:y,setControlValue:h,mapStyle:d,mapboxApiAccessToken:f,bottomMargin:i?0:20,width:m,height:g}),!i&&o.a.createElement(v,{start:t,end:e,step:n(t),values:l,range:!a,onChange:p}),r)}}y.propTypes=m,y.defaultProps={aggregation:!1,disabled:!1,mapStyle:\"light\",setControlValue:()=>{},onValuesChange:()=>{}}},4611:function(t,e,n){},4612:function(t,e,n){},4613:function(t,e,n){},4614:function(t,e,n){\"use strict\";n.d(e,\"b\",(function(){return C})),n.d(e,\"a\",(function(){return j}));var i=n(0),o=n.n(i),a=n(2),r=n.n(a),s=n(265),c=n(4605),l=n(869),p=n(4606),u=n(4617),h=n(4621),d=n(4603),f=n(4602),v=n(4597);function g(){return(g=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const{getScale:y}=l.b;const P={formData:r.a.object.isRequired,mapboxApiKey:r.a.string.isRequired,setControlValue:r.a.func.isRequired,viewport:r.a.object.isRequired,getLayer:r.a.func.isRequired,getPoints:r.a.func.isRequired,payload:r.a.object.isRequired,onAddFilter:r.a.func,width:r.a.number.isRequired,height:r.a.number.isRequired};class b extends o.a.PureComponent{constructor(t){super(t),m(this,\"containerRef\",o.a.createRef()),m(this,\"setTooltip\",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)}),this.state=this.getStateFromProps(t),this.getLayers=this.getLayers.bind(this),this.onValuesChange=this.onValuesChange.bind(this),this.toggleCategory=this.toggleCategory.bind(this),this.showSingleCategory=this.showSingleCategory.bind(this)}UNSAFE_componentWillReceiveProps(t){t.payload.form_data!==this.state.formData&&this.setState(g({},this.getStateFromProps(t)))}onValuesChange(t){this.setState({values:Array.isArray(t)?t:[t,t+this.state.getStep(t)]})}getStateFromProps(t,e){const n=t.payload.data.features||[],i=n.map(t=>t.__timestamp),o=function(t,e){const n=t.color_picker||{r:0,g:0,b:0,a:1},i=[n.r,n.g,n.b,255*n.a],o=y(t.color_scheme),a={};return e.forEach(e=>{if(null!=e.cat_color&&!a.hasOwnProperty(e.cat_color)){let r;r=t.dimension?Object(h.hexToRGB)(o(e.cat_color),255*n.a):i,a[e.cat_color]={color:r,enabled:!0}}}),a}(t.formData,n);if(e&&t.payload.form_data===e.formData)return g({},e,{categories:o});const a=t.payload.form_data.time_grain_sqla||t.payload.form_data.granularity||\"P1D\",{start:r,end:s,getStep:c,values:l,disabled:p}=Object(d.a)(i,a),{width:u,height:f,formData:m}=t;let{viewport:P}=t;return m.autozoom&&(P=Object(v.a)(P,{width:u,height:f,points:t.getPoints(n)})),{start:r,end:s,getStep:c,values:l,disabled:p,viewport:P,selected:[],lastClick:0,formData:t.payload.form_data,categories:o}}getLayers(t){const{getLayer:e,payload:n,formData:i,onAddFilter:o}=this.props;let a=n.data.features?[...n.data.features]:[];if(a=this.addColor(a,i),i.js_data_mutator){a=Object(f.a)(i.js_data_mutator)(a)}a=t[0]===t[1]||t[1]===this.end?a.filter(e=>e.__timestamp>=t[0]&&e.__timestamp<=t[1]):a.filter(e=>e.__timestamp>=t[0]&&e.__timestamp<t[1]);const r=this.state.categories;i.dimension&&(a=a.filter(t=>r[t.cat_color]&&r[t.cat_color].enabled));return[e(i,g({},n,{data:g({},n.data,{features:a})}),o,this.setTooltip)]}addColor(t,e){const n=e.color_picker||{r:0,g:0,b:0,a:1},i=y(e.color_scheme);return t.map(t=>{let o;return e.dimension?(o=Object(h.hexToRGB)(i(t.cat_color),255*n.a),g({},t,{color:o})):t})}toggleCategory(t){const e=this.state.categories[t],n=g({},this.state.categories,{[t]:g({},e,{enabled:!e.enabled})});Object.values(n).every(t=>!t.enabled)&&Object.values(n).forEach(t=>{t.enabled=!0}),this.setState({categories:n})}showSingleCategory(t){const e=g({},this.state.categories);Object.values(e).forEach(t=>{t.enabled=!1}),e[t].enabled=!0,this.setState({categories:e})}render(){return o.a.createElement(\"div\",{style:{position:\"relative\"}},o.a.createElement(p.a,{ref:this.containerRef,getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,disabled:this.state.disabled,viewport:this.state.viewport,mapboxApiAccessToken:this.props.mapboxApiKey,mapStyle:this.props.formData.mapbox_style,setControlValue:this.props.setControlValue,width:this.props.width,height:this.props.height},o.a.createElement(u.a,{categories:this.state.categories,toggleCategory:this.toggleCategory,showSingleCategory:this.showSingleCategory,position:this.props.formData.legend_position,format:this.props.formData.legend_format})))}}function x(){return(x=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function w(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}b.propTypes=P;const _={formData:r.a.object.isRequired,payload:r.a.object.isRequired,setControlValue:r.a.func.isRequired,viewport:r.a.object.isRequired,onAddFilter:r.a.func,width:r.a.number.isRequired,height:r.a.number.isRequired},S={onAddFilter(){}};function C(t,e){class n extends o.a.PureComponent{constructor(t){super(t),w(this,\"containerRef\",o.a.createRef()),w(this,\"setTooltip\",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)});const{width:n,height:i,formData:a}=t;let{viewport:r}=t;a.autozoom&&(r=Object(v.a)(r,{width:n,height:i,points:e(t.payload.data.features)})),this.state={viewport:r,layer:this.computeLayer(t)},this.onViewportChange=this.onViewportChange.bind(this)}UNSAFE_componentWillReceiveProps(t){const e=x({},t.formData,{viewport:null}),n=x({},this.props.formData,{viewport:null});Object(s.isEqual)(e,n)&&t.payload===this.props.payload||this.setState({layer:this.computeLayer(t)})}onViewportChange(t){this.setState({viewport:t})}computeLayer(e){const{formData:n,payload:i,onAddFilter:o}=e;return t(n,i,o,this.setTooltip)}render(){const{formData:t,payload:e,setControlValue:n,height:i,width:a}=this.props,{layer:r,viewport:s}=this.state;return o.a.createElement(c.a,{ref:this.containerRef,mapboxApiAccessToken:e.data.mapboxApiKey,viewport:s,layers:[r],mapStyle:t.mapbox_style,setControlValue:n,width:a,height:i,onViewportChange:this.onViewportChange})}}return n.propTypes=_,n.defaultProps=S,n}function j(t,e){function n(n){const{formData:i,payload:a,setControlValue:r,viewport:s,width:c,height:l}=n;return o.a.createElement(b,{formData:i,mapboxApiKey:a.data.mapboxApiKey,setControlValue:r,viewport:s,getLayer:t,payload:a,getPoints:e,width:c,height:l})}return n.propTypes=_,n.defaultProps=S,n}},4617:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return l}));var i=n(0),o=n.n(i),a=n(2),r=n.n(a),s=n(288);n(4618);const c={categories:r.a.object,toggleCategory:r.a.func,showSingleCategory:r.a.func,format:r.a.string,position:r.a.oneOf([null,\"tl\",\"tr\",\"bl\",\"br\"])};class l extends o.a.PureComponent{format(t){if(!this.props.format)return t;const e=parseFloat(t);return Object(s.b)(this.props.format,e)}formatCategoryLabel(t){if(!this.props.format)return t;if(t.includes(\" - \")){const e=t.split(\" - \");return this.format(e[0])+\" - \"+this.format(e[1])}return this.format(t)}render(){if(0===Object.keys(this.props.categories).length||null===this.props.position)return null;const t=Object.entries(this.props.categories).map(t=>{let[e,n]=t;const i={color:\"rgba(\"+n.color.join(\", \")+\")\"},a=n.enabled?\"◼\":\"◻\";return o.a.createElement(\"li\",{key:e},o.a.createElement(\"a\",{href:\"#\",onClick:()=>this.props.toggleCategory(e),onDoubleClick:()=>this.props.showSingleCategory(e)},o.a.createElement(\"span\",{style:i},a),\" \",this.formatCategoryLabel(e)))}),e={position:\"absolute\",[\"t\"===this.props.position.charAt(0)?\"top\":\"bottom\"]:\"0px\",[\"r\"===this.props.position.charAt(1)?\"right\":\"left\"]:\"10px\"};return o.a.createElement(\"div\",{className:\"legend\",style:e},o.a.createElement(\"ul\",{className:\"categories\"},t))}}l.propTypes=c,l.defaultProps={categories:{},toggleCategory:()=>{},showSingleCategory:()=>{},format:null,position:\"tr\"}},4618:function(t,e,n){},4644:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return x}));var i=n(16),o=n(17),a=n(178),r=n(80),s=n(229),c=n(19),l=n(4636),p=n(4836),u=n(4733),h=n(4592),d=n(5066),f=h.a.Tesselator,v=d.a.fp64LowPart,g=function(t){function e(t){var n=t.data,o=t.getGeometry,s=t.positionFormat,c=t.fp64;return Object(i.a)(this,e),Object(a.a)(this,Object(r.a)(e).call(this,{data:n,getGeometry:o,fp64:c,positionFormat:s,attributes:{startPositions:{size:3},endPositions:{size:3},leftPositions:{size:3},rightPositions:{size:3},startEndPositions64XyLow:{size:4,fp64Only:!0},neighborPositions64XyLow:{size:4,fp64Only:!0}}}))}return Object(c.a)(e,t),Object(o.a)(e,[{key:\"get\",value:function(t){return this.attributes[t]}},{key:\"getGeometrySize\",value:function(t){return Math.max(0,this.getPathLength(t)-1)}},{key:\"updateGeometryAttributes\",value:function(t,e){var n=this.attributes,i=n.startPositions,o=n.endPositions,a=n.leftPositions,r=n.rightPositions,s=n.startEndPositions64XyLow,c=n.neighborPositions64XyLow,l=this.fp64,p=e.geometrySize+1;if(!(p<2))for(var u,h=this.isClosed(t),d=this.getPointOnPath(t,0),f=this.getPointOnPath(t,1),g=h?this.getPointOnPath(t,p-2):d,m=e.vertexStart,y=1;y<p;m++,y++)u=y+1<p?this.getPointOnPath(t,y+1):h?this.getPointOnPath(t,1):f,i[3*m]=d[0],i[3*m+1]=d[1],i[3*m+2]=d[2]||0,o[3*m]=f[0],o[3*m+1]=f[1],o[3*m+2]=f[2]||0,a[3*m]=g[0],a[3*m+1]=g[1],a[3*m+2]=g[2]||0,r[3*m]=u[0],r[3*m+1]=u[1],r[3*m+2]=u[2]||0,l&&(s[4*m]=v(d[0]),s[4*m+1]=v(d[1]),s[4*m+2]=v(f[0]),s[4*m+3]=v(f[1]),c[4*m]=v(g[0]),c[4*m+1]=v(g[1]),c[4*m+2]=v(u[0]),c[4*m+3]=v(u[1])),g=d,d=f,f=u}},{key:\"getPathLength\",value:function(t){return Number.isFinite(t[0])?t.length/this.positionSize:t.length}},{key:\"getPointOnPath\",value:function(t,e){if(Number.isFinite(t[0])){var n=this.positionSize;return[t[e*n],t[e*n+1],3===n?t[e*n+2]:0]}return t[e]}},{key:\"isClosed\",value:function(t){var e=this.getPathLength(t),n=this.getPointOnPath(t,0),i=this.getPointOnPath(t,e-1);return n[0]===i[0]&&n[1]===i[1]&&n[2]===i[2]}}]),e}(f),m=\"#define SHADER_NAME path-layer-fragment-shader\\n\\nprecision highp float;\\n\\nuniform float jointType;\\nuniform float miterLimit;\\nuniform float alignMode;\\n\\nvarying vec4 vColor;\\nvarying vec2 vCornerOffset;\\nvarying float vMiterLength;\\nvarying vec2 vDashArray;\\nvarying vec2 vPathPosition;\\nvarying float vPathLength;\\nfloat mod2(float a, float b) {\\n  return a - floor(a / b) * b;\\n}\\n\\nfloat round(float x) {\\n  return floor(x + 0.5);\\n}\\nbool dash_isFragInGap() {\\n  float solidLength = vDashArray.x;\\n  float gapLength = vDashArray.y;\\n\\n  float unitLength = solidLength + gapLength;\\n\\n  if (unitLength == 0.0) {\\n    return false;\\n  }\\n\\n  unitLength = mix(\\n    unitLength,\\n    vPathLength / round(vPathLength / unitLength),\\n    alignMode\\n  );\\n\\n  float offset = alignMode * solidLength / 2.0;\\n\\n  return gapLength > 0.0 &&\\n    vPathPosition.y >= 0.0 &&\\n    vPathPosition.y <= vPathLength &&\\n    mod2(vPathPosition.y + offset, unitLength) > solidLength;\\n}\\n\\nvoid main(void) {\\n  if (jointType > 0.0 && vMiterLength > 0.0 && length(vCornerOffset) > 1.0) {\\n    discard;\\n  }\\n  if (jointType == 0.0 && vMiterLength > miterLimit) {\\n    discard;\\n  }\\n  if (vColor.a == 0.0 || dash_isFragInGap()) {\\n    discard;\\n  }\\n  gl_FragColor = vColor;\\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\\n}\\n\",y=[0,0,0,255],P={widthUnits:\"meters\",widthScale:{type:\"number\",min:0,value:1},widthMinPixels:{type:\"number\",min:0,value:0},widthMaxPixels:{type:\"number\",min:0,value:Number.MAX_SAFE_INTEGER},rounded:!1,miterLimit:{type:\"number\",min:0,value:4},fp64:!1,dashJustified:!1,billboard:!1,getPath:{type:\"accessor\",value:function(t){return t.path}},getColor:{type:\"accessor\",value:y},getWidth:{type:\"accessor\",value:1},getDashArray:{type:\"accessor\",value:[0,0]}},b={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},x=function(t){function e(){return Object(i.a)(this,e),Object(a.a)(this,Object(r.a)(e).apply(this,arguments))}return Object(c.a)(e,t),Object(o.a)(e,[{key:\"getShaders\",value:function(){return this.use64bitProjection()?{vs:\"\\n#define SHADER_NAME path-layer-vertex-shader-64\\n\\nattribute vec3 positions;\\n\\nattribute vec3 instanceStartPositions;\\nattribute vec3 instanceEndPositions;\\nattribute vec4 instanceStartEndPositions64xyLow;\\nattribute vec3 instanceLeftPositions;\\nattribute vec3 instanceRightPositions;\\nattribute vec4 instanceNeighborPositions64xyLow;\\nattribute float instanceStrokeWidths;\\nattribute vec4 instanceColors;\\nattribute vec3 instancePickingColors;\\nattribute vec2 instanceDashArrays;\\n\\nuniform float widthScale;\\nuniform float widthMinPixels;\\nuniform float widthMaxPixels;\\nuniform float jointType;\\nuniform float miterLimit;\\n\\nuniform float opacity;\\n\\nvarying vec4 vColor;\\nvarying vec2 vCornerOffset;\\nvarying float vMiterLength;\\nvarying vec2 vDashArray;\\nvarying vec2 vPathPosition;\\nvarying float vPathLength;\\n\\nconst float EPSILON = 0.001;\\n\\nfloat flipIfTrue(bool flag) {\\n  return -(float(flag) * 2. - 1.);\\n}\\n\\nvec3 lineJoin(vec2 prevPoint64[2], vec2 currPoint64[2], vec2 nextPoint64[2]) {\\n\\n  float widthPixels = clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\\n    widthMinPixels, widthMaxPixels) / 2.0;\\n  float width = project_pixel_size(widthPixels);\\n\\n  vec2 deltaA64[2];\\n  vec2 deltaB64[2];\\n\\n  vec2_sub_fp64(currPoint64, prevPoint64, deltaA64);\\n  vec2_sub_fp64(nextPoint64, currPoint64, deltaB64);\\n\\n  vec2 lengthA64 = vec2_length_fp64(deltaA64);\\n  vec2 lengthB64 = vec2_length_fp64(deltaB64);\\n\\n  vec2 deltaA = vec2(deltaA64[0].x, deltaA64[1].x);\\n  vec2 deltaB = vec2(deltaB64[0].x, deltaB64[1].x);\\n\\n  float lenA = lengthA64.x;\\n  float lenB = lengthB64.x;\\n\\n  vec2 offsetVec;\\n  float offsetScale;\\n  float offsetDirection;\\n  lenA = lenA / width > EPSILON ? lenA : 0.0;\\n  lenB = lenB / width > EPSILON ? lenB : 0.0;\\n  vec2 dirA = lenA > 0. ? deltaA / lenA : vec2(0.0, 0.0);\\n  vec2 dirB = lenB > 0. ? deltaB / lenB : vec2(0.0, 0.0);\\n\\n  vec2 perpA = vec2(-dirA.y, dirA.x);\\n  vec2 perpB = vec2(-dirB.y, dirB.x);\\n  vec2 tangent = vec2(dirA + dirB);\\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\\n  vec2 perp = mix(perpB, perpA, positions.x);\\n  float L = mix(lenB, lenA, positions.x);\\n  float sinHalfA = abs(dot(miterVec, perp));\\n  float cosHalfA = abs(dot(dirA, miterVec));\\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\\n  float cornerPosition = mix(\\n    flipIfTrue(turnsRight == (positions.y > 0.0)),\\n    0.0,\\n    positions.z\\n  );\\n\\n  offsetScale = 1.0 / max(sinHalfA, EPSILON);\\n  cornerPosition *= float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) / width * cosHalfA);\\n  offsetScale = mix(\\n    offsetScale,\\n    min(offsetScale, L / width / max(cosHalfA, EPSILON)),\\n    float(cornerPosition < 0.0)\\n  );\\n\\n  vMiterLength = mix(\\n    offsetScale * cornerPosition,\\n    mix(offsetScale, 0.0, cornerPosition),\\n    step(0.0, cornerPosition)\\n  ) - sinHalfA * jointType;\\n  offsetDirection = mix(\\n    positions.y,\\n    mix(\\n      flipIfTrue(turnsRight),\\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\\n      cornerPosition\\n    ),\\n    step(0.0, cornerPosition)\\n  );\\n  offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\\n  float isStartCap = step(lenA, 1.0e-5);\\n  float isEndCap = step(lenB, 1.0e-5);\\n  float isCap = max(isStartCap, isEndCap);\\n  cornerPosition = isCap * (1.0 - positions.z);\\n  offsetVec = mix(offsetVec, mix(dirB, perpB, cornerPosition), isStartCap);\\n  offsetVec = mix(offsetVec, mix(dirA, perpA, cornerPosition), isEndCap);\\n  offsetScale = mix(\\n    offsetScale,\\n    mix(4.0 * jointType, 1.0, cornerPosition),\\n    isCap\\n  );\\n  vMiterLength = mix(vMiterLength, 1.0 - cornerPosition, isCap);\\n\\n  offsetDirection = mix(\\n    offsetDirection,\\n    mix(flipIfTrue(isStartCap > 0.), positions.y, cornerPosition),\\n    isCap\\n  );\\n\\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\\n  vDashArray = instanceDashArrays;\\n  vPathLength = L / width;\\n  float isEnd = positions.x;\\n  vec2 offsetFromStartOfPath = mix(vCornerOffset, vCornerOffset + deltaA / width, isEnd);\\n  vec2 dir = mix(dirB, dirA, isEnd);\\n  vPathPosition = vec2(\\n    positions.y + positions.z * offsetDirection,\\n    dot(offsetFromStartOfPath, dir)\\n  );\\n\\n  return vec3(vCornerOffset * width, 0.0);\\n}\\n\\nvoid main() {\\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\\n  picking_setPickingColor(instancePickingColors);\\n\\n  float isEnd = positions.x;\\n\\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\\n  vec2 projected_curr_position[2];\\n  project_position_fp64(currPosition.xy, currPosition64xyLow, projected_curr_position);\\n  float projected_curr_position_z = project_size(currPosition.z);\\n\\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\\n  vec2 prevPosition64xyLow = mix(instanceNeighborPositions64xyLow.xy, instanceStartEndPositions64xyLow.xy, isEnd);\\n\\n  vec2 projected_prev_position[2];\\n  project_position_fp64(prevPosition.xy, prevPosition64xyLow, projected_prev_position);\\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\\n  vec2 nextPosition64xyLow = mix(instanceStartEndPositions64xyLow.zw, instanceNeighborPositions64xyLow.zw, isEnd);\\n\\n  vec2 projected_next_position[2];\\n  project_position_fp64(nextPosition.xy, nextPosition64xyLow, projected_next_position);\\n\\n  vec3 pos = lineJoin(projected_prev_position, projected_curr_position, projected_next_position);\\n  vec2 vertex_pos_modelspace[4];\\n\\n  vertex_pos_modelspace[0] = sum_fp64(vec2(pos.x, 0.0), projected_curr_position[0]);\\n  vertex_pos_modelspace[1] = sum_fp64(vec2(pos.y, 0.0), projected_curr_position[1]);\\n  vertex_pos_modelspace[2] = vec2(pos.z + projected_curr_position_z, 0.0);\\n  vertex_pos_modelspace[3] = vec2(1.0, 0.0);\\n\\n  gl_Position = project_common_position_to_clipspace_fp64(vertex_pos_modelspace);\\n}\\n\",fs:m,modules:[\"project64\",\"picking\"]}:{vs:\"#define SHADER_NAME path-layer-vertex-shader\\n\\nattribute vec3 positions;\\n\\nattribute vec3 instanceStartPositions;\\nattribute vec3 instanceEndPositions;\\nattribute vec4 instanceStartEndPositions64xyLow;\\nattribute vec3 instanceLeftPositions;\\nattribute vec3 instanceRightPositions;\\nattribute vec4 instanceNeighborPositions64xyLow;\\nattribute float instanceStrokeWidths;\\nattribute vec4 instanceColors;\\nattribute vec3 instancePickingColors;\\nattribute vec2 instanceDashArrays;\\n\\nuniform float widthScale;\\nuniform float widthMinPixels;\\nuniform float widthMaxPixels;\\nuniform float jointType;\\nuniform float miterLimit;\\nuniform bool billboard;\\n\\nuniform float opacity;\\n\\nvarying vec4 vColor;\\nvarying vec2 vCornerOffset;\\nvarying float vMiterLength;\\nvarying vec2 vDashArray;\\nvarying vec2 vPathPosition;\\nvarying float vPathLength;\\n\\nconst float EPSILON = 0.001;\\nconst vec3 ZERO_OFFSET = vec3(0.0);\\n\\nfloat flipIfTrue(bool flag) {\\n  return -(float(flag) * 2. - 1.);\\n}\\nvec3 lineJoin(\\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\\n  float relativePosition, bool isEnd, bool isJoint,\\n  vec2 width\\n) {\\n  vec2 deltaA = (currPoint.xy - prevPoint.xy) / width;\\n  vec2 deltaB = (nextPoint.xy - currPoint.xy) / width;\\n\\n  float lenA = length(deltaA);\\n  float lenB = length(deltaB);\\n  lenA = lenA > EPSILON ? lenA : 0.0;\\n  lenB = lenB > EPSILON ? lenB : 0.0;\\n\\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\\n\\n  vec2 perpA = vec2(-dirA.y, dirA.x);\\n  vec2 perpB = vec2(-dirB.y, dirB.x);\\n  vec2 tangent = vec2(dirA + dirB);\\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\\n  vec2 perp = isEnd ? perpA : perpB;\\n  float L = isEnd ? lenA : lenB;\\n  float sinHalfA = abs(dot(miterVec, perp));\\n  float cosHalfA = abs(dot(dirA, miterVec));\\n\\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\\n\\n  float offsetScale = 1.0 / max(sinHalfA, EPSILON);\\n\\n  float cornerPosition = isJoint ?\\n    0.0 :\\n    flipIfTrue(turnsRight == (relativePosition > 0.0));\\n  cornerPosition *=\\n    float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) * cosHalfA);\\n  if (cornerPosition < 0.0) {\\n    offsetScale = min(offsetScale, L / max(cosHalfA, EPSILON));\\n  }\\n\\n  vMiterLength = cornerPosition >= 0.0 ?\\n    mix(offsetScale, 0.0, cornerPosition) :\\n    offsetScale * cornerPosition;\\n  vMiterLength -= sinHalfA * jointType;\\n\\n  float offsetDirection = mix(\\n    positions.y,\\n    mix(\\n      flipIfTrue(turnsRight),\\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\\n      cornerPosition\\n    ),\\n    step(0.0, cornerPosition)\\n  );\\n\\n  vec2 offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\\n  bool isStartCap = step(0.0, -lenA) > 0.5;\\n  bool isEndCap = step(0.0, -lenB) > 0.5;\\n  bool isCap = isStartCap || isEndCap;\\n  cornerPosition = isCap ? (1.0 - positions.z) : 0.;\\n  if (isStartCap) {\\n    offsetVec = mix(dirB, perpB, cornerPosition);\\n  }\\n  if (isEndCap) {\\n    offsetVec = mix(dirA, perpA, cornerPosition);\\n  }\\n  if (isCap) {\\n    offsetScale = mix(4.0 * jointType, 1.0, cornerPosition);\\n    vMiterLength = 1.0 - cornerPosition;\\n    offsetDirection = mix(flipIfTrue(isStartCap), positions.y, cornerPosition);\\n  }\\n\\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\\n  vDashArray = instanceDashArrays;\\n  vPathLength = L;\\n  vec2 offsetFromStartOfPath = vCornerOffset;\\n  if (isEnd) {\\n    offsetFromStartOfPath += deltaA;\\n  }\\n  vec2 dir = isEnd ? dirA : dirB;\\n  vPathPosition = vec2(\\n    positions.y + positions.z * offsetDirection,\\n    dot(offsetFromStartOfPath, dir)\\n  );\\n\\n  return currPoint + vec3(vCornerOffset * width, 0.0);\\n}\\nvec3 lineJoin(vec3 prevPoint, vec3 currPoint, vec3 nextPoint) {\\n\\n  float relativePosition = positions.y;\\n  bool isEnd = positions.x > EPSILON;\\n  bool isJoint = positions.z > EPSILON;\\n\\n  vec2 widthPixels = vec2(clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\\n    widthMinPixels, widthMaxPixels) / 2.0);\\n\\n  return lineJoin(\\n    prevPoint, currPoint, nextPoint,\\n    relativePosition, isEnd, isJoint,\\n    billboard ? project_pixel_size_to_clipspace(widthPixels) : project_pixel_size(widthPixels)\\n  );\\n}\\nvoid clipLine(inout vec4 position, vec4 refPosition) {\\n  if (position.w < EPSILON) {\\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\\n    position = refPosition + (position - refPosition) * r;\\n  }\\n}\\n\\nvoid main() {\\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\\n  picking_setPickingColor(instancePickingColors);\\n\\n  float isEnd = positions.x;\\n\\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\\n  vec2 prevPosition64xyLow = mix(instanceNeighborPositions64xyLow.xy, instanceStartEndPositions64xyLow.xy, isEnd);\\n\\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\\n\\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\\n  vec2 nextPosition64xyLow = mix(instanceStartEndPositions64xyLow.zw, instanceNeighborPositions64xyLow.zw, isEnd);\\n\\n  if (billboard) {\\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64xyLow, ZERO_OFFSET);\\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64xyLow, ZERO_OFFSET);\\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64xyLow, ZERO_OFFSET);\\n\\n    clipLine(prevPositionScreen, currPositionScreen);\\n    clipLine(nextPositionScreen, currPositionScreen);\\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\\n\\n    vec3 pos = lineJoin(\\n      prevPositionScreen.xyz / prevPositionScreen.w,\\n      currPositionScreen.xyz / currPositionScreen.w,\\n      nextPositionScreen.xyz / nextPositionScreen.w\\n    );\\n\\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\\n  } else {\\n    prevPosition = project_position(prevPosition, prevPosition64xyLow);\\n    currPosition = project_position(currPosition, currPosition64xyLow);\\n    nextPosition = project_position(nextPosition, nextPosition64xyLow);\\n\\n    vec3 pos = lineJoin(prevPosition, currPosition, nextPosition);\\n    gl_Position = project_common_position_to_clipspace(vec4(pos, 1.0));\\n  }\\n}\\n\",fs:m,modules:[\"project32\",\"picking\"]}}},{key:\"initializeState\",value:function(){var t=this;this.getAttributeManager().addInstanced({instanceStartPositions:{size:3,transition:b,accessor:\"getPath\",update:this.calculateStartPositions,noAlloc:!0},instanceEndPositions:{size:3,transition:b,accessor:\"getPath\",update:this.calculateEndPositions,noAlloc:!0},instanceStartEndPositions64xyLow:{size:4,update:this.calculateInstanceStartEndPositions64xyLow,noAlloc:!0},instanceLeftPositions:{size:3,accessor:\"getPath\",update:this.calculateLeftPositions,noAlloc:!0},instanceRightPositions:{size:3,accessor:\"getPath\",update:this.calculateRightPositions,noAlloc:!0},instanceNeighborPositions64xyLow:{size:4,update:this.calculateInstanceNeighborPositions64xyLow,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:\"getWidth\",transition:b,defaultValue:1},instanceDashArrays:{size:2,accessor:\"getDashArray\"},instanceColors:{size:4,type:5121,accessor:\"getColor\",transition:b,defaultValue:y},instancePickingColors:{size:3,type:5121,accessor:function(e,n){var i=n.index,o=n.target;return t.encodePickingColor(i,o)}}}),this.setState({pathTesselator:new g({})})}},{key:\"updateState\",value:function(t){var n=t.oldProps,i=t.props,o=t.changeFlags;Object(s.a)(Object(r.a)(e.prototype),\"updateState\",this).call(this,{props:i,oldProps:n,changeFlags:o});var a=this.getAttributeManager();if(o.dataChanged||i.fp64!==n.fp64||o.updateTriggersChanged&&(o.updateTriggersChanged.all||o.updateTriggersChanged.getPath)){var c=this.state.pathTesselator;c.updateGeometry({data:i.data,getGeometry:i.getPath,positionFormat:i.positionFormat,fp64:this.use64bitPositions()}),this.setState({numInstances:c.instanceCount,bufferLayout:c.bufferLayout}),a.invalidateAll()}if(i.fp64!==n.fp64){var l=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(l)}),a.invalidateAll()}}},{key:\"draw\",value:function(t){var e=t.uniforms,n=this.context.viewport,i=this.props,o=i.rounded,a=i.billboard,r=i.miterLimit,s=i.widthUnits,c=i.widthScale,l=i.widthMinPixels,p=i.widthMaxPixels,u=i.dashJustified,h=\"pixels\"===s?n.distanceScales.metersPerPixel[2]:1;this.state.model.setUniforms(Object.assign({},e,{jointType:Number(o),billboard:a,alignMode:Number(u),widthScale:c*h,miterLimit:r,widthMinPixels:l,widthMaxPixels:p})).draw()}},{key:\"_getModel\",value:function(t){return new p.a(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new u.a({drawMode:4,attributes:{indices:new Uint16Array([0,2,1,1,2,4,1,4,3,3,4,5]),positions:new Float32Array([0,0,1,0,-1,0,0,1,0,1,-1,0,1,1,0,1,0,1])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:\"calculateStartPositions\",value:function(t){var e=this.state.pathTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get(\"startPositions\")}},{key:\"calculateEndPositions\",value:function(t){var e=this.state.pathTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get(\"endPositions\")}},{key:\"calculateInstanceStartEndPositions64xyLow\",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.pathTesselator.get(\"startEndPositions64XyLow\"):new Float32Array(4)}},{key:\"calculateLeftPositions\",value:function(t){var e=this.state.pathTesselator;t.value=e.get(\"leftPositions\")}},{key:\"calculateRightPositions\",value:function(t){var e=this.state.pathTesselator;t.value=e.get(\"rightPositions\")}},{key:\"calculateInstanceNeighborPositions64xyLow\",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.pathTesselator.get(\"neighborPositions64XyLow\"):new Float32Array(4)}},{key:\"clearPickingColor\",value:function(t){for(var e=this.decodePickingColor(t),n=this.state.pathTesselator.bufferLayout,i=n[e],o=0,a=0;a<e;a++)o+=n[a];var r=this.getAttributeManager().attributes.instancePickingColors,s=r.value,c=o+i;s.fill(0,3*o,3*c),r.update({value:s})}}]),e}(l.a);x.layerName=\"PathLayer\",x.defaultProps=P},4795:function(t,e,n){\"use strict\";n.r(e),n.d(e,\"getLayer\",(function(){return h}));var i=n(4644),o=n(0),a=n.n(o),r=n(4608),s=n(4602),c=n(4614),l=n(4609);function p(){return(p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function u(t){return t.object.extraProps&&a.a.createElement(\"div\",{className:\"deckgl-tooltip\"},Object.keys(t.object.extraProps).map((e,n)=>a.a.createElement(l.a,{key:\"prop-\"+n,label:e+\": \",value:\"\"+t.object.extraProps[e]})))}function h(t,e,n,o){const a=t,c=a.color_picker,l=[c.r,c.g,c.b,255*c.a];let h=e.data.features.map(t=>p({},t,{path:t.path,width:a.line_width,color:l}));if(a.js_data_mutator){h=Object(s.a)(a.js_data_mutator)(h)}return new i.a(p({id:\"path-layer-\"+a.slice_id,getColor:t=>t.color,getPath:t=>t.path,getWidth:t=>t.width,data:h,rounded:!0,widthScale:1},Object(r.a)(a,o,u)))}e.default=Object(c.b)(h,(function(t){let e=[];return t.forEach(t=>{e=e.concat(t.path)}),e}))}}]);","extractedComments":[]}
{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1602:function(t,e,n){},2067:function(t,e,n){var i;!function(o,r,a){if(o){for(var s,l={8:\"backspace\",9:\"tab\",13:\"enter\",16:\"shift\",17:\"ctrl\",18:\"alt\",20:\"capslock\",27:\"esc\",32:\"space\",33:\"pageup\",34:\"pagedown\",35:\"end\",36:\"home\",37:\"left\",38:\"up\",39:\"right\",40:\"down\",45:\"ins\",46:\"del\",91:\"meta\",93:\"meta\",224:\"meta\"},c={106:\"*\",107:\"+\",109:\"-\",110:\".\",111:\"/\",186:\";\",187:\"=\",188:\",\",189:\"-\",190:\".\",191:\"/\",192:\"`\",219:\"[\",220:\"\\\\\",221:\"]\",222:\"'\"},u={\"~\":\"`\",\"!\":\"1\",\"@\":\"2\",\"#\":\"3\",$:\"4\",\"%\":\"5\",\"^\":\"6\",\"&\":\"7\",\"*\":\"8\",\"(\":\"9\",\")\":\"0\",_:\"-\",\"+\":\"=\",\":\":\";\",'\"':\"'\",\"<\":\",\",\">\":\".\",\"?\":\"/\",\"|\":\"\\\\\"},p={option:\"alt\",command:\"meta\",return:\"enter\",escape:\"esc\",plus:\"+\",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?\"meta\":\"ctrl\"},h=1;h<20;++h)l[111+h]=\"f\"+h;for(h=0;h<=9;++h)l[h+96]=h.toString();x.prototype.bind=function(t,e,n){return t=t instanceof Array?t:[t],this._bindMultiple.call(this,t,e,n),this},x.prototype.unbind=function(t,e){return this.bind.call(this,t,(function(){}),e)},x.prototype.trigger=function(t,e){return this._directMap[t+\":\"+e]&&this._directMap[t+\":\"+e]({},t),this},x.prototype.reset=function(){return this._callbacks={},this._directMap={},this},x.prototype.stopCallback=function(t,e){if((\" \"+e.className+\" \").indexOf(\" mousetrap \")>-1)return!1;if(function t(e,n){return null!==e&&e!==r&&(e===n||t(e.parentNode,n))}(e,this.target))return!1;if(\"composedPath\"in t&&\"function\"==typeof t.composedPath){var n=t.composedPath()[0];n!==t.target&&(e=n)}return\"INPUT\"==e.tagName||\"SELECT\"==e.tagName||\"TEXTAREA\"==e.tagName||e.isContentEditable},x.prototype.handleKey=function(){var t=this;return t._handleKey.apply(t,arguments)},x.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(l[e]=t[e]);s=null},x.init=function(){var t=x(r);for(var e in t)\"_\"!==e.charAt(0)&&(x[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},x.init(),o.Mousetrap=x,t.exports&&(t.exports=x),void 0===(i=function(){return x}.call(e,n,e,t))||(t.exports=i)}function d(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent(\"on\"+e,n)}function f(t){if(\"keypress\"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return l[t.which]?l[t.which]:c[t.which]?c[t.which]:String.fromCharCode(t.which).toLowerCase()}function v(t){return\"shift\"==t||\"ctrl\"==t||\"alt\"==t||\"meta\"==t}function g(t,e,n){return n||(n=function(){if(!s)for(var t in s={},l)t>95&&t<112||l.hasOwnProperty(t)&&(s[l[t]]=t);return s}()[t]?\"keydown\":\"keypress\"),\"keypress\"==n&&e.length&&(n=\"keydown\"),n}function y(t,e){var n,i,o,r=[];for(n=function(t){return\"+\"===t?[\"+\"]:(t=t.replace(/\\+{2}/g,\"+plus\")).split(\"+\")}(t),o=0;o<n.length;++o)i=n[o],p[i]&&(i=p[i]),e&&\"keypress\"!=e&&u[i]&&(i=u[i],r.push(\"shift\")),v(i)&&r.push(i);return{key:i,modifiers:r,action:e=g(i,r,e)}}function x(t){var e=this;if(t=t||r,!(e instanceof x))return new x(t);e.target=t,e._callbacks={},e._directMap={};var n,i={},o=!1,a=!1,s=!1;function l(t){t=t||{};var e,n=!1;for(e in i)t[e]?n=!0:i[e]=0;n||(s=!1)}function c(t,n,o,r,a,s){var l,c,u,p,h=[],d=o.type;if(!e._callbacks[t])return[];for(\"keyup\"==d&&v(t)&&(n=[t]),l=0;l<e._callbacks[t].length;++l)if(c=e._callbacks[t][l],(r||!c.seq||i[c.seq]==c.level)&&d==c.action&&(\"keypress\"==d&&!o.metaKey&&!o.ctrlKey||(u=n,p=c.modifiers,u.sort().join(\",\")===p.sort().join(\",\")))){var f=!r&&c.combo==a,g=r&&c.seq==r&&c.level==s;(f||g)&&e._callbacks[t].splice(l,1),h.push(c)}return h}function u(t,n,i,o){e.stopCallback(n,n.target||n.srcElement,i,o)||!1===t(n,i)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(n),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(n))}function p(t){\"number\"!=typeof t.which&&(t.which=t.keyCode);var n=f(t);n&&(\"keyup\"!=t.type||o!==n?e.handleKey(n,function(t){var e=[];return t.shiftKey&&e.push(\"shift\"),t.altKey&&e.push(\"alt\"),t.ctrlKey&&e.push(\"ctrl\"),t.metaKey&&e.push(\"meta\"),e}(t),t):o=!1)}function h(t,e,r,a){function c(e){return function(){s=e,++i[t],clearTimeout(n),n=setTimeout(l,1e3)}}function p(e){u(r,e,t),\"keyup\"!==a&&(o=f(e)),setTimeout(l,10)}i[t]=0;for(var h=0;h<e.length;++h){var d=h+1===e.length?p:c(a||y(e[h+1]).action);g(e[h],d,a,t,h)}}function g(t,n,i,o,r){e._directMap[t+\":\"+i]=n;var a,s=(t=t.replace(/\\s+/g,\" \")).split(\" \");s.length>1?h(t,s,n,i):(a=y(t,i),e._callbacks[a.key]=e._callbacks[a.key]||[],c(a.key,a.modifiers,{type:a.action},o,t,r),e._callbacks[a.key][o?\"unshift\":\"push\"]({callback:n,modifiers:a.modifiers,action:a.action,seq:o,level:r,combo:t}))}e._handleKey=function(t,e,n){var i,o=c(t,e,n),r={},p=0,h=!1;for(i=0;i<o.length;++i)o[i].seq&&(p=Math.max(p,o[i].level));for(i=0;i<o.length;++i)if(o[i].seq){if(o[i].level!=p)continue;h=!0,r[o[i].seq]=1,u(o[i].callback,n,o[i].combo,o[i].seq)}else h||u(o[i].callback,n,o[i].combo);var d=\"keypress\"==n.type&&a;n.type!=s||v(t)||d||l(r),a=h&&\"keydown\"==n.type},e._bindMultiple=function(t,e,n){for(var i=0;i<t.length;++i)g(t[i],e,n)},d(t,\"keypress\",p),d(t,\"keydown\",p),d(t,\"keyup\",p)}}(\"undefined\"!=typeof window?window:null,\"undefined\"!=typeof window?document:null)},4452:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return z}));var i=n(13),o=n(7),r=n(16),a=n(17),s=n(4470);function l(t,e){var n=s.c([],e,t);return s.b(n,n,1/n[3]),n}var c=n(4453),u=n(4448),p=n(4465);function h(t,e){if(!t)throw new Error(e||\"@math.gl/web-mercator: assertion failed.\")}var d=Math.PI,f=d/4,v=d/180,g=180/d;function y(t){return Math.pow(2,t)}function x(t){var e=Object(o.a)(t,2),n=e[0],i=e[1];h(Number.isFinite(n)),h(Number.isFinite(i)&&i>=-90&&i<=90,\"invalid latitude\");var r=i*v;return[512*(n*v+d)/(2*d),512*(d+Math.log(Math.tan(f+.5*r)))/(2*d)]}function m(t){var e=Object(o.a)(t,2),n=e[0],i=e[1],r=n/512*(2*d)-d,a=2*(Math.atan(Math.exp(i/512*(2*d)-d))-f);return[r*g,a*g]}function b(t){var e=t.latitude,n=t.longitude,i=t.highPrecision,o=void 0!==i&&i;h(Number.isFinite(e)&&Number.isFinite(n));var r={},a=Math.cos(e*v),s=512/360/a,l=512/4003e4/a;if(r.unitsPerMeter=[l,l,l],r.metersPerUnit=[1/l,1/l,1/l],r.unitsPerDegree=[512/360,s,l],r.degreesPerUnit=[.703125,1/s,1/l],o){var c=v*Math.tan(e*v)/a,u=512/360*c/2,p=512/4003e4*c,d=p/s*l;r.unitsPerDegree2=[0,u,p],r.unitsPerMeter2=[d,0,d]}return r}function P(t){var e=t.height,n=t.pitch,i=t.bearing,o=t.altitude,r=t.scale,a=t.center,s=void 0===a?null:a,l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return c.o(l,l,[0,0,-o]),c.k(l,l,-n*v),c.m(l,l,i*v),r/=e,c.n(l,l,[r,r,r]),s&&c.o(l,l,p.d([],s)),l}function w(t){var e=t.width,n=t.height,i=t.pitch,o=function(t){var e=t.width,n=t.height,i=t.altitude,o=void 0===i?1.5:i,r=t.pitch,a=void 0===r?0:r,s=t.nearZMultiplier,l=void 0===s?1:s,c=t.farZMultiplier,u=void 0===c?1:c,p=a*v,h=Math.atan(.5/o),d=Math.sin(h)*o/Math.sin(Math.min(Math.max(Math.PI/2-p-h,.01),Math.PI-.01));return{fov:2*h,aspect:e/n,focalDistance:o,near:l,far:(Math.sin(p)*d+o)*u}}({width:e,height:n,altitude:t.altitude,pitch:i,nearZMultiplier:t.nearZMultiplier,farZMultiplier:t.farZMultiplier}),r=o.fov,a=o.aspect,s=o.near,l=o.far;return c.i([],r,a,s,l)}function C(t,e){var n=Object(o.a)(t,3),i=n[0],r=n[1],a=n[2],s=void 0===a?0:a;return h(Number.isFinite(i)&&Number.isFinite(r)&&Number.isFinite(s)),l(e,[i,r,s,1])}function _(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Object(o.a)(t,3),r=i[0],a=i[1],s=i[2];if(h(Number.isFinite(r)&&Number.isFinite(a),\"invalid pixel coordinate\"),Number.isFinite(s)){var c=l(e,[r,a,s,1]);return c}var p=l(e,[r,a,0,1]),d=l(e,[r,a,1,1]),f=p[2],v=d[2],g=f===v?0:((n||0)-f)/(v-f);return u.d([],p,d,g)}function L(t){var e=t.width,n=t.height,i=t.bounds,r=t.minExtent,a=void 0===r?0:r,s=t.maxZoom,l=void 0===s?24:s,c=t.padding,u=void 0===c?0:c,p=t.offset,d=void 0===p?[0,0]:p,f=Object(o.a)(i,2),v=Object(o.a)(f[0],2),g=v[0],y=v[1],x=Object(o.a)(f[1],2),m=x[0],b=x[1];if(Number.isFinite(u)){u={top:u,bottom:u,left:u,right:u}}else h(Number.isFinite(u.top)&&Number.isFinite(u.bottom)&&Number.isFinite(u.left)&&Number.isFinite(u.right));var P=new k({width:e,height:n,longitude:0,latitude:0,zoom:0}),w=P.project([g,b]),C=P.project([m,y]),_=[Math.max(Math.abs(C[0]-w[0]),a),Math.max(Math.abs(C[1]-w[1]),a)],L=[e-u.left-u.right-2*Math.abs(d[0]),n-u.top-u.bottom-2*Math.abs(d[1])];h(L[0]>0&&L[1]>0);var S=L[0]/_[0],j=L[1]/_[1],A=(u.right-u.left)/2/S,M=(u.bottom-u.top)/2/j,O=[(C[0]+w[0])/2+A,(C[1]+w[1])/2+M],E=P.unproject(O),F=Math.min(l,P.zoom+Math.log2(Math.abs(Math.min(S,j))));return h(Number.isFinite(F)),{longitude:E[0],latitude:E[1],zoom:F}}var S=Math.PI/180;function j(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t.width,r=t.height,a=t.unproject,s={targetZ:i},l=a([0,r],s),c=a([o,r],s),u=Math.atan(.5/t.altitude),p=(90-t.pitch)*S;return u>p-.01?(e=A(t,0,i),n=A(t,o,i)):(e=a([0,0],s),n=a([o,0],s)),[l,c,n,e]}function A(t,e,n){var i=t.pixelUnprojectionMatrix,o=l(i,[e,0,1,1]),r=l(i,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-o[2])/(r[2]-o[2]),s=m(u.d([],o,r,a));return s[2]=n,s}var k=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:1,height:1},n=e.width,i=e.height,o=e.latitude,a=void 0===o?0:o,s=e.longitude,l=void 0===s?0:s,c=e.zoom,u=void 0===c?0:c,p=e.pitch,h=void 0===p?0:p,d=e.bearing,f=void 0===d?0:d,v=e.altitude,g=void 0===v?1.5:v,m=e.nearZMultiplier,C=void 0===m?.02:m,_=e.farZMultiplier,L=void 0===_?1.01:_;Object(r.a)(this,t),n=n||1,i=i||1;var S=y(u);g=Math.max(.75,g);var j=x([l,a]);j[2]=0,this.projectionMatrix=w({width:n,height:i,pitch:h,altitude:g,nearZMultiplier:C,farZMultiplier:L}),this.viewMatrix=P({height:i,scale:S,center:j,pitch:h,bearing:f,altitude:g}),this.width=n,this.height=i,this.scale=S,this.latitude=a,this.longitude=l,this.zoom=u,this.pitch=h,this.bearing=f,this.altitude=g,this.center=j,this.distanceScales=b(this),this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}return Object(a.a)(t,[{key:\"_initMatrices\",value:function(){var t=this.width,e=this.height,n=this.projectionMatrix,i=this.viewMatrix,o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];c.g(o,o,n),c.g(o,o,i),this.viewProjectionMatrix=o;var r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];c.n(r,r,[t/2,-e/2,1]),c.o(r,r,[1,-1,0]),c.g(r,r,o);var a=c.e([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r);if(!a)throw new Error(\"Pixel project matrix not invertible\");this.pixelProjectionMatrix=r,this.pixelUnprojectionMatrix=a}},{key:\"equals\",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&c.b(e.projectionMatrix,this.projectionMatrix)&&c.b(e.viewMatrix,this.viewMatrix))}},{key:\"project\",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,i=void 0===n||n,r=this.projectPosition(t),a=C(r,this.pixelProjectionMatrix),s=Object(o.a)(a,2),l=s[0],c=s[1],u=i?c:this.height-c;return 2===t.length?[l,u]:[l,u,a[2]]}},{key:\"unproject\",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,i=void 0===n||n,r=e.targetZ,a=void 0===r?void 0:r,s=Object(o.a)(t,3),l=s[0],c=s[1],u=s[2],p=i?c:this.height-c,h=a&&a*this.distanceScales.unitsPerMeter[2],d=_([l,p,u],this.pixelUnprojectionMatrix,h),f=this.unprojectPosition(d),v=Object(o.a)(f,3),g=v[0],y=v[1],x=v[2];return Number.isFinite(u)?[g,y,x]:Number.isFinite(a)?[g,y,a]:[g,y]}},{key:\"projectPosition\",value:function(t){var e=x(t),n=Object(o.a)(e,2);return[n[0],n[1],(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}},{key:\"unprojectPosition\",value:function(t){var e=m(t),n=Object(o.a)(e,2);return[n[0],n[1],(t[2]||0)*this.distanceScales.metersPerUnit[2]]}},{key:\"projectFlat\",value:function(t){return x(t)}},{key:\"unprojectFlat\",value:function(t){return m(t)}},{key:\"getMapCenterByLngLatPosition\",value:function(t){var e=t.lngLat,n=_(t.pos,this.pixelUnprojectionMatrix),i=x(e),o=u.a([],i,u.e([],n));return m(u.a([],this.center,o))}},{key:\"getLocationAtPoint\",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:\"fitBounds\",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.width,o=this.height,r=L(Object.assign({width:i,height:o,bounds:e},n)),a=r.longitude,s=r.latitude,l=r.zoom;return new t({width:i,height:o,longitude:a,latitude:s,zoom:l})}},{key:\"getBounds\",value:function(t){var e=this.getBoundingRegion(t),n=Math.min.apply(Math,Object(i.a)(e.map((function(t){return t[0]})))),o=Math.max.apply(Math,Object(i.a)(e.map((function(t){return t[0]}))));return[[n,Math.min.apply(Math,Object(i.a)(e.map((function(t){return t[1]}))))],[o,Math.max.apply(Math,Object(i.a)(e.map((function(t){return t[1]}))))]]}},{key:\"getBoundingRegion\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return j(this,t.z||0)}}]),t}();var M=n(159);const O=[-90,90],E=[-180,180];function F(t,e,n){let[i,o]=t,[r,a]=e;return void 0===n&&(n=.25),i<o?[i,o]:[Math.max(r,i-n),Math.min(a,o+n)]}function T(){return(T=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function z(t,e){let{points:n,width:i,height:o,minExtent:r,maxZoom:a,offset:s,padding:l=20}=e;const{bearing:c,pitch:u}=t,p=function(t){const e=F(Object(M.extent)(t,t=>t[1]),O),n=F(Object(M.extent)(t,t=>t[0]),E);return[[n[0],e[0]],[n[1],e[1]]]}(n);try{return T({},L({bounds:p,width:i,height:o,minExtent:r,maxZoom:a,offset:s,padding:l}),{bearing:c,pitch:u})}catch(t){console.error(\"Could not fit viewport\",t)}return t}},4458:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return s}));var i=n(32),o=n.n(i);const r=[1,0,1,0,0,0,0];function a(t,e){const n=parseInt(o()(e).format(\"x\"),10);return parseInt(o()(e).add(t).format(\"x\"),10)-n}function s(t,e){const n=o()(Math.min(...t)),i=o()(Math.max(...t));let s,l,c;if(e.includes(\"/\")){const t=e.split(\"/\",2);t[0].endsWith(\"Z\")?(l=o()(t[0]),s=o.a.duration(t[1])):(l=o()(t[1]),s=o.a.duration(t[0]))}else s=o.a.duration(e),l=function(t,e){const n=o()(t).subtract(e),i=t.toArray(),a=n.toArray(),s=i.map((t,e)=>a[e]!==t).indexOf(!0),l=i.map((t,e)=>{if(e===s){const n=t-a[e];return t-(t-r[e])%n}return e<s||-1===s?t:r[e]});return o()(l)}(n,s);const u=n.valueOf();for(c=l.clone();c.valueOf()<u;)c.add(s);for(;c.valueOf()>u;)c.subtract(s);let p;const h=i.valueOf();for(p=l.clone();p.valueOf()>h;)p.subtract(s);for(;p.valueOf()<h;)p.add(s);const d=null!=e?[c,c.clone().add(s)]:[c,p],f=t.every(t=>null===t);return{start:parseInt(c.format(\"x\"),10),end:parseInt(p.format(\"x\"),10),getStep:a.bind(this,s),values:d.map(t=>parseInt(t.format(\"x\"),10)),disabled:f}}},4461:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return x}));var i=n(0),o=n.n(i),r=n(2),a=n.n(r),s=n(4460),l=n(2067),c=n.n(l),u=n(20),p=n(1485),h=n.n(p);n(1602),n(4466);function d(t){return o.a.createElement(\"span\",{className:\"BootstrapSliderWrapper\"},o.a.createElement(h.a,t))}n(4467);const f={start:a.a.number.isRequired,step:a.a.number.isRequired,end:a.a.number.isRequired,values:a.a.array.isRequired,onChange:a.a.func,loopDuration:a.a.number,maxFrames:a.a.number,orientation:a.a.oneOf([\"horizontal\",\"vertical\"]),reversed:a.a.bool,disabled:a.a.bool,range:a.a.bool};class v extends o.a.PureComponent{constructor(t){super(t),this.state={intervalId:null};const e=t.end-t.start,n=Math.min(t.maxFrames,e/t.step),i=e/n;this.intervalMilliseconds=t.loopDuration/n,this.increment=i<t.step?t.step:i-i%t.step,this.onChange=this.onChange.bind(this),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.stepBackward=this.stepBackward.bind(this),this.stepForward=this.stepForward.bind(this),this.getPlayClass=this.getPlayClass.bind(this),this.formatter=this.formatter.bind(this)}componentDidMount(){c.a.bind([\"space\"],this.play)}componentWillUnmount(){c.a.unbind([\"space\"])}onChange(t){this.props.onChange(t.target.value),null!=this.state.intervalId&&this.pause()}getPlayClass(){return null==this.state.intervalId?\"fa fa-play fa-lg slider-button\":\"fa fa-pause fa-lg slider-button\"}play(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{const t=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:t})}}pause(){clearInterval(this.state.intervalId),this.setState({intervalId:null})}stepForward(){const{start:t,end:e,step:n,values:i,disabled:o}=this.props;if(o)return;const r=(Array.isArray(i)?i:[i,i+n]).map(t=>t+this.increment),a=r[1]>e?r[0]-t:0;this.props.onChange(r.map(t=>t-a))}stepBackward(){const{start:t,end:e,step:n,values:i,disabled:o}=this.props;if(o)return;const r=(Array.isArray(i)?i:[i,i+n]).map(t=>t-this.increment),a=r[0]<t?e-r[1]:0;this.props.onChange(r.map(t=>t+a))}formatter(t){if(this.props.disabled)return Object(u.e)(\"Data has no time steps\");let e=t;return Array.isArray(t)?t[0]===t[1]&&(e=[t[0]]):e=[t],e.map(t=>new Date(t).toUTCString()).join(\" : \")}render(){const{start:t,end:e,step:n,orientation:i,reversed:r,disabled:a,range:s,values:l}=this.props;return o.a.createElement(\"div\",{className:\"play-slider\"},o.a.createElement(\"div\",{className:\"play-slider-controls padded\"},o.a.createElement(\"i\",{className:\"fa fa-step-backward fa-lg slider-button \",onClick:this.stepBackward}),o.a.createElement(\"i\",{className:this.getPlayClass(),onClick:this.play}),o.a.createElement(\"i\",{className:\"fa fa-step-forward fa-lg slider-button \",onClick:this.stepForward})),o.a.createElement(\"div\",{className:\"play-slider-scrobbler padded\"},o.a.createElement(d,{value:s?l:l[0],range:s,formatter:this.formatter,change:this.onChange,min:t,max:e,step:n,orientation:i,reversed:r,disabled:a?\"disabled\":\"enabled\"})))}}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}v.propTypes=f,v.defaultProps={onChange:()=>{},loopDuration:15e3,maxFrames:100,orientation:\"horizontal\",reversed:!1,disabled:!1,range:!0};const y={getLayers:a.a.func.isRequired,start:a.a.number.isRequired,end:a.a.number.isRequired,getStep:a.a.func,values:a.a.array.isRequired,aggregation:a.a.bool,disabled:a.a.bool,viewport:a.a.object.isRequired,children:a.a.node,mapStyle:a.a.string,mapboxApiAccessToken:a.a.string.isRequired,setControlValue:a.a.func,onValuesChange:a.a.func,width:a.a.number.isRequired,height:a.a.number.isRequired};class x extends o.a.PureComponent{constructor(){super(...arguments),g(this,\"containerRef\",o.a.createRef()),g(this,\"setTooltip\",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)})}render(){const{start:t,end:e,getStep:n,disabled:i,aggregation:r,children:a,getLayers:l,values:c,onValuesChange:u,viewport:p,setControlValue:h,mapStyle:d,mapboxApiAccessToken:f,height:g,width:y}=this.props,x=l(c);return o.a.createElement(\"div\",null,o.a.createElement(s.a,{ref:this.containerRef,viewport:p,layers:x,setControlValue:h,mapStyle:d,mapboxApiAccessToken:f,bottomMargin:i?0:20,width:y,height:g}),!i&&o.a.createElement(v,{start:t,end:e,step:n(t),values:c,range:!r,onChange:u}),a)}}x.propTypes=y,x.defaultProps={aggregation:!1,disabled:!1,mapStyle:\"light\",setControlValue:()=>{},onValuesChange:()=>{}}},4466:function(t,e,n){},4467:function(t,e,n){},4471:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return c}));var i=n(0),o=n.n(i),r=n(2),a=n.n(r),s=n(291);n(4472);const l={categories:a.a.object,toggleCategory:a.a.func,showSingleCategory:a.a.func,format:a.a.string,position:a.a.oneOf([null,\"tl\",\"tr\",\"bl\",\"br\"])};class c extends o.a.PureComponent{format(t){if(!this.props.format)return t;const e=parseFloat(t);return Object(s.b)(this.props.format,e)}formatCategoryLabel(t){if(!this.props.format)return t;if(t.includes(\" - \")){const e=t.split(\" - \");return this.format(e[0])+\" - \"+this.format(e[1])}return this.format(t)}render(){if(0===Object.keys(this.props.categories).length||null===this.props.position)return null;const t=Object.entries(this.props.categories).map(t=>{let[e,n]=t;const i={color:\"rgba(\"+n.color.join(\", \")+\")\"},r=n.enabled?\"◼\":\"◻\";return o.a.createElement(\"li\",{key:e},o.a.createElement(\"a\",{href:\"#\",onClick:()=>this.props.toggleCategory(e),onDoubleClick:()=>this.props.showSingleCategory(e)},o.a.createElement(\"span\",{style:i},r),\" \",this.formatCategoryLabel(e)))}),e={position:\"absolute\",[\"t\"===this.props.position.charAt(0)?\"top\":\"bottom\"]:\"0px\",[\"r\"===this.props.position.charAt(1)?\"right\":\"left\"]:\"10px\"};return o.a.createElement(\"div\",{className:\"legend\",style:e},o.a.createElement(\"ul\",{className:\"categories\"},t))}}c.propTypes=l,c.defaultProps={categories:{},toggleCategory:()=>{},showSingleCategory:()=>{},format:null,position:\"tr\"}},4472:function(t,e,n){},4493:function(t,e,n){\"use strict\";n.d(e,\"b\",(function(){return d})),n.d(e,\"c\",(function(){return f})),n.d(e,\"a\",(function(){return v}));var i=n(4525),o=n.n(i);function r(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error(\"invalid polygon\")}function a(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function s(t){var e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function l(t,e,n,i){for(var o=0;o<e;o++)if(t[n+o]!==t[i-e+o])return!1;return!0}function c(t,e,n,i){for(var o=e,r=n.length,a=0;a<r;a++)for(var l=0;l<i;l++)t[o++]=n[a][l]||0;if(!s(n))for(var c=0;c<i;c++)t[o++]=n[0][c]||0;return o}function u(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5?arguments[5]:void 0,a=(r=r||n.length)-o;if(a<=0)return e;for(var s=e,c=0;c<a;c++)t[s++]=n[o+c];if(!l(n,i,o,r))for(var u=0;u<i;u++)t[s++]=n[o+u];return s}function p(t){return(s(t)?0:1)+t.length}function h(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;return n>=(i=i||t.length)?0:(l(t,e,n,i)?0:1)+(i-n)/e}function d(t,e){if(r(t),t.positions){var n=t,i=n.positions,o=n.holeIndices;if(o){for(var s=0,l=0;l<=o.length;l++)s+=h(t.positions,e,o[l-1],o[l]);return s}t=i}if(Number.isFinite(t[0]))return h(t,e);if(!a(t)){var c=0,u=!0,d=!1,f=void 0;try{for(var v,g=t[Symbol.iterator]();!(u=(v=g.next()).done);u=!0){c+=p(v.value)}}catch(t){d=!0,f=t}finally{try{u||null==g.return||g.return()}finally{if(d)throw f}}return c}return p(t)}function f(t,e,n){r(t),n=n||d(t,e);var i=new Float64Array(n*e),o=[];if(t.positions){var s=t,l=s.positions,p=s.holeIndices;if(p){for(var h=0,f=0;f<=p.length;f++)h=u(i,h,l,e,p[f-1],p[f]),o.push(h);return o.pop(),{positions:i,holeIndices:o}}t=l}if(Number.isFinite(t[0]))return u(i,0,t,e),{positions:i,holeIndices:null};if(!a(t)){var v=0,g=!0,y=!1,x=void 0;try{for(var m,b=t[Symbol.iterator]();!(g=(m=b.next()).done);g=!0){v=c(i,v,m.value,e),o.push(v)}}catch(t){y=!0,x=t}finally{try{g||null==b.return||b.return()}finally{if(y)throw x}}return o.pop(),{positions:i,holeIndices:o}}return c(i,0,t,e),{positions:i,holeIndices:null}}function v(t,e){var n=null;return t.holeIndices&&(n=t.holeIndices.map((function(t){return t/e}))),o()(t.positions,n,e)}},4498:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return P}));var i=n(16),o=n(17),r=n(179),a=n(80),s=n(233),l=n(19),c=n(4490),u=n(4690),p=n(4587),h=n(4447),d=n(4920),f=h.a.Tesselator,v=d.a.fp64LowPart,g=function(t){function e(t){var n=t.data,o=t.getGeometry,s=t.positionFormat,l=t.fp64;return Object(i.a)(this,e),Object(r.a)(this,Object(a.a)(e).call(this,{data:n,getGeometry:o,fp64:l,positionFormat:s,attributes:{startPositions:{size:3},endPositions:{size:3},leftPositions:{size:3},rightPositions:{size:3},startEndPositions64XyLow:{size:4,fp64Only:!0},neighborPositions64XyLow:{size:4,fp64Only:!0}}}))}return Object(l.a)(e,t),Object(o.a)(e,[{key:\"get\",value:function(t){return this.attributes[t]}},{key:\"getGeometrySize\",value:function(t){return Math.max(0,this.getPathLength(t)-1)}},{key:\"updateGeometryAttributes\",value:function(t,e){var n=this.attributes,i=n.startPositions,o=n.endPositions,r=n.leftPositions,a=n.rightPositions,s=n.startEndPositions64XyLow,l=n.neighborPositions64XyLow,c=this.fp64,u=e.geometrySize+1;if(!(u<2))for(var p,h=this.isClosed(t),d=this.getPointOnPath(t,0),f=this.getPointOnPath(t,1),g=h?this.getPointOnPath(t,u-2):d,y=e.vertexStart,x=1;x<u;y++,x++)p=x+1<u?this.getPointOnPath(t,x+1):h?this.getPointOnPath(t,1):f,i[3*y]=d[0],i[3*y+1]=d[1],i[3*y+2]=d[2]||0,o[3*y]=f[0],o[3*y+1]=f[1],o[3*y+2]=f[2]||0,r[3*y]=g[0],r[3*y+1]=g[1],r[3*y+2]=g[2]||0,a[3*y]=p[0],a[3*y+1]=p[1],a[3*y+2]=p[2]||0,c&&(s[4*y]=v(d[0]),s[4*y+1]=v(d[1]),s[4*y+2]=v(f[0]),s[4*y+3]=v(f[1]),l[4*y]=v(g[0]),l[4*y+1]=v(g[1]),l[4*y+2]=v(p[0]),l[4*y+3]=v(p[1])),g=d,d=f,f=p}},{key:\"getPathLength\",value:function(t){return Number.isFinite(t[0])?t.length/this.positionSize:t.length}},{key:\"getPointOnPath\",value:function(t,e){if(Number.isFinite(t[0])){var n=this.positionSize;return[t[e*n],t[e*n+1],3===n?t[e*n+2]:0]}return t[e]}},{key:\"isClosed\",value:function(t){var e=this.getPathLength(t),n=this.getPointOnPath(t,0),i=this.getPointOnPath(t,e-1);return n[0]===i[0]&&n[1]===i[1]&&n[2]===i[2]}}]),e}(f),y=\"#define SHADER_NAME path-layer-fragment-shader\\n\\nprecision highp float;\\n\\nuniform float jointType;\\nuniform float miterLimit;\\nuniform float alignMode;\\n\\nvarying vec4 vColor;\\nvarying vec2 vCornerOffset;\\nvarying float vMiterLength;\\nvarying vec2 vDashArray;\\nvarying vec2 vPathPosition;\\nvarying float vPathLength;\\nfloat mod2(float a, float b) {\\n  return a - floor(a / b) * b;\\n}\\n\\nfloat round(float x) {\\n  return floor(x + 0.5);\\n}\\nbool dash_isFragInGap() {\\n  float solidLength = vDashArray.x;\\n  float gapLength = vDashArray.y;\\n\\n  float unitLength = solidLength + gapLength;\\n\\n  if (unitLength == 0.0) {\\n    return false;\\n  }\\n\\n  unitLength = mix(\\n    unitLength,\\n    vPathLength / round(vPathLength / unitLength),\\n    alignMode\\n  );\\n\\n  float offset = alignMode * solidLength / 2.0;\\n\\n  return gapLength > 0.0 &&\\n    vPathPosition.y >= 0.0 &&\\n    vPathPosition.y <= vPathLength &&\\n    mod2(vPathPosition.y + offset, unitLength) > solidLength;\\n}\\n\\nvoid main(void) {\\n  if (jointType > 0.0 && vMiterLength > 0.0 && length(vCornerOffset) > 1.0) {\\n    discard;\\n  }\\n  if (jointType == 0.0 && vMiterLength > miterLimit) {\\n    discard;\\n  }\\n  if (vColor.a == 0.0 || dash_isFragInGap()) {\\n    discard;\\n  }\\n  gl_FragColor = vColor;\\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\\n}\\n\",x=[0,0,0,255],m={widthUnits:\"meters\",widthScale:{type:\"number\",min:0,value:1},widthMinPixels:{type:\"number\",min:0,value:0},widthMaxPixels:{type:\"number\",min:0,value:Number.MAX_SAFE_INTEGER},rounded:!1,miterLimit:{type:\"number\",min:0,value:4},fp64:!1,dashJustified:!1,billboard:!1,getPath:{type:\"accessor\",value:function(t){return t.path}},getColor:{type:\"accessor\",value:x},getWidth:{type:\"accessor\",value:1},getDashArray:{type:\"accessor\",value:[0,0]}},b={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},P=function(t){function e(){return Object(i.a)(this,e),Object(r.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(o.a)(e,[{key:\"getShaders\",value:function(){return this.use64bitProjection()?{vs:\"\\n#define SHADER_NAME path-layer-vertex-shader-64\\n\\nattribute vec3 positions;\\n\\nattribute vec3 instanceStartPositions;\\nattribute vec3 instanceEndPositions;\\nattribute vec4 instanceStartEndPositions64xyLow;\\nattribute vec3 instanceLeftPositions;\\nattribute vec3 instanceRightPositions;\\nattribute vec4 instanceNeighborPositions64xyLow;\\nattribute float instanceStrokeWidths;\\nattribute vec4 instanceColors;\\nattribute vec3 instancePickingColors;\\nattribute vec2 instanceDashArrays;\\n\\nuniform float widthScale;\\nuniform float widthMinPixels;\\nuniform float widthMaxPixels;\\nuniform float jointType;\\nuniform float miterLimit;\\n\\nuniform float opacity;\\n\\nvarying vec4 vColor;\\nvarying vec2 vCornerOffset;\\nvarying float vMiterLength;\\nvarying vec2 vDashArray;\\nvarying vec2 vPathPosition;\\nvarying float vPathLength;\\n\\nconst float EPSILON = 0.001;\\n\\nfloat flipIfTrue(bool flag) {\\n  return -(float(flag) * 2. - 1.);\\n}\\n\\nvec3 lineJoin(vec2 prevPoint64[2], vec2 currPoint64[2], vec2 nextPoint64[2]) {\\n\\n  float widthPixels = clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\\n    widthMinPixels, widthMaxPixels) / 2.0;\\n  float width = project_pixel_size(widthPixels);\\n\\n  vec2 deltaA64[2];\\n  vec2 deltaB64[2];\\n\\n  vec2_sub_fp64(currPoint64, prevPoint64, deltaA64);\\n  vec2_sub_fp64(nextPoint64, currPoint64, deltaB64);\\n\\n  vec2 lengthA64 = vec2_length_fp64(deltaA64);\\n  vec2 lengthB64 = vec2_length_fp64(deltaB64);\\n\\n  vec2 deltaA = vec2(deltaA64[0].x, deltaA64[1].x);\\n  vec2 deltaB = vec2(deltaB64[0].x, deltaB64[1].x);\\n\\n  float lenA = lengthA64.x;\\n  float lenB = lengthB64.x;\\n\\n  vec2 offsetVec;\\n  float offsetScale;\\n  float offsetDirection;\\n  lenA = lenA / width > EPSILON ? lenA : 0.0;\\n  lenB = lenB / width > EPSILON ? lenB : 0.0;\\n  vec2 dirA = lenA > 0. ? deltaA / lenA : vec2(0.0, 0.0);\\n  vec2 dirB = lenB > 0. ? deltaB / lenB : vec2(0.0, 0.0);\\n\\n  vec2 perpA = vec2(-dirA.y, dirA.x);\\n  vec2 perpB = vec2(-dirB.y, dirB.x);\\n  vec2 tangent = vec2(dirA + dirB);\\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\\n  vec2 perp = mix(perpB, perpA, positions.x);\\n  float L = mix(lenB, lenA, positions.x);\\n  float sinHalfA = abs(dot(miterVec, perp));\\n  float cosHalfA = abs(dot(dirA, miterVec));\\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\\n  float cornerPosition = mix(\\n    flipIfTrue(turnsRight == (positions.y > 0.0)),\\n    0.0,\\n    positions.z\\n  );\\n\\n  offsetScale = 1.0 / max(sinHalfA, EPSILON);\\n  cornerPosition *= float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) / width * cosHalfA);\\n  offsetScale = mix(\\n    offsetScale,\\n    min(offsetScale, L / width / max(cosHalfA, EPSILON)),\\n    float(cornerPosition < 0.0)\\n  );\\n\\n  vMiterLength = mix(\\n    offsetScale * cornerPosition,\\n    mix(offsetScale, 0.0, cornerPosition),\\n    step(0.0, cornerPosition)\\n  ) - sinHalfA * jointType;\\n  offsetDirection = mix(\\n    positions.y,\\n    mix(\\n      flipIfTrue(turnsRight),\\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\\n      cornerPosition\\n    ),\\n    step(0.0, cornerPosition)\\n  );\\n  offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\\n  float isStartCap = step(lenA, 1.0e-5);\\n  float isEndCap = step(lenB, 1.0e-5);\\n  float isCap = max(isStartCap, isEndCap);\\n  cornerPosition = isCap * (1.0 - positions.z);\\n  offsetVec = mix(offsetVec, mix(dirB, perpB, cornerPosition), isStartCap);\\n  offsetVec = mix(offsetVec, mix(dirA, perpA, cornerPosition), isEndCap);\\n  offsetScale = mix(\\n    offsetScale,\\n    mix(4.0 * jointType, 1.0, cornerPosition),\\n    isCap\\n  );\\n  vMiterLength = mix(vMiterLength, 1.0 - cornerPosition, isCap);\\n\\n  offsetDirection = mix(\\n    offsetDirection,\\n    mix(flipIfTrue(isStartCap > 0.), positions.y, cornerPosition),\\n    isCap\\n  );\\n\\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\\n  vDashArray = instanceDashArrays;\\n  vPathLength = L / width;\\n  float isEnd = positions.x;\\n  vec2 offsetFromStartOfPath = mix(vCornerOffset, vCornerOffset + deltaA / width, isEnd);\\n  vec2 dir = mix(dirB, dirA, isEnd);\\n  vPathPosition = vec2(\\n    positions.y + positions.z * offsetDirection,\\n    dot(offsetFromStartOfPath, dir)\\n  );\\n\\n  return vec3(vCornerOffset * width, 0.0);\\n}\\n\\nvoid main() {\\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\\n  picking_setPickingColor(instancePickingColors);\\n\\n  float isEnd = positions.x;\\n\\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\\n  vec2 projected_curr_position[2];\\n  project_position_fp64(currPosition.xy, currPosition64xyLow, projected_curr_position);\\n  float projected_curr_position_z = project_size(currPosition.z);\\n\\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\\n  vec2 prevPosition64xyLow = mix(instanceNeighborPositions64xyLow.xy, instanceStartEndPositions64xyLow.xy, isEnd);\\n\\n  vec2 projected_prev_position[2];\\n  project_position_fp64(prevPosition.xy, prevPosition64xyLow, projected_prev_position);\\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\\n  vec2 nextPosition64xyLow = mix(instanceStartEndPositions64xyLow.zw, instanceNeighborPositions64xyLow.zw, isEnd);\\n\\n  vec2 projected_next_position[2];\\n  project_position_fp64(nextPosition.xy, nextPosition64xyLow, projected_next_position);\\n\\n  vec3 pos = lineJoin(projected_prev_position, projected_curr_position, projected_next_position);\\n  vec2 vertex_pos_modelspace[4];\\n\\n  vertex_pos_modelspace[0] = sum_fp64(vec2(pos.x, 0.0), projected_curr_position[0]);\\n  vertex_pos_modelspace[1] = sum_fp64(vec2(pos.y, 0.0), projected_curr_position[1]);\\n  vertex_pos_modelspace[2] = vec2(pos.z + projected_curr_position_z, 0.0);\\n  vertex_pos_modelspace[3] = vec2(1.0, 0.0);\\n\\n  gl_Position = project_common_position_to_clipspace_fp64(vertex_pos_modelspace);\\n}\\n\",fs:y,modules:[\"project64\",\"picking\"]}:{vs:\"#define SHADER_NAME path-layer-vertex-shader\\n\\nattribute vec3 positions;\\n\\nattribute vec3 instanceStartPositions;\\nattribute vec3 instanceEndPositions;\\nattribute vec4 instanceStartEndPositions64xyLow;\\nattribute vec3 instanceLeftPositions;\\nattribute vec3 instanceRightPositions;\\nattribute vec4 instanceNeighborPositions64xyLow;\\nattribute float instanceStrokeWidths;\\nattribute vec4 instanceColors;\\nattribute vec3 instancePickingColors;\\nattribute vec2 instanceDashArrays;\\n\\nuniform float widthScale;\\nuniform float widthMinPixels;\\nuniform float widthMaxPixels;\\nuniform float jointType;\\nuniform float miterLimit;\\nuniform bool billboard;\\n\\nuniform float opacity;\\n\\nvarying vec4 vColor;\\nvarying vec2 vCornerOffset;\\nvarying float vMiterLength;\\nvarying vec2 vDashArray;\\nvarying vec2 vPathPosition;\\nvarying float vPathLength;\\n\\nconst float EPSILON = 0.001;\\nconst vec3 ZERO_OFFSET = vec3(0.0);\\n\\nfloat flipIfTrue(bool flag) {\\n  return -(float(flag) * 2. - 1.);\\n}\\nvec3 lineJoin(\\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\\n  float relativePosition, bool isEnd, bool isJoint,\\n  vec2 width\\n) {\\n  vec2 deltaA = (currPoint.xy - prevPoint.xy) / width;\\n  vec2 deltaB = (nextPoint.xy - currPoint.xy) / width;\\n\\n  float lenA = length(deltaA);\\n  float lenB = length(deltaB);\\n  lenA = lenA > EPSILON ? lenA : 0.0;\\n  lenB = lenB > EPSILON ? lenB : 0.0;\\n\\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\\n\\n  vec2 perpA = vec2(-dirA.y, dirA.x);\\n  vec2 perpB = vec2(-dirB.y, dirB.x);\\n  vec2 tangent = vec2(dirA + dirB);\\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\\n  vec2 perp = isEnd ? perpA : perpB;\\n  float L = isEnd ? lenA : lenB;\\n  float sinHalfA = abs(dot(miterVec, perp));\\n  float cosHalfA = abs(dot(dirA, miterVec));\\n\\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\\n\\n  float offsetScale = 1.0 / max(sinHalfA, EPSILON);\\n\\n  float cornerPosition = isJoint ?\\n    0.0 :\\n    flipIfTrue(turnsRight == (relativePosition > 0.0));\\n  cornerPosition *=\\n    float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) * cosHalfA);\\n  if (cornerPosition < 0.0) {\\n    offsetScale = min(offsetScale, L / max(cosHalfA, EPSILON));\\n  }\\n\\n  vMiterLength = cornerPosition >= 0.0 ?\\n    mix(offsetScale, 0.0, cornerPosition) :\\n    offsetScale * cornerPosition;\\n  vMiterLength -= sinHalfA * jointType;\\n\\n  float offsetDirection = mix(\\n    positions.y,\\n    mix(\\n      flipIfTrue(turnsRight),\\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\\n      cornerPosition\\n    ),\\n    step(0.0, cornerPosition)\\n  );\\n\\n  vec2 offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\\n  bool isStartCap = step(0.0, -lenA) > 0.5;\\n  bool isEndCap = step(0.0, -lenB) > 0.5;\\n  bool isCap = isStartCap || isEndCap;\\n  cornerPosition = isCap ? (1.0 - positions.z) : 0.;\\n  if (isStartCap) {\\n    offsetVec = mix(dirB, perpB, cornerPosition);\\n  }\\n  if (isEndCap) {\\n    offsetVec = mix(dirA, perpA, cornerPosition);\\n  }\\n  if (isCap) {\\n    offsetScale = mix(4.0 * jointType, 1.0, cornerPosition);\\n    vMiterLength = 1.0 - cornerPosition;\\n    offsetDirection = mix(flipIfTrue(isStartCap), positions.y, cornerPosition);\\n  }\\n\\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\\n  vDashArray = instanceDashArrays;\\n  vPathLength = L;\\n  vec2 offsetFromStartOfPath = vCornerOffset;\\n  if (isEnd) {\\n    offsetFromStartOfPath += deltaA;\\n  }\\n  vec2 dir = isEnd ? dirA : dirB;\\n  vPathPosition = vec2(\\n    positions.y + positions.z * offsetDirection,\\n    dot(offsetFromStartOfPath, dir)\\n  );\\n\\n  return currPoint + vec3(vCornerOffset * width, 0.0);\\n}\\nvec3 lineJoin(vec3 prevPoint, vec3 currPoint, vec3 nextPoint) {\\n\\n  float relativePosition = positions.y;\\n  bool isEnd = positions.x > EPSILON;\\n  bool isJoint = positions.z > EPSILON;\\n\\n  vec2 widthPixels = vec2(clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\\n    widthMinPixels, widthMaxPixels) / 2.0);\\n\\n  return lineJoin(\\n    prevPoint, currPoint, nextPoint,\\n    relativePosition, isEnd, isJoint,\\n    billboard ? project_pixel_size_to_clipspace(widthPixels) : project_pixel_size(widthPixels)\\n  );\\n}\\nvoid clipLine(inout vec4 position, vec4 refPosition) {\\n  if (position.w < EPSILON) {\\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\\n    position = refPosition + (position - refPosition) * r;\\n  }\\n}\\n\\nvoid main() {\\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\\n  picking_setPickingColor(instancePickingColors);\\n\\n  float isEnd = positions.x;\\n\\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\\n  vec2 prevPosition64xyLow = mix(instanceNeighborPositions64xyLow.xy, instanceStartEndPositions64xyLow.xy, isEnd);\\n\\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\\n\\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\\n  vec2 nextPosition64xyLow = mix(instanceStartEndPositions64xyLow.zw, instanceNeighborPositions64xyLow.zw, isEnd);\\n\\n  if (billboard) {\\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64xyLow, ZERO_OFFSET);\\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64xyLow, ZERO_OFFSET);\\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64xyLow, ZERO_OFFSET);\\n\\n    clipLine(prevPositionScreen, currPositionScreen);\\n    clipLine(nextPositionScreen, currPositionScreen);\\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\\n\\n    vec3 pos = lineJoin(\\n      prevPositionScreen.xyz / prevPositionScreen.w,\\n      currPositionScreen.xyz / currPositionScreen.w,\\n      nextPositionScreen.xyz / nextPositionScreen.w\\n    );\\n\\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\\n  } else {\\n    prevPosition = project_position(prevPosition, prevPosition64xyLow);\\n    currPosition = project_position(currPosition, currPosition64xyLow);\\n    nextPosition = project_position(nextPosition, nextPosition64xyLow);\\n\\n    vec3 pos = lineJoin(prevPosition, currPosition, nextPosition);\\n    gl_Position = project_common_position_to_clipspace(vec4(pos, 1.0));\\n  }\\n}\\n\",fs:y,modules:[\"project32\",\"picking\"]}}},{key:\"initializeState\",value:function(){var t=this;this.getAttributeManager().addInstanced({instanceStartPositions:{size:3,transition:b,accessor:\"getPath\",update:this.calculateStartPositions,noAlloc:!0},instanceEndPositions:{size:3,transition:b,accessor:\"getPath\",update:this.calculateEndPositions,noAlloc:!0},instanceStartEndPositions64xyLow:{size:4,update:this.calculateInstanceStartEndPositions64xyLow,noAlloc:!0},instanceLeftPositions:{size:3,accessor:\"getPath\",update:this.calculateLeftPositions,noAlloc:!0},instanceRightPositions:{size:3,accessor:\"getPath\",update:this.calculateRightPositions,noAlloc:!0},instanceNeighborPositions64xyLow:{size:4,update:this.calculateInstanceNeighborPositions64xyLow,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:\"getWidth\",transition:b,defaultValue:1},instanceDashArrays:{size:2,accessor:\"getDashArray\"},instanceColors:{size:4,type:5121,accessor:\"getColor\",transition:b,defaultValue:x},instancePickingColors:{size:3,type:5121,accessor:function(e,n){var i=n.index,o=n.target;return t.encodePickingColor(i,o)}}}),this.setState({pathTesselator:new g({})})}},{key:\"updateState\",value:function(t){var n=t.oldProps,i=t.props,o=t.changeFlags;Object(s.a)(Object(a.a)(e.prototype),\"updateState\",this).call(this,{props:i,oldProps:n,changeFlags:o});var r=this.getAttributeManager();if(o.dataChanged||i.fp64!==n.fp64||o.updateTriggersChanged&&(o.updateTriggersChanged.all||o.updateTriggersChanged.getPath)){var l=this.state.pathTesselator;l.updateGeometry({data:i.data,getGeometry:i.getPath,positionFormat:i.positionFormat,fp64:this.use64bitPositions()}),this.setState({numInstances:l.instanceCount,bufferLayout:l.bufferLayout}),r.invalidateAll()}if(i.fp64!==n.fp64){var c=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(c)}),r.invalidateAll()}}},{key:\"draw\",value:function(t){var e=t.uniforms,n=this.context.viewport,i=this.props,o=i.rounded,r=i.billboard,a=i.miterLimit,s=i.widthUnits,l=i.widthScale,c=i.widthMinPixels,u=i.widthMaxPixels,p=i.dashJustified,h=\"pixels\"===s?n.distanceScales.metersPerPixel[2]:1;this.state.model.setUniforms(Object.assign({},e,{jointType:Number(o),billboard:r,alignMode:Number(p),widthScale:l*h,miterLimit:a,widthMinPixels:c,widthMaxPixels:u})).draw()}},{key:\"_getModel\",value:function(t){return new u.a(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new p.a({drawMode:4,attributes:{indices:new Uint16Array([0,2,1,1,2,4,1,4,3,3,4,5]),positions:new Float32Array([0,0,1,0,-1,0,0,1,0,1,-1,0,1,1,0,1,0,1])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:\"calculateStartPositions\",value:function(t){var e=this.state.pathTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get(\"startPositions\")}},{key:\"calculateEndPositions\",value:function(t){var e=this.state.pathTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get(\"endPositions\")}},{key:\"calculateInstanceStartEndPositions64xyLow\",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.pathTesselator.get(\"startEndPositions64XyLow\"):new Float32Array(4)}},{key:\"calculateLeftPositions\",value:function(t){var e=this.state.pathTesselator;t.value=e.get(\"leftPositions\")}},{key:\"calculateRightPositions\",value:function(t){var e=this.state.pathTesselator;t.value=e.get(\"rightPositions\")}},{key:\"calculateInstanceNeighborPositions64xyLow\",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.pathTesselator.get(\"neighborPositions64XyLow\"):new Float32Array(4)}},{key:\"clearPickingColor\",value:function(t){for(var e=this.decodePickingColor(t),n=this.state.pathTesselator.bufferLayout,i=n[e],o=0,r=0;r<e;r++)o+=n[r];var a=this.getAttributeManager().attributes.instancePickingColors,s=a.value,l=o+i;s.fill(0,3*o,3*l),a.update({value:s})}}]),e}(c.a);P.layerName=\"PathLayer\",P.defaultProps=m},4504:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return h}));var i=n(16),o=n(17),r=n(179),a=n(80),s=n(233),l=n(19),c=n(4490),u=n(4454),p=n(4481),h=function(t){function e(){return Object(i.a)(this,e),Object(r.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(o.a)(e,[{key:\"getSubLayers\",value:function(){return this.internalState&&this.internalState.subLayers||[]}},{key:\"initializeState\",value:function(){}},{key:\"setState\",value:function(t){Object(s.a)(Object(a.a)(e.prototype),\"setState\",this).call(this,t),this.setLayerNeedsUpdate()}},{key:\"getPickingInfo\",value:function(t){return t.info}},{key:\"renderLayers\",value:function(){return null}},{key:\"shouldRenderSubLayer\",value:function(t,e){var n=this.props._subLayerProps;return e&&e.length||n&&n[t]}},{key:\"getSubLayerClass\",value:function(t,e){var n=this.props._subLayerProps;return n&&n[t]&&n[t].type||e}},{key:\"getSubLayerProps\",value:function(t){var e=this.props,n=e.opacity,i=e.pickable,o=e.visible,r=e.parameters,a=e.getPolygonOffset,s=e.highlightedObjectIndex,l=e.autoHighlight,c=e.highlightColor,u=e.coordinateSystem,p=e.coordinateOrigin,h=e.wrapLongitude,d=e.positionFormat,f=e.modelMatrix,v=e._subLayerProps,g={opacity:n,pickable:i,visible:o,parameters:r,getPolygonOffset:a,highlightedObjectIndex:s,autoHighlight:l,highlightColor:c,coordinateSystem:u,coordinateOrigin:p,wrapLongitude:h,positionFormat:d,modelMatrix:f};if(t){var y=v&&v[t.id],x=y&&y.updateTriggers;Object.assign(g,t,y,{id:\"\".concat(this.props.id,\"-\").concat(t.id),updateTriggers:Object.assign({all:this.props.updateTriggers.all},t.updateTriggers,x)})}return g}},{key:\"_getAttributeManager\",value:function(){return null}},{key:\"_renderLayers\",value:function(){var t=this.internalState.subLayers;t&&!this.needsUpdate()?u.a.log(3,\"Composite layer reused subLayers \".concat(this),this.internalState.subLayers)():(t=this.renderLayers(),t=Object(p.b)(t,{filter:Boolean}),this.internalState.subLayers=t,u.a.log(2,\"Composite layer rendered new subLayers \".concat(this),t)());var e=!0,n=!1,i=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){o.value.parent=this}}catch(t){n=!0,i=t}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}}},{key:\"isComposite\",get:function(){return!0}}]),e}(c.a);h.layerName=\"CompositeLayer\"},4516:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return A}));var i=n(16),o=n(17),r=n(179),a=n(80),s=n(233),l=n(19),c=n(4490),u=n(4562),p=n(4877),h=n(4749),d=n(4690),f=n(4587),v=n(4493),g=n(4447),y=n(4920),x=g.a.Tesselator,m=y.a.fp64LowPart,b=function(t){function e(t){var n=t.data,o=t.getGeometry,s=t.fp64,l=t.positionFormat,c=t.IndexType,u=void 0===c?Uint32Array:c;return Object(i.a)(this,e),Object(r.a)(this,Object(a.a)(e).call(this,{data:n,getGeometry:o,fp64:s,positionFormat:l,attributes:{positions:{size:3},positions64xyLow:{size:2,fp64Only:!0},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:u,size:1}}}))}return Object(l.a)(e,t),Object(o.a)(e,[{key:\"get\",value:function(t){return\"indices\"===t?this.attributes.indices.subarray(0,this.vertexCount):this.attributes[t]}},{key:\"getGeometrySize\",value:function(t){return v.b(t,this.positionSize)}},{key:\"updateGeometryAttributes\",value:function(t,e){t=v.c(t,this.positionSize,e.geometrySize),this._updateIndices(t,e),this._updatePositions(t,e)}},{key:\"_updateIndices\",value:function(t,e){var n=e.geometryIndex,i=e.vertexStart,o=e.indexStart,r=this.attributes,a=this.indexLayout,s=this.typedArrayManager,l=r.indices,c=l.length,u=o,p=v.a(t,this.positionSize);c<u+p.length&&(c=2*(u+p.length),l=s.allocate(l,c,{type:l.constructor,size:1,copy:!0}));for(var h=0;h<p.length;h++)l[u++]=p[h]+i;a[n]=p.length,r.indices=l}},{key:\"_updatePositions\",value:function(t,e){for(var n=e.vertexStart,i=e.geometrySize,o=this.attributes,r=o.positions,a=o.positions64xyLow,s=o.vertexValid,l=this.fp64,c=this.positionSize,u=n,p=t.positions,h=t.holeIndices,d=0;d<i;d++){var f=p[d*c],v=p[d*c+1],g=c>2?p[d*c+2]:0;r[3*u]=f,r[3*u+1]=v,r[3*u+2]=g,l&&(a[2*u]=m(f),a[2*u+1]=m(v)),s[u]=1,u++}if(h)for(var y=0;y<h.length;y++)s[n+h[y]/c-1]=0;s[n+i-1]=0}}]),e}(x),P=\"\\nattribute vec2 vertexPositions;\\nattribute float vertexValid;\\n\\nuniform bool extruded;\\nuniform bool isWireframe;\\nuniform float elevationScale;\\nuniform float opacity;\\n\\nvarying vec4 vColor;\\nvarying float isValid;\\n\\nstruct PolygonProps {\\n  vec4 fillColors;\\n  vec4 lineColors;\\n  vec3 positions;\\n  vec3 nextPositions;\\n  vec3 pickingColors;\\n  vec2 positions64xyLow;\\n  vec2 nextPositions64xyLow;\\n  float elevations;\\n};\\n\\nvec3 project_offset_normal(vec3 vector) {\\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNG_LAT ||\\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS ||\\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_AUTO_OFFSET) {\\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\\n  }\\n  return project_normal(vector);\\n}\\n\\nvoid calculatePosition(PolygonProps props) {\\n  vec3 pos;\\n  vec2 pos64xyLow;\\n  vec3 normal;\\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\\n\\n#ifdef IS_SIDE_VERTEX\\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\\n  pos64xyLow = mix(props.positions64xyLow, props.nextPositions64xyLow, vertexPositions.x);\\n  isValid = vertexValid;\\n#else\\n  pos = props.positions;\\n  pos64xyLow = props.positions64xyLow;\\n  isValid = 1.0;\\n#endif\\n\\n  if (extruded) {\\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\\n  }\\n\\n  vec4 position_commonspace;\\n  gl_Position = project_position_to_clipspace(pos, pos64xyLow, vec3(0.), position_commonspace);\\n\\n  if (extruded) {\\n#ifdef IS_SIDE_VERTEX\\n    normal = vec3(props.positions.y - props.nextPositions.y, props.nextPositions.x - props.positions.x, 0.0);\\n    normal = project_offset_normal(normal);\\n#else\\n    normal = vec3(0.0, 0.0, 1.0);\\n#endif\\n\\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, position_commonspace.xyz, normal);\\n    vColor = vec4(lightColor, colors.a * opacity) / 255.0;\\n  } else {\\n    vColor = vec4(colors.rgb, colors.a * opacity) / 255.0;\\n  }\\n  picking_setPickingColor(props.pickingColors);\\n}\\n\",w=\"#define SHADER_NAME solid-polygon-layer-vertex-shader\\n\\nattribute vec3 positions;\\nattribute vec2 positions64xyLow;\\nattribute float elevations;\\nattribute vec4 fillColors;\\nattribute vec4 lineColors;\\nattribute vec3 pickingColors;\\n\\n\".concat(P,\"\\n\\nvoid main(void) {\\n  PolygonProps props;\\n\\n  props.positions = positions;\\n  props.positions64xyLow = positions64xyLow;\\n  props.elevations = elevations;\\n  props.fillColors = fillColors;\\n  props.lineColors = lineColors;\\n  props.pickingColors = pickingColors;\\n\\n  calculatePosition(props);\\n}\\n\"),C=\"#define SHADER_NAME solid-polygon-layer-vertex-shader-side\\n#define IS_SIDE_VERTEX\\n\\n\\nattribute vec3 instancePositions;\\nattribute vec2 instancePositions64xyLow;\\nattribute vec3 nextPositions;\\nattribute vec2 nextPositions64xyLow;\\nattribute float instanceElevations;\\nattribute vec4 instanceFillColors;\\nattribute vec4 instanceLineColors;\\nattribute vec3 instancePickingColors;\\n\\n\".concat(P,\"\\n\\nvoid main(void) {\\n  PolygonProps props;\\n\\n  props.positions = instancePositions;\\n  props.positions64xyLow = instancePositions64xyLow;\\n  props.elevations = instanceElevations;\\n  props.fillColors = instanceFillColors;\\n  props.lineColors = instanceLineColors;\\n  props.pickingColors = instancePickingColors;\\n  props.nextPositions = nextPositions;\\n  props.nextPositions64xyLow = nextPositions64xyLow;\\n\\n  calculatePosition(props);\\n}\\n\"),_=[0,0,0,255],L=new u.a,S={filled:!0,extruded:!1,wireframe:!1,fp64:!1,elevationScale:{type:\"number\",min:0,value:1},getPolygon:{type:\"accessor\",value:function(t){return t.polygon}},getElevation:{type:\"accessor\",value:1e3},getFillColor:{type:\"accessor\",value:_},getLineColor:{type:\"accessor\",value:_},material:L},j={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},A=function(t){function e(){return Object(i.a)(this,e),Object(r.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(o.a)(e,[{key:\"getShaders\",value:function(t){return{vs:t,fs:\"#define SHADER_NAME solid-polygon-layer-fragment-shader\\n\\nprecision highp float;\\n\\nvarying vec4 vColor;\\nvarying float isValid;\\n\\nvoid main(void) {\\n  if (isValid < 0.5) {\\n    discard;\\n  }\\n\\n  gl_FragColor = vColor;\\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\\n}\\n\",defines:{},modules:[this.use64bitProjection()?\"project64\":\"project32\",\"gouraud-lighting\",\"picking\"]}}},{key:\"initializeState\",value:function(){var t=this,e=this.context.gl;this.setState({numInstances:0,polygonTesselator:new b({IndexType:!e||Object(p.b)(e,h.a.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});var n=this.getAttributeManager();n.remove([\"instancePickingColors\"]),n.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,transition:j,accessor:\"getPolygon\",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{positions:{offset:0,divisor:0},instancePositions:{offset:0,divisor:1},nextPositions:{offset:12,divisor:1}}},positions64xyLow:{size:2,update:this.calculatePositionsLow,noAlloc:!0,shaderAttributes:{positions64xyLow:{offset:0,divisor:0},instancePositions64xyLow:{offset:0,divisor:1},nextPositions64xyLow:{offset:8,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:j,accessor:\"getElevation\",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{alias:\"colors\",size:4,type:5121,transition:j,accessor:\"getFillColor\",defaultValue:_,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{alias:\"colors\",size:4,type:5121,transition:j,accessor:\"getLineColor\",defaultValue:_,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:function(e,n){var i=n.index,o=n.target;return t.encodePickingColor(i,o)},shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}},{key:\"draw\",value:function(t){var e=t.uniforms,n=this.props,i=n.extruded,o=n.filled,r=n.wireframe,a=n.elevationScale,s=this.state,l=s.topModel,c=s.sideModel,u=s.polygonTesselator,p=Object.assign({},e,{extruded:Boolean(i),elevationScale:a});c&&(c.setInstanceCount(u.instanceCount-1),c.setUniforms(p),r&&(c.setDrawMode(3),c.setUniforms({isWireframe:!0}).draw()),o&&(c.setDrawMode(6),c.setUniforms({isWireframe:!1}).draw())),l&&(l.setVertexCount(u.get(\"indices\").length),l.setUniforms(p).draw())}},{key:\"updateState\",value:function(t){Object(s.a)(Object(a.a)(e.prototype),\"updateState\",this).call(this,t),this.updateGeometry(t);var n=t.props,i=t.oldProps,o=this.getAttributeManager();(n.fp64!==i.fp64||n.filled!==i.filled||n.extruded!==i.extruded)&&(this.state.models&&this.state.models.forEach((function(t){return t.delete()})),this.setState(this._getModels(this.context.gl)),o.invalidateAll())}},{key:\"updateGeometry\",value:function(t){var e=t.props,n=t.oldProps,i=t.changeFlags;if(i.dataChanged||e.fp64!==n.fp64||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){var o=this.state.polygonTesselator;o.updateGeometry({data:e.data,getGeometry:e.getPolygon,positionFormat:e.positionFormat,fp64:this.use64bitPositions()}),this.setState({numInstances:o.instanceCount,bufferLayout:o.bufferLayout}),this.getAttributeManager().invalidateAll()}}},{key:\"_getModels\",value:function(t){var e,n,i=this.props,o=i.id,r=i.filled,a=i.extruded;if(r){var s=this.getShaders(w);s.defines.NON_INSTANCED_MODEL=1,e=new d.a(t,Object.assign({},s,{id:\"\".concat(o,\"-top\"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0,shaderCache:this.context.shaderCache}))}return a&&((n=new d.a(t,Object.assign({},this.getShaders(C),{id:\"\".concat(o,\"-side\"),geometry:new f.a({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,1,0,1,0,0,1,0])}}}),instanceCount:0,isInstanced:1,shaderCache:this.context.shaderCache}))).userData.excludeAttributes={indices:!0}),{models:[n,e].filter(Boolean),topModel:e,sideModel:n}}},{key:\"calculateIndices\",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.indexLayout,t.value=e.get(\"indices\")}},{key:\"calculatePositions\",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get(\"positions\")}},{key:\"calculatePositionsLow\",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.polygonTesselator.get(\"positions64xyLow\"):new Float32Array(2)}},{key:\"calculateVertexValid\",value:function(t){t.value=this.state.polygonTesselator.get(\"vertexValid\")}},{key:\"clearPickingColor\",value:function(t){for(var e=this.decodePickingColor(t),n=this.state.polygonTesselator.bufferLayout,i=n[e],o=0,r=0;r<e;r++)o+=n[r];var a=this.getAttributeManager().attributes.pickingColors,s=a.value,l=o+i;s.fill(0,3*o,3*l),a.update({value:s})}}]),e}(c.a);A.layerName=\"SolidPolygonLayer\",A.defaultProps=S},4525:function(t,e,n){\"use strict\";function i(t,e,n){n=n||2;var i,s,l,c,u,d,f,g=e&&e.length,y=g?e[0]*n:t.length,x=o(t,0,y,n,!0),m=[];if(!x||x.next===x.prev)return m;if(g&&(x=function(t,e,n,i){var a,s,l,c,u,d=[];for(a=0,s=e.length;a<s;a++)l=e[a]*i,c=a<s-1?e[a+1]*i:t.length,(u=o(t,l,c,i,!1))===u.next&&(u.steiner=!0),d.push(v(u));for(d.sort(p),a=0;a<d.length;a++)h(d[a],n),n=r(n,n.next);return n}(t,e,x,n)),t.length>80*n){i=l=t[0],s=c=t[1];for(var b=n;b<y;b+=n)(u=t[b])<i&&(i=u),(d=t[b+1])<s&&(s=d),u>l&&(l=u),d>c&&(c=d);f=0!==(f=Math.max(l-i,c-s))?1/f:0}return a(x,m,n,i,s,f),m}function o(t,e,n,i,o){var r,a;if(o===A(t,e,n,i)>0)for(r=e;r<n;r+=i)a=L(r,t[r],t[r+1],a);else for(r=n-i;r>=e;r-=i)a=L(r,t[r],t[r+1],a);return a&&m(a,a.next)&&(S(a),a=a.next),a}function r(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!m(i,i.next)&&0!==x(i.prev,i,i.next))i=i.next;else{if(S(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function a(t,e,n,i,o,p,h){if(t){!h&&p&&function(t,e,n,i){var o=t;do{null===o.z&&(o.z=f(o.x,o.y,e,n,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,n,i,o,r,a,s,l,c=1;do{for(n=t,t=null,r=null,a=0;n;){for(a++,i=n,s=0,e=0;e<c&&(s++,i=i.nextZ);e++);for(l=c;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(o=n,n=n.nextZ,s--):(o=i,i=i.nextZ,l--),r?r.nextZ=o:t=o,o.prevZ=r,r=o;n=i}r.nextZ=null,c*=2}while(a>1)}(o)}(t,i,o,p);for(var d,v,g=t;t.prev!==t.next;)if(d=t.prev,v=t.next,p?l(t,i,o,p):s(t))e.push(d.i/n),e.push(t.i/n),e.push(v.i/n),S(t),t=v.next,g=v.next;else if((t=v)===g){h?1===h?a(t=c(r(t),e,n),e,n,i,o,p,2):2===h&&u(t,e,n,i,o,p):a(r(t),e,n,i,o,p,1);break}}}function s(t){var e=t.prev,n=t,i=t.next;if(x(e,n,i)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(g(e.x,e.y,n.x,n.y,i.x,i.y,o.x,o.y)&&x(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function l(t,e,n,i){var o=t.prev,r=t,a=t.next;if(x(o,r,a)>=0)return!1;for(var s=o.x<r.x?o.x<a.x?o.x:a.x:r.x<a.x?r.x:a.x,l=o.y<r.y?o.y<a.y?o.y:a.y:r.y<a.y?r.y:a.y,c=o.x>r.x?o.x>a.x?o.x:a.x:r.x>a.x?r.x:a.x,u=o.y>r.y?o.y>a.y?o.y:a.y:r.y>a.y?r.y:a.y,p=f(s,l,e,n,i),h=f(c,u,e,n,i),d=t.prevZ,v=t.nextZ;d&&d.z>=p&&v&&v.z<=h;){if(d!==t.prev&&d!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,v!==t.prev&&v!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,v.x,v.y)&&x(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;d&&d.z>=p;){if(d!==t.prev&&d!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;v&&v.z<=h;){if(v!==t.prev&&v!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,v.x,v.y)&&x(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function c(t,e,n){var i=t;do{var o=i.prev,a=i.next.next;!m(o,a)&&b(o,i,i.next,a)&&C(o,a)&&C(a,o)&&(e.push(o.i/n),e.push(i.i/n),e.push(a.i/n),S(i),S(i.next),i=t=a),i=i.next}while(i!==t);return r(i)}function u(t,e,n,i,o,s){var l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&y(l,c)){var u=_(l,c);return l=r(l,l.next),u=r(u,u.next),a(l,e,n,i,o,s),void a(u,e,n,i,o,s)}c=c.next}l=l.next}while(l!==t)}function p(t,e){return t.x-e.x}function h(t,e){if(e=function(t,e){var n,i=e,o=t.x,r=t.y,a=-1/0;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){var s=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=o&&s>a){if(a=s,s===o){if(r===i.y)return i;if(r===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(o===a)return n;var l,c=n,u=n.x,p=n.y,h=1/0;i=n;do{o>=i.x&&i.x>=u&&o!==i.x&&g(r<p?o:a,r,u,p,r<p?a:o,r,i.x,i.y)&&(l=Math.abs(r-i.y)/(o-i.x),C(i,t)&&(l<h||l===h&&(i.x>n.x||i.x===n.x&&d(n,i)))&&(n=i,h=l)),i=i.next}while(i!==c);return n}(t,e)){var n=_(e,t);r(e,e.next),r(n,n.next)}}function d(t,e){return x(t.prev,t,e.prev)<0&&x(e.next,t,t.next)<0}function f(t,e,n,i,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*o)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*o)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function g(t,e,n,i,o,r,a,s){return(o-a)*(e-s)-(t-a)*(r-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(r-s)-(o-a)*(i-s)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(C(t,e)&&C(e,t)&&function(t,e){var n=t,i=!1,o=(t.x+e.x)/2,r=(t.y+e.y)/2;do{n.y>r!=n.next.y>r&&n.next.y!==n.y&&o<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(x(t.prev,t,e.prev)||x(t,e.prev,e))||m(t,e)&&x(t.prev,t,t.next)>0&&x(e.prev,e,e.next)>0)}function x(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function m(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,n,i){var o=w(x(t,e,n)),r=w(x(t,e,i)),a=w(x(n,i,t)),s=w(x(n,i,e));return o!==r&&a!==s||(!(0!==o||!P(t,n,e))||(!(0!==r||!P(t,i,e))||(!(0!==a||!P(n,t,i))||!(0!==s||!P(n,e,i)))))}function P(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function w(t){return t>0?1:t<0?-1:0}function C(t,e){return x(t.prev,t,t.next)<0?x(t,e,t.next)>=0&&x(t,t.prev,e)>=0:x(t,e,t.prev)<0||x(t,t.next,e)<0}function _(t,e){var n=new j(t.i,t.x,t.y),i=new j(e.i,e.x,e.y),o=t.next,r=e.prev;return t.next=e,e.prev=t,n.next=o,o.prev=n,i.next=n,n.prev=i,r.next=i,i.prev=r,i}function L(t,e,n,i){var o=new j(t,e,n);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function j(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(t,e,n,i){for(var o=0,r=e,a=n-i;r<n;r+=i)o+=(t[a]-t[r])*(t[r+1]+t[a+1]),a=r;return o}t.exports=i,t.exports.default=i,i.deviation=function(t,e,n,i){var o=e&&e.length,r=o?e[0]*n:t.length,a=Math.abs(A(t,0,r,n));if(o)for(var s=0,l=e.length;s<l;s++){var c=e[s]*n,u=s<l-1?e[s+1]*n:t.length;a-=Math.abs(A(t,c,u,n))}var p=0;for(s=0;s<i.length;s+=3){var h=i[s]*n,d=i[s+1]*n,f=i[s+2]*n;p+=Math.abs((t[h]-t[f])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[f+1]-t[h+1]))}return 0===a&&0===p?0:Math.abs((p-a)/a)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,o=0;o<t.length;o++){for(var r=0;r<t[o].length;r++)for(var a=0;a<e;a++)n.vertices.push(t[o][r][a]);o>0&&(i+=t[o-1].length,n.holes.push(i))}return n}},4562:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return c}));var i=n(16),o=n(179),r=n(80),a=n(28),s=n(19),l={ambient:.35,diffuse:.6,shininess:32,specularColor:[30,30,30]},c=function(t){function e(t){var n;return Object(i.a)(this,e),n=Object(o.a)(this,Object(r.a)(e).call(this,t)),t=Object.assign({},l,t),Object.assign(Object(a.a)(n),t),n}return Object(s.a)(e,t),e}((function t(){Object(i.a)(this,t)}))},4698:function(t,e,n){\"use strict\";n.r(e),n.d(e,\"getLayer\",(function(){return D}));var i=n(0),o=n.n(i),r=n(2),a=n.n(r),s=n(16),l=n(17),c=n(179),u=n(80),p=n(19),h=n(4562),d=n(4538),f=n(4504),v=n(4516),g=n(4498),y=n(4493),x=new h.a,m={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,lineWidthUnits:\"meters\",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,lineDashJustified:!1,fp64:!1,getPolygon:{type:\"accessor\",value:function(t){return t.polygon}},getFillColor:{type:\"accessor\",value:[0,0,0,255]},getLineColor:{type:\"accessor\",value:[0,0,0,255]},getLineWidth:{type:\"accessor\",value:1},getLineDashArray:{type:\"accessor\",value:[0,0]},getElevation:{type:\"accessor\",value:1e3},material:x},b=function(t){function e(){return Object(s.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:\"initializeState\",value:function(){this.state={paths:[]}}},{key:\"updateState\",value:function(t){t.oldProps;var e=t.props,n=t.changeFlags;(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon))&&(this.state.paths=this._getPaths(e))}},{key:\"getPickingInfo\",value:function(t){var e=t.info;return Object.assign(e,{object:e.object&&e.object.object||e.object})}},{key:\"_getPaths\",value:function(t){var e=t.data,n=t.getPolygon,i=[],o=\"XY\"===t.positionFormat?2:3,r=Object(d.a)(e),a=r.iterable,s=r.objectInfo,l=!0,c=!1,u=void 0;try{for(var p,h=a[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var f=p.value;s.index++;var v=y.c(n(f,s),o),g=v.positions,x=v.holeIndices;if(x)for(var m=0;m<=x.length;m++){var b=g.subarray(x[m-1]||0,x[m]||g.length);i.push({path:b,object:f})}else i.push({path:g,object:f})}}catch(t){c=!0,u=t}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}return i}},{key:\"_getAccessor\",value:function(t){return\"function\"==typeof t?function(e){return t(e.object)}:t}},{key:\"renderLayers\",value:function(){var t=this.props,e=t.data,n=t.stroked,i=t.filled,o=t.extruded,r=t.wireframe,a=t.elevationScale,s=t.transitions,l=this.props,c=l.lineWidthUnits,u=l.lineWidthScale,p=l.lineWidthMinPixels,h=l.lineWidthMaxPixels,d=l.lineJointRounded,f=l.lineMiterLimit,y=l.lineDashJustified,x=l.fp64,m=this.props,b=m.getFillColor,P=m.getLineColor,w=m.getLineWidth,C=m.getLineDashArray,_=m.getElevation,L=m.getPolygon,S=m.updateTriggers,j=m.material,A=this.state.paths,k=this.getSubLayerClass(\"fill\",v.a),M=this.getSubLayerClass(\"stroke\",g.a),O=this.shouldRenderSubLayer(\"fill\",A)&&new k({extruded:o,elevationScale:a,fp64:x,filled:i,wireframe:r,getElevation:_,getFillColor:b,getLineColor:P,material:j,transitions:s},this.getSubLayerProps({id:\"fill\",updateTriggers:{getPolygon:S.getPolygon,getElevation:S.getElevation,getFillColor:S.getFillColor,getLineColor:S.getLineColor}}),{data:e,getPolygon:L});return[!o&&O,!o&&n&&this.shouldRenderSubLayer(\"stroke\",A)&&new M({fp64:x,widthUnits:c,widthScale:u,widthMinPixels:p,widthMaxPixels:h,rounded:d,miterLimit:f,dashJustified:y,transitions:s&&{getWidth:s.getLineWidth,getColor:s.getLineColor,getPath:s.getPolygon},getColor:this._getAccessor(P),getWidth:this._getAccessor(w),getDashArray:this._getAccessor(C)},this.getSubLayerProps({id:\"stroke\",updateTriggers:{getWidth:S.getLineWidth,getColor:S.getLineColor,getDashArray:S.getLineDashArray}}),{data:A,getPath:function(t){return t.path}}),o&&O]}}]),e}(f.a);b.layerName=\"PolygonLayer\",b.defaultProps=m;var P=n(4461),w=n(4471),C=n(4464),_=n(159),L=n(4406),S=n(237),j=n(528),A=n(4475);function k(t,e,n){let{break_points:i,num_buckets:o}=t;if(!e)return[];if(void 0===i||0===i.length){const t=o?parseInt(o,10):10,[i,r]=Object(_.extent)(e,n);if(void 0===i)return[];const a=(r-i)/t,s=0===a?0:Math.max(0,Math.ceil(Math.log10(1/a))),l=r>r.toFixed(s)?1:0;return new Array(t+1+l).fill().map((t,e)=>(i+e*a).toFixed(s))}return i.sort((t,e)=>parseFloat(t)-parseFloat(e))}function M(t,e,n){let{break_points:i,num_buckets:o,linear_color_scheme:r,opacity:a}=t;const s=i||o?k({break_points:i,num_buckets:o},e,n):null,l=Array.isArray(r)?new S.a({colors:r,id:\"custom\"}):Object(j.a)().get(r);let c,u;if(null!==s){const t=s.length-1,e=t>1?l.getColors(t):[l.colors[l.colors.length-1]],n=e[0],i=e[e.length-1];e.unshift(n),e.push(i);const o=s.map(t=>parseFloat(t));c=Object(L.scaleThreshold)().domain(o).range(e),u=e=>e>s[t]||e<s[0]}else c=l.createLinearScale(Object(_.extent)(e,n)),u=()=>!1;return t=>{const e=n(t),i=Object(A.hexToRGB)(c(e));return u(e)?i[3]=0:i[3]=a/100*255,i}}var O=n(4463),E=n(4458),F=n(4457);function T(t){return\"geometry\"in t.polygon?t.polygon.geometry.coordinates[0]:t.polygon}var z=n(4452);function I(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N(){return(N=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function D(t,e,n,i,r,a,s){const l=t,c=l.fill_color_picker,u=l.stroke_color_picker;let p=[...e.data.features];if(null!=s&&s.forEach(t=>{p=p.filter(e=>t(e))}),l.js_data_mutator){const t=Object(F.a)(l.js_data_mutator);p=t(p)}const h=l.metric?l.metric.label||l.metric:null,d=null===l.metric?()=>[c.r,c.g,c.b,255*c.a]:M(l,p,t=>t[h]),f=t=>{const e=d(t);return r.length>0&&!r.includes(t[l.line_column])&&(e[3]/=2),e},v=l.line_column&&l.metric&&[\"json\",\"geohash\",\"zipcode\"].includes(l.line_type)?function(t){return e=>{const n=t.metric.label||t.metric;return o.a.createElement(\"div\",{className:\"deckgl-tooltip\"},e.object.name&&o.a.createElement(C.a,{label:\"name: \",value:\"\"+e.object.name}),e.object[t.line_column]&&o.a.createElement(C.a,{label:t.line_column+\": \",value:\"\"+e.object[t.line_column]}),t.metric&&o.a.createElement(C.a,{label:n+\": \",value:\"\"+e.object[n]}))}}(l):void 0;return new b(N({id:\"path-layer-\"+l.slice_id,data:p,pickable:!0,filled:l.filled,stroked:l.stroked,getPolygon:T,getFillColor:f,getLineColor:[u.r,u.g,u.b,255*u.a],getLineWidth:l.line_width,extruded:l.extruded,getElevation:t=>function(t,e){return 0===e(t)[3]?0:t.elevation}(t,f),elevationScale:l.multiplier,fp64:!0},Object(O.a)(l,i,v,a)))}const B={formData:a.a.object.isRequired,payload:a.a.object.isRequired,setControlValue:a.a.func.isRequired,viewport:a.a.object.isRequired,onAddFilter:a.a.func,width:a.a.number.isRequired,height:a.a.number.isRequired},R={onAddFilter(){}};class V extends o.a.Component{constructor(t){super(t),I(this,\"containerRef\",o.a.createRef()),I(this,\"setTooltip\",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)}),this.state=V.getDerivedStateFromProps(t),this.getLayers=this.getLayers.bind(this),this.onSelect=this.onSelect.bind(this),this.onValuesChange=this.onValuesChange.bind(this)}static getDerivedStateFromProps(t,e){const{width:n,height:i,formData:o,payload:r}=t;if(e&&r.form_data===e.formData)return null;const a=r.data.features||[],s=a.map(t=>t.__timestamp),l=r.form_data.time_grain_sqla||r.form_data.granularity||\"P1D\",{start:c,end:u,getStep:p,values:h,disabled:d}=Object(E.a)(s,l);let{viewport:f}=t;return o.autozoom&&(f=Object(z.a)(f,{width:n,height:i,points:a.flatMap(T)})),{start:c,end:u,getStep:p,values:h,disabled:d,viewport:f,selected:[],lastClick:0,formData:r.form_data}}onSelect(t){const{formData:e,onAddFilter:n}=this.props,i=new Date,o=i-this.state.lastClick<=250,r=[...this.state.selected];if(o)r.splice(0,r.length,t);else if(e.toggle_polygons){const e=r.indexOf(t);-1===e?r.push(t):r.splice(e,1)}else r.splice(0,1,t);this.setState({selected:r,lastClick:i}),e.table_filter&&n(e.line_column,r,!1,!0)}onValuesChange(t){this.setState({values:Array.isArray(t)?t:[t,t+this.state.getStep(t)]})}getLayers(t){if(void 0===this.props.payload.data.features)return[];const e=[];t[0]===t[1]||t[1]===this.end?e.push(e=>e.__timestamp>=t[0]&&e.__timestamp<=t[1]):e.push(e=>e.__timestamp>=t[0]&&e.__timestamp<t[1]);return[D(this.props.formData,this.props.payload,this.props.onAddFilter,this.setTooltip,this.state.selected,this.onSelect,e)]}render(){const{payload:t,formData:e,setControlValue:n}=this.props,{start:i,end:r,getStep:a,values:s,disabled:l,viewport:c}=this.state,u=e,p=u.metric?u.metric.label||u.metric:null,h=function(t,e,n){const i=k(t,e,n),o=M(t,e,n),r={};return i.slice(1).forEach((e,n)=>{const a=i[n]+\" - \"+i[n+1],s=.5*(parseFloat(i[n])+parseFloat(i[n+1])),l=t.metric?t.metric.label||t.metric:null;r[a]={color:o({[l||t.metric]:s}),enabled:!0}}),r}(e,t.data.features,t=>t[p]);return o.a.createElement(\"div\",{style:{position:\"relative\"}},o.a.createElement(P.a,{ref:this.containerRef,aggregation:!0,getLayers:this.getLayers,start:i,end:r,getStep:a,values:s,disabled:l,viewport:c,width:this.props.width,height:this.props.height,mapboxApiAccessToken:t.data.mapboxApiKey,mapStyle:e.mapbox_style,setControlValue:n,onValuesChange:this.onValuesChange,onViewportChange:this.onViewportChange},null!==e.metric&&o.a.createElement(w.a,{categories:h,position:e.legend_position,format:e.legend_format})))}}V.propTypes=B,V.defaultProps=R;e.default=V}}]);","extractedComments":[]}